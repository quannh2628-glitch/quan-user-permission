(()=>{var Ig=Object.create;var Ws=Object.defineProperty;var Ng=Object.getOwnPropertyDescriptor;var Mg=Object.getOwnPropertyNames;var Lg=Object.getPrototypeOf,Bg=Object.prototype.hasOwnProperty;var o=(i,e)=>Ws(i,"name",{value:e,configurable:!0});var pe=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),Gs=(i,e)=>{for(var t in e)Ws(i,t,{get:e[t],enumerable:!0})},jg=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Mg(e))!Bg.call(i,s)&&s!==t&&Ws(i,s,{get:()=>e[s],enumerable:!(r=Ng(e,s))||r.enumerable});return i};var de=(i,e,t)=>(t=i!=null?Ig(Lg(i)):{},jg(e||!i||!i.__esModule?Ws(t,"default",{value:i,enumerable:!0}):t,i));var ro=pe((HS,gc)=>{function yy(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}o(yy,"isObject");gc.exports=yy});var vc=pe((VS,yc)=>{var vy=typeof global=="object"&&global&&global.Object===Object&&global;yc.exports=vy});var Tn=pe(($S,bc)=>{var by=vc(),wy=typeof self=="object"&&self&&self.Object===Object&&self,Sy=by||wy||Function("return this")();bc.exports=Sy});var Sc=pe((WS,wc)=>{var xy=Tn(),_y=o(function(){return xy.Date.now()},"now");wc.exports=_y});var _c=pe((KS,xc)=>{var Py=/\s/;function ky(i){for(var e=i.length;e--&&Py.test(i.charAt(e)););return e}o(ky,"trimmedEndIndex");xc.exports=ky});var kc=pe((YS,Pc)=>{var Ey=_c(),Fy=/^\s+/;function Cy(i){return i&&i.slice(0,Ey(i)+1).replace(Fy,"")}o(Cy,"baseTrim");Pc.exports=Cy});var An=pe((QS,Ec)=>{var Ty=Tn(),Ay=Ty.Symbol;Ec.exports=Ay});var Ac=pe((ZS,Tc)=>{var Fc=An(),Cc=Object.prototype,Ry=Cc.hasOwnProperty,Oy=Cc.toString,zr=Fc?Fc.toStringTag:void 0;function Uy(i){var e=Ry.call(i,zr),t=i[zr];try{i[zr]=void 0;var r=!0}catch{}var s=Oy.call(i);return r&&(e?i[zr]=t:delete i[zr]),s}o(Uy,"getRawTag");Tc.exports=Uy});var Oc=pe((tx,Rc)=>{var Dy=Object.prototype,Iy=Dy.toString;function Ny(i){return Iy.call(i)}o(Ny,"objectToString");Rc.exports=Ny});var Nc=pe((rx,Ic)=>{var Uc=An(),My=Ac(),Ly=Oc(),By="[object Null]",jy="[object Undefined]",Dc=Uc?Uc.toStringTag:void 0;function zy(i){return i==null?i===void 0?jy:By:Dc&&Dc in Object(i)?My(i):Ly(i)}o(zy,"baseGetTag");Ic.exports=zy});var Lc=pe((ox,Mc)=>{function Hy(i){return i!=null&&typeof i=="object"}o(Hy,"isObjectLike");Mc.exports=Hy});var jc=pe((ax,Bc)=>{var qy=Nc(),Vy=Lc(),$y="[object Symbol]";function Wy(i){return typeof i=="symbol"||Vy(i)&&qy(i)==$y}o(Wy,"isSymbol");Bc.exports=Wy});var Vc=pe((ux,qc)=>{var Gy=kc(),zc=ro(),Ky=jc(),Hc=NaN,Xy=/^[-+]0x[0-9a-f]+$/i,Yy=/^0b[01]+$/i,Jy=/^0o[0-7]+$/i,Qy=parseInt;function Zy(i){if(typeof i=="number")return i;if(Ky(i))return Hc;if(zc(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=zc(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=Gy(i);var t=Yy.test(i);return t||Jy.test(i)?Qy(i.slice(2),t?2:8):Xy.test(i)?Hc:+i}o(Zy,"toNumber");qc.exports=Zy});var On=pe((px,Wc)=>{var ev=ro(),Rn=Sc(),$c=Vc(),tv="Expected a function",iv=Math.max,rv=Math.min;function sv(i,e,t){var r,s,n,a,u,c,p=0,g=!1,h=!1,b=!0;if(typeof i!="function")throw new TypeError(tv);e=$c(e)||0,ev(t)&&(g=!!t.leading,h="maxWait"in t,n=h?iv($c(t.maxWait)||0,e):n,b="trailing"in t?!!t.trailing:b);function P(W){var K=r,te=s;return r=s=void 0,p=W,a=i.apply(te,K),a}o(P,"invokeFunc");function F(W){return p=W,u=setTimeout(O,e),g?P(W):a}o(F,"leadingEdge");function M(W){var K=W-c,te=W-p,Q=e-K;return h?rv(Q,n-te):Q}o(M,"remainingWait");function C(W){var K=W-c,te=W-p;return c===void 0||K>=e||K<0||h&&te>=n}o(C,"shouldInvoke");function O(){var W=Rn();if(C(W))return U(W);u=setTimeout(O,M(W))}o(O,"timerExpired");function U(W){return u=void 0,b&&r?P(W):(r=s=void 0,a)}o(U,"trailingEdge");function A(){u!==void 0&&clearTimeout(u),p=0,r=c=s=u=void 0}o(A,"cancel");function J(){return u===void 0?a:U(Rn())}o(J,"flush");function G(){var W=Rn(),K=C(W);if(r=arguments,s=this,c=W,K){if(u===void 0)return F(c);if(h)return clearTimeout(u),u=setTimeout(O,e),P(c)}return u===void 0&&(u=setTimeout(O,e)),a}return o(G,"debounced"),G.cancel=A,G.flush=J,G}o(sv,"debounce");Wc.exports=sv});var Un=pe((hx,Gc)=>{var ov=On(),nv=ro(),av="Expected a function";function lv(i,e,t){var r=!0,s=!0;if(typeof i!="function")throw new TypeError(av);return nv(t)&&(r="leading"in t?!!t.leading:r,s="trailing"in t?!!t.trailing:s),ov(i,e,{leading:r,maxWait:e,trailing:s})}o(lv,"throttle");Gc.exports=lv});var Xc=pe((mx,Kc)=>{Kc.exports=o(function(){var e={},t=e._fns={};e.emit=o(function(a,u,c,p,g,h,b){var P=r(a);P.length&&s(a,P,[u,c,p,g,h,b])},"emit"),e.on=o(function(a,u){t[a]||(t[a]=[]),t[a].push(u)},"on"),e.once=o(function(a,u){function c(){u.apply(this,arguments),e.off(a,c)}o(c,"one"),this.on(a,c)},"once"),e.off=o(function(a,u){var c=[];if(a&&u){var p=this._fns[a],g=0,h=p?p.length:0;for(g;g<h;g++)p[g]!==u&&c.push(p[g])}c.length?this._fns[a]=c:delete this._fns[a]},"off");function r(n){var a=t[n]?t[n]:[],u=n.indexOf(":"),c=u===-1?[n]:[n.substring(0,u),n.substring(u+1)],p=Object.keys(t),g=0,h=p.length;for(g;g<h;g++){var b=p[g];if(b==="*"&&(a=a.concat(t[b])),c.length===2&&c[0]===b){a=a.concat(t[b]);break}}return a}o(r,"getListeners");function s(n,a,u){var c=0,p=a.length;for(c;c<p&&a[c];c++)a[c].event=n,a[c].apply(a[c],u)}return o(s,"emitAll"),e},"createNamespaceEmitter")});var Hr=pe((_x,Qc)=>{"use strict";Qc.exports=o(function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);let t=e<0,r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return`${(t?"-":"")+e} B`;let s=Math.min(Math.floor(Math.log(e)/Math.log(1024)),r.length-1);e=Number(e/1024**s);let n=r[s];return e>=10||e%1===0?`${(t?"-":"")+e.toFixed(0)} ${n}`:`${(t?"-":"")+e.toFixed(1)} ${n}`},"prettierBytes")});var tp=pe((kx,ep)=>{"use strict";function Zc(i,e){this.text=i=i||"",this.hasWild=~i.indexOf("*"),this.separator=e,this.parts=i.split(e)}o(Zc,"WildcardMatcher");Zc.prototype.match=function(i){var e=!0,t=this.parts,r,s=t.length,n;if(typeof i=="string"||i instanceof String)if(!this.hasWild&&this.text!=i)e=!1;else{for(n=(i||"").split(this.separator),r=0;e&&r<s;r++)t[r]!=="*"&&(r<n.length?e=t[r]===n[r]:e=!1);e=e&&n}else if(typeof i.splice=="function")for(e=[],r=i.length;r--;)this.match(i[r])&&(e[e.length]=i[r]);else if(typeof i=="object"){e={};for(var a in i)this.match(a)&&(e[a]=i[a])}return e};ep.exports=function(i,e,t){var r=new Zc(i,t||/[\/\.]/);return typeof e<"u"?r.match(e):r}});var rp=pe((Fx,ip)=>{var pv=tp(),dv=/[\/\+\.]/;ip.exports=function(i,e){function t(r){var s=pv(r,i,dv);return s&&s.length>=2}return o(t,"test"),e?t(e.split(";")[0]):t}});var pp=pe((f_,cp)=>{function St(i,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(i)),this._timeouts=i,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}o(St,"RetryOperation");cp.exports=St;St.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};St.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};St.prototype.retry=function(i){if(this._timeout&&clearTimeout(this._timeout),!i)return!1;var e=new Date().getTime();if(i&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(i),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(i);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},t),this._options.unref&&this._timer.unref(),!0};St.prototype.attempt=function(i,e){this._fn=i,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};St.prototype.try=function(i){console.log("Using RetryOperation.try() is deprecated"),this.attempt(i)};St.prototype.start=function(i){console.log("Using RetryOperation.start() is deprecated"),this.attempt(i)};St.prototype.start=St.prototype.try;St.prototype.errors=function(){return this._errors};St.prototype.attempts=function(){return this._attempts};St.prototype.mainError=function(){if(this._errors.length===0)return null;for(var i={},e=null,t=0,r=0;r<this._errors.length;r++){var s=this._errors[r],n=s.message,a=(i[n]||0)+1;i[n]=a,a>=t&&(e=s,t=a)}return e}});var dp=pe(Pi=>{var fv=pp();Pi.operation=function(i){var e=Pi.timeouts(i);return new fv(e,{forever:i&&(i.forever||i.retries===1/0),unref:i&&i.unref,maxRetryTime:i&&i.maxRetryTime})};Pi.timeouts=function(i){if(i instanceof Array)return[].concat(i);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var t in i)e[t]=i[t];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],s=0;s<e.retries;s++)r.push(this.createTimeout(s,e));return i&&i.forever&&!r.length&&r.push(this.createTimeout(s,e)),r.sort(function(n,a){return n-a}),r};Pi.createTimeout=function(i,e){var t=e.randomize?Math.random()+1:1,r=Math.round(t*Math.max(e.minTimeout,1)*Math.pow(e.factor,i));return r=Math.min(r,e.maxTimeout),r};Pi.wrap=function(i,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var r in i)typeof i[r]=="function"&&t.push(r)}for(var s=0;s<t.length;s++){var n=t[s],a=i[n];i[n]=o(function(c){var p=Pi.operation(e),g=Array.prototype.slice.call(arguments,1),h=g.pop();g.push(function(b){p.retry(b)||(b&&(arguments[0]=p.mainError()),h.apply(this,arguments))}),p.attempt(function(){c.apply(i,g)})},"retryWrapper").bind(i,a),i[n].options=e}}});var fp=pe((v_,hp)=>{hp.exports=dp()});var ot=pe((v5,co)=>{(function(){"use strict";var i={}.hasOwnProperty;function e(){for(var s="",n=0;n<arguments.length;n++){var a=arguments[n];a&&(s=r(s,t(a)))}return s}o(e,"classNames");function t(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return e.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var n="";for(var a in s)i.call(s,a)&&s[a]&&(n=r(n,a));return n}o(t,"parseValue");function r(s,n){return n?s?s+" "+n:s+n:s}o(r,"appendClass"),typeof co<"u"&&co.exports?(e.default=e,co.exports=e):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return e}):window.classNames=e})()});var Dp=pe((b3,Qn)=>{"use strict";var Qv=Object.prototype.hasOwnProperty,nt="~";function Kr(){}o(Kr,"Events");Object.create&&(Kr.prototype=Object.create(null),new Kr().__proto__||(nt=!1));function Zv(i,e,t){this.fn=i,this.context=e,this.once=t||!1}o(Zv,"EE");function Up(i,e,t,r,s){if(typeof t!="function")throw new TypeError("The listener must be a function");var n=new Zv(t,r||i,s),a=nt?nt+e:e;return i._events[a]?i._events[a].fn?i._events[a]=[i._events[a],n]:i._events[a].push(n):(i._events[a]=n,i._eventsCount++),i}o(Up,"addListener");function vo(i,e){--i._eventsCount===0?i._events=new Kr:delete i._events[e]}o(vo,"clearEvent");function rt(){this._events=new Kr,this._eventsCount=0}o(rt,"EventEmitter");rt.prototype.eventNames=o(function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)Qv.call(t,r)&&e.push(nt?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},"eventNames");rt.prototype.listeners=o(function(e){var t=nt?nt+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,n=r.length,a=new Array(n);s<n;s++)a[s]=r[s].fn;return a},"listeners");rt.prototype.listenerCount=o(function(e){var t=nt?nt+e:e,r=this._events[t];return r?r.fn?1:r.length:0},"listenerCount");rt.prototype.emit=o(function(e,t,r,s,n,a){var u=nt?nt+e:e;if(!this._events[u])return!1;var c=this._events[u],p=arguments.length,g,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),p){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,s),!0;case 5:return c.fn.call(c.context,t,r,s,n),!0;case 6:return c.fn.call(c.context,t,r,s,n,a),!0}for(h=1,g=new Array(p-1);h<p;h++)g[h-1]=arguments[h];c.fn.apply(c.context,g)}else{var b=c.length,P;for(h=0;h<b;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),p){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,r);break;case 4:c[h].fn.call(c[h].context,t,r,s);break;default:if(!g)for(P=1,g=new Array(p-1);P<p;P++)g[P-1]=arguments[P];c[h].fn.apply(c[h].context,g)}}return!0},"emit");rt.prototype.on=o(function(e,t,r){return Up(this,e,t,r,!1)},"on");rt.prototype.once=o(function(e,t,r){return Up(this,e,t,r,!0)},"once");rt.prototype.removeListener=o(function(e,t,r,s){var n=nt?nt+e:e;if(!this._events[n])return this;if(!t)return vo(this,n),this;var a=this._events[n];if(a.fn)a.fn===t&&(!s||a.once)&&(!r||a.context===r)&&vo(this,n);else{for(var u=0,c=[],p=a.length;u<p;u++)(a[u].fn!==t||s&&!a[u].once||r&&a[u].context!==r)&&c.push(a[u]);c.length?this._events[n]=c.length===1?c[0]:c:vo(this,n)}return this},"removeListener");rt.prototype.removeAllListeners=o(function(e){var t;return e?(t=nt?nt+e:e,this._events[t]&&vo(this,t)):(this._events=new Kr,this._eventsCount=0),this},"removeAllListeners");rt.prototype.off=rt.prototype.removeListener;rt.prototype.addListener=rt.prototype.on;rt.prefixed=nt;rt.EventEmitter=rt;typeof Qn<"u"&&(Qn.exports=rt)});var ld=pe((va,ba)=>{(function(i,e){typeof va=="object"&&typeof ba<"u"?ba.exports=e():typeof define=="function"&&define.amd?define(e):(i=typeof globalThis<"u"?globalThis:i||self,i.Compressor=e())})(va,function(){"use strict";function i(D,E){var T=Object.keys(D);if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(D);E&&(L=L.filter(function(X){return Object.getOwnPropertyDescriptor(D,X).enumerable})),T.push.apply(T,L)}return T}o(i,"ownKeys");function e(D){for(var E=1;E<arguments.length;E++){var T=arguments[E]!=null?arguments[E]:{};E%2?i(Object(T),!0).forEach(function(L){n(D,L,T[L])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(T)):i(Object(T)).forEach(function(L){Object.defineProperty(D,L,Object.getOwnPropertyDescriptor(T,L))})}return D}o(e,"_objectSpread2");function t(D,E){if(!(D instanceof E))throw new TypeError("Cannot call a class as a function")}o(t,"_classCallCheck");function r(D,E){for(var T=0;T<E.length;T++){var L=E[T];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(D,c(L.key),L)}}o(r,"_defineProperties");function s(D,E,T){return E&&r(D.prototype,E),T&&r(D,T),Object.defineProperty(D,"prototype",{writable:!1}),D}o(s,"_createClass");function n(D,E,T){return E=c(E),E in D?Object.defineProperty(D,E,{value:T,enumerable:!0,configurable:!0,writable:!0}):D[E]=T,D}o(n,"_defineProperty");function a(){return a=Object.assign?Object.assign.bind():function(D){for(var E=1;E<arguments.length;E++){var T=arguments[E];for(var L in T)Object.prototype.hasOwnProperty.call(T,L)&&(D[L]=T[L])}return D},a.apply(this,arguments)}o(a,"_extends");function u(D,E){if(typeof D!="object"||D===null)return D;var T=D[Symbol.toPrimitive];if(T!==void 0){var L=T.call(D,E||"default");if(typeof L!="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(D)}o(u,"_toPrimitive");function c(D){var E=u(D,"string");return typeof E=="symbol"?E:String(E)}o(c,"_toPropertyKey");var p={exports:{}};(function(D){typeof window>"u"||function(E){var T=E.HTMLCanvasElement&&E.HTMLCanvasElement.prototype,L=E.Blob&&function(){try{return!!new Blob}catch{return!1}}(),X=L&&E.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),Y=E.BlobBuilder||E.WebKitBlobBuilder||E.MozBlobBuilder||E.MSBlobBuilder,ce=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,le=(L||Y)&&E.atob&&E.ArrayBuffer&&E.Uint8Array&&function(re){var se,xe,Ee,st,Ae,ee,et,Ue,Nt;if(se=re.match(ce),!se)throw new Error("invalid data URI");for(xe=se[2]?se[1]:"text/plain"+(se[3]||";charset=US-ASCII"),Ee=!!se[4],st=re.slice(se[0].length),Ee?Ae=atob(st):Ae=decodeURIComponent(st),ee=new ArrayBuffer(Ae.length),et=new Uint8Array(ee),Ue=0;Ue<Ae.length;Ue+=1)et[Ue]=Ae.charCodeAt(Ue);return L?new Blob([X?et:ee],{type:xe}):(Nt=new Y,Nt.append(ee),Nt.getBlob(xe))};E.HTMLCanvasElement&&!T.toBlob&&(T.mozGetAsFile?T.toBlob=function(re,se,xe){var Ee=this;setTimeout(function(){xe&&T.toDataURL&&le?re(le(Ee.toDataURL(se,xe))):re(Ee.mozGetAsFile("blob",se))})}:T.toDataURL&&le&&(T.msToBlob?T.toBlob=function(re,se,xe){var Ee=this;setTimeout(function(){(se&&se!=="image/png"||xe)&&T.toDataURL&&le?re(le(Ee.toDataURL(se,xe))):re(Ee.msToBlob(se))})}:T.toBlob=function(re,se,xe){var Ee=this;setTimeout(function(){re(le(Ee.toDataURL(se,xe)))})})),D.exports?D.exports=le:E.dataURLtoBlob=le}(window)})(p);var g=p.exports,h=o(function(E){return typeof Blob>"u"?!1:E instanceof Blob||Object.prototype.toString.call(E)==="[object Blob]"},"isBlob"),b={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},P=typeof window<"u"&&typeof window.document<"u",F=P?window:{},M=o(function(E){return E>0&&E<1/0},"isPositiveNumber"),C=Array.prototype.slice;function O(D){return Array.from?Array.from(D):C.call(D)}o(O,"toArray");var U=/^image\/.+$/;function A(D){return U.test(D)}o(A,"isImageType");function J(D){var E=A(D)?D.substr(6):"";return E==="jpeg"&&(E="jpg"),".".concat(E)}o(J,"imageTypeToExtension");var G=String.fromCharCode;function W(D,E,T){var L="",X;for(T+=E,X=E;X<T;X+=1)L+=G(D.getUint8(X));return L}o(W,"getStringFromCharCode");var K=F.btoa;function te(D,E){for(var T=[],L=8192,X=new Uint8Array(D);X.length>0;)T.push(G.apply(null,O(X.subarray(0,L)))),X=X.subarray(L);return"data:".concat(E,";base64,").concat(K(T.join("")))}o(te,"arrayBufferToDataURL");function Q(D){var E=new DataView(D),T;try{var L,X,Y;if(E.getUint8(0)===255&&E.getUint8(1)===216)for(var ce=E.byteLength,le=2;le+1<ce;){if(E.getUint8(le)===255&&E.getUint8(le+1)===225){X=le;break}le+=1}if(X){var re=X+4,se=X+10;if(W(E,re,4)==="Exif"){var xe=E.getUint16(se);if(L=xe===18761,(L||xe===19789)&&E.getUint16(se+2,L)===42){var Ee=E.getUint32(se+4,L);Ee>=8&&(Y=se+Ee)}}}if(Y){var st=E.getUint16(Y,L),Ae,ee;for(ee=0;ee<st;ee+=1)if(Ae=Y+ee*12+2,E.getUint16(Ae,L)===274){Ae+=8,T=E.getUint16(Ae,L),E.setUint16(Ae,1,L);break}}}catch{T=1}return T}o(Q,"resetAndGetOrientation");function be(D){var E=0,T=1,L=1;switch(D){case 2:T=-1;break;case 3:E=-180;break;case 4:L=-1;break;case 5:E=90,L=-1;break;case 6:E=90;break;case 7:E=90,T=-1;break;case 8:E=-90;break}return{rotate:E,scaleX:T,scaleY:L}}o(be,"parseOrientation");var ne=/\.\d*(?:0|9){12}\d*$/;function Pe(D){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return ne.test(D)?Math.round(D*E)/E:D}o(Pe,"normalizeDecimalNumber");function ye(D){var E=D.aspectRatio,T=D.height,L=D.width,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",Y=M(L),ce=M(T);if(Y&&ce){var le=T*E;(X==="contain"||X==="none")&&le>L||X==="cover"&&le<L?T=L/E:L=T*E}else Y?T=L/E:ce&&(L=T*E);return{width:L,height:T}}o(ye,"getAdjustedSizes");function Te(D){for(var E=O(new Uint8Array(D)),T=E.length,L=[],X=0;X+3<T;){var Y=E[X],ce=E[X+1];if(Y===255&&ce===218)break;if(Y===255&&ce===216)X+=2;else{var le=E[X+2]*256+E[X+3],re=X+le+2,se=E.slice(X,re);L.push(se),X=re}}return L.reduce(function(xe,Ee){return Ee[0]===255&&Ee[1]===225?xe.concat(Ee):xe},[])}o(Te,"getExif");function Se(D,E){var T=O(new Uint8Array(D));if(T[2]!==255||T[3]!==224)return D;var L=T[4]*256+T[5],X=[255,216].concat(E,T.slice(4+L));return new Uint8Array(X)}o(Se,"insertExif");var k=F.ArrayBuffer,w=F.FileReader,S=F.URL||F.webkitURL,B=/\.\w+$/,q=F.Compressor,z=function(){function D(E,T){t(this,D),this.file=E,this.exif=[],this.image=new Image,this.options=e(e({},b),T),this.aborted=!1,this.result=null,this.init()}return o(D,"Compressor"),s(D,[{key:"init",value:o(function(){var T=this,L=this.file,X=this.options;if(!h(L)){this.fail(new Error("The first argument must be a File or Blob object."));return}var Y=L.type;if(!A(Y)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!S||!w){this.fail(new Error("The current browser does not support image compression."));return}k||(X.checkOrientation=!1,X.retainExif=!1);var ce=Y==="image/jpeg",le=ce&&X.checkOrientation,re=ce&&X.retainExif;if(S&&!le&&!re)this.load({url:S.createObjectURL(L)});else{var se=new w;this.reader=se,se.onload=function(xe){var Ee=xe.target,st=Ee.result,Ae={},ee=1;le&&(ee=Q(st),ee>1&&a(Ae,be(ee))),re&&(T.exif=Te(st)),le||re?!S||ee>1?Ae.url=te(st,Y):Ae.url=S.createObjectURL(L):Ae.url=st,T.load(Ae)},se.onabort=function(){T.fail(new Error("Aborted to read the image with FileReader."))},se.onerror=function(){T.fail(new Error("Failed to read the image with FileReader."))},se.onloadend=function(){T.reader=null},le||re?se.readAsArrayBuffer(L):se.readAsDataURL(L)}},"init")},{key:"load",value:o(function(T){var L=this,X=this.file,Y=this.image;Y.onload=function(){L.draw(e(e({},T),{},{naturalWidth:Y.naturalWidth,naturalHeight:Y.naturalHeight}))},Y.onabort=function(){L.fail(new Error("Aborted to load the image."))},Y.onerror=function(){L.fail(new Error("Failed to load the image."))},F.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(F.navigator.userAgent)&&(Y.crossOrigin="anonymous"),Y.alt=X.name,Y.src=T.url},"load")},{key:"draw",value:o(function(T){var L=this,X=T.naturalWidth,Y=T.naturalHeight,ce=T.rotate,le=ce===void 0?0:ce,re=T.scaleX,se=re===void 0?1:re,xe=T.scaleY,Ee=xe===void 0?1:xe,st=this.file,Ae=this.image,ee=this.options,et=document.createElement("canvas"),Ue=et.getContext("2d"),Nt=Math.abs(le)%180===90,Mi=(ee.resize==="contain"||ee.resize==="cover")&&M(ee.width)&&M(ee.height),$t=Math.max(ee.maxWidth,0)||1/0,Mt=Math.max(ee.maxHeight,0)||1/0,Wt=Math.max(ee.minWidth,0)||0,mi=Math.max(ee.minHeight,0)||0,Gt=X/Y,Ve=ee.width,$e=ee.height;if(Nt){var _r=[Mt,$t];$t=_r[0],Mt=_r[1];var Pr=[mi,Wt];Wt=Pr[0],mi=Pr[1];var kr=[$e,Ve];Ve=kr[0],$e=kr[1]}Mi&&(Gt=Ve/$e);var js=ye({aspectRatio:Gt,width:$t,height:Mt},"contain");$t=js.width,Mt=js.height;var zs=ye({aspectRatio:Gt,width:Wt,height:mi},"cover");if(Wt=zs.width,mi=zs.height,Mi){var oe=ye({aspectRatio:Gt,width:Ve,height:$e},ee.resize);Ve=oe.width,$e=oe.height}else{var Er=ye({aspectRatio:Gt,width:Ve,height:$e}),Li=Er.width;Ve=Li===void 0?X:Li;var Ft=Er.height;$e=Ft===void 0?Y:Ft}Ve=Math.floor(Pe(Math.min(Math.max(Ve,Wt),$t))),$e=Math.floor(Pe(Math.min(Math.max($e,mi),Mt)));var cn=-Ve/2,Kt=-$e/2,tt=Ve,pn=$e,Bi=[];if(Mi){var Fe=0,ve=0,Fr=X,Ct=Y,Hs=ye({aspectRatio:Gt,width:X,height:Y},{contain:"cover",cover:"contain"}[ee.resize]);Fr=Hs.width,Ct=Hs.height,Fe=(X-Fr)/2,ve=(Y-Ct)/2,Bi.push(Fe,ve,Fr,Ct)}if(Bi.push(cn,Kt,tt,pn),Nt){var _t=[$e,Ve];Ve=_t[0],$e=_t[1]}et.width=Ve,et.height=$e,A(ee.mimeType)||(ee.mimeType=st.type);var qs="transparent";st.size>ee.convertSize&&ee.convertTypes.indexOf(ee.mimeType)>=0&&(ee.mimeType="image/jpeg");var Re=ee.mimeType==="image/jpeg";if(Re&&(qs="#fff"),Ue.fillStyle=qs,Ue.fillRect(0,0,Ve,$e),ee.beforeDraw&&ee.beforeDraw.call(this,Ue,et),!this.aborted&&(Ue.save(),Ue.translate(Ve/2,$e/2),Ue.rotate(le*Math.PI/180),Ue.scale(se,Ee),Ue.drawImage.apply(Ue,[Ae].concat(Bi)),Ue.restore(),ee.drew&&ee.drew.call(this,Ue,et),!this.aborted)){var dt=o(function(yi){if(!L.aborted){var ji=o(function(Xt){return L.done({naturalWidth:X,naturalHeight:Y,result:Xt})},"done");if(yi&&Re&&ee.retainExif&&L.exif&&L.exif.length>0){var zi=o(function(Xt){return ji(g(te(Se(Xt,L.exif),ee.mimeType)))},"next");if(yi.arrayBuffer)yi.arrayBuffer().then(zi).catch(function(){L.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var yt=new w;L.reader=yt,yt.onload=function(Cr){var Xt=Cr.target;zi(Xt.result)},yt.onabort=function(){L.fail(new Error("Aborted to read the compressed image with FileReader."))},yt.onerror=function(){L.fail(new Error("Failed to read the compressed image with FileReader."))},yt.onloadend=function(){L.reader=null},yt.readAsArrayBuffer(yi)}}else ji(yi)}},"callback");et.toBlob?et.toBlob(dt,ee.mimeType,ee.quality):dt(g(et.toDataURL(ee.mimeType,ee.quality)))}},"draw")},{key:"done",value:o(function(T){var L=T.naturalWidth,X=T.naturalHeight,Y=T.result,ce=this.file,le=this.image,re=this.options;if(S&&le.src.indexOf("blob:")===0&&S.revokeObjectURL(le.src),Y)if(re.strict&&!re.retainExif&&Y.size>ce.size&&re.mimeType===ce.type&&!(re.width>L||re.height>X||re.minWidth>L||re.minHeight>X||re.maxWidth<L||re.maxHeight<X))Y=ce;else{var se=new Date;Y.lastModified=se.getTime(),Y.lastModifiedDate=se,Y.name=ce.name,Y.name&&Y.type!==ce.type&&(Y.name=Y.name.replace(B,J(Y.type)))}else Y=ce;this.result=Y,re.success&&re.success.call(this,Y)},"done")},{key:"fail",value:o(function(T){var L=this.options;if(L.error)L.error.call(this,T);else throw T},"fail")},{key:"abort",value:o(function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))},"abort")}],[{key:"noConflict",value:o(function(){return window.Compressor=q,D},"noConflict")},{key:"setDefaults",value:o(function(T){a(b,T)},"setDefaults")}]),D}();return z})});var Qh=pe((cl,pl)=>{(function(i,e){typeof cl=="object"&&typeof pl<"u"?pl.exports=e():typeof define=="function"&&define.amd?define(e):(i=typeof globalThis<"u"?globalThis:i||self,i.Cropper=e())})(cl,function(){"use strict";function i(y,d){var m=Object.keys(y);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(y);d&&(f=f.filter(function(_){return Object.getOwnPropertyDescriptor(y,_).enumerable})),m.push.apply(m,f)}return m}o(i,"ownKeys");function e(y){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?i(Object(m),!0).forEach(function(f){c(y,f,m[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(m)):i(Object(m)).forEach(function(f){Object.defineProperty(y,f,Object.getOwnPropertyDescriptor(m,f))})}return y}o(e,"_objectSpread2");function t(y,d){if(typeof y!="object"||!y)return y;var m=y[Symbol.toPrimitive];if(m!==void 0){var f=m.call(y,d||"default");if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(y)}o(t,"_toPrimitive");function r(y){var d=t(y,"string");return typeof d=="symbol"?d:d+""}o(r,"_toPropertyKey");function s(y){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},s(y)}o(s,"_typeof");function n(y,d){if(!(y instanceof d))throw new TypeError("Cannot call a class as a function")}o(n,"_classCallCheck");function a(y,d){for(var m=0;m<d.length;m++){var f=d[m];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,r(f.key),f)}}o(a,"_defineProperties");function u(y,d,m){return d&&a(y.prototype,d),m&&a(y,m),Object.defineProperty(y,"prototype",{writable:!1}),y}o(u,"_createClass");function c(y,d,m){return d=r(d),d in y?Object.defineProperty(y,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):y[d]=m,y}o(c,"_defineProperty");function p(y){return g(y)||h(y)||b(y)||F()}o(p,"_toConsumableArray");function g(y){if(Array.isArray(y))return P(y)}o(g,"_arrayWithoutHoles");function h(y){if(typeof Symbol<"u"&&y[Symbol.iterator]!=null||y["@@iterator"]!=null)return Array.from(y)}o(h,"_iterableToArray");function b(y,d){if(y){if(typeof y=="string")return P(y,d);var m=Object.prototype.toString.call(y).slice(8,-1);if(m==="Object"&&y.constructor&&(m=y.constructor.name),m==="Map"||m==="Set")return Array.from(y);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return P(y,d)}}o(b,"_unsupportedIterableToArray");function P(y,d){(d==null||d>y.length)&&(d=y.length);for(var m=0,f=new Array(d);m<d;m++)f[m]=y[m];return f}o(P,"_arrayLikeToArray");function F(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}o(F,"_nonIterableSpread");var M=typeof window<"u"&&typeof window.document<"u",C=M?window:{},O=M&&C.document.documentElement?"ontouchstart"in C.document.documentElement:!1,U=M?"PointerEvent"in C:!1,A="cropper",J="all",G="crop",W="move",K="zoom",te="e",Q="w",be="s",ne="n",Pe="ne",ye="nw",Te="se",Se="sw",k="".concat(A,"-crop"),w="".concat(A,"-disabled"),S="".concat(A,"-hidden"),B="".concat(A,"-hide"),q="".concat(A,"-invisible"),z="".concat(A,"-modal"),D="".concat(A,"-move"),E="".concat(A,"Action"),T="".concat(A,"Preview"),L="crop",X="move",Y="none",ce="crop",le="cropend",re="cropmove",se="cropstart",xe="dblclick",Ee=O?"touchstart":"mousedown",st=O?"touchmove":"mousemove",Ae=O?"touchend touchcancel":"mouseup",ee=U?"pointerdown":Ee,et=U?"pointermove":st,Ue=U?"pointerup pointercancel":Ae,Nt="ready",Mi="resize",$t="wheel",Mt="zoom",Wt="image/jpeg",mi=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Gt=/^data:/,Ve=/^data:image\/jpeg;base64,/,$e=/^img|canvas$/i,_r=200,Pr=100,kr={viewMode:0,dragMode:L,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:_r,minContainerHeight:Pr,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},js='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',zs=Number.isNaN||C.isNaN;function oe(y){return typeof y=="number"&&!zs(y)}o(oe,"isNumber");var Er=o(function(d){return d>0&&d<1/0},"isPositiveNumber");function Li(y){return typeof y>"u"}o(Li,"isUndefined");function Ft(y){return s(y)==="object"&&y!==null}o(Ft,"isObject");var cn=Object.prototype.hasOwnProperty;function Kt(y){if(!Ft(y))return!1;try{var d=y.constructor,m=d.prototype;return d&&m&&cn.call(m,"isPrototypeOf")}catch{return!1}}o(Kt,"isPlainObject");function tt(y){return typeof y=="function"}o(tt,"isFunction");var pn=Array.prototype.slice;function Bi(y){return Array.from?Array.from(y):pn.call(y)}o(Bi,"toArray");function Fe(y,d){return y&&tt(d)&&(Array.isArray(y)||oe(y.length)?Bi(y).forEach(function(m,f){d.call(y,m,f,y)}):Ft(y)&&Object.keys(y).forEach(function(m){d.call(y,y[m],m,y)})),y}o(Fe,"forEach");var ve=Object.assign||o(function(d){for(var m=arguments.length,f=new Array(m>1?m-1:0),_=1;_<m;_++)f[_-1]=arguments[_];return Ft(d)&&f.length>0&&f.forEach(function(v){Ft(v)&&Object.keys(v).forEach(function(x){d[x]=v[x]})}),d},"assign"),Fr=/\.\d*(?:0|9){12}\d*$/;function Ct(y){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Fr.test(y)?Math.round(y*d)/d:y}o(Ct,"normalizeDecimalNumber");var Hs=/^width|height|left|top|marginLeft|marginTop$/;function _t(y,d){var m=y.style;Fe(d,function(f,_){Hs.test(_)&&oe(f)&&(f="".concat(f,"px")),m[_]=f})}o(_t,"setStyle");function qs(y,d){return y.classList?y.classList.contains(d):y.className.indexOf(d)>-1}o(qs,"hasClass");function Re(y,d){if(d){if(oe(y.length)){Fe(y,function(f){Re(f,d)});return}if(y.classList){y.classList.add(d);return}var m=y.className.trim();m?m.indexOf(d)<0&&(y.className="".concat(m," ").concat(d)):y.className=d}}o(Re,"addClass");function dt(y,d){if(d){if(oe(y.length)){Fe(y,function(m){dt(m,d)});return}if(y.classList){y.classList.remove(d);return}y.className.indexOf(d)>=0&&(y.className=y.className.replace(d,""))}}o(dt,"removeClass");function gi(y,d,m){if(d){if(oe(y.length)){Fe(y,function(f){gi(f,d,m)});return}m?Re(y,d):dt(y,d)}}o(gi,"toggleClass");var yi=/([a-z\d])([A-Z])/g;function ji(y){return y.replace(yi,"$1-$2").toLowerCase()}o(ji,"toParamCase");function zi(y,d){return Ft(y[d])?y[d]:y.dataset?y.dataset[d]:y.getAttribute("data-".concat(ji(d)))}o(zi,"getData");function yt(y,d,m){Ft(m)?y[d]=m:y.dataset?y.dataset[d]=m:y.setAttribute("data-".concat(ji(d)),m)}o(yt,"setData");function Cr(y,d){if(Ft(y[d]))try{delete y[d]}catch{y[d]=void 0}else if(y.dataset)try{delete y.dataset[d]}catch{y.dataset[d]=void 0}else y.removeAttribute("data-".concat(ji(d)))}o(Cr,"removeData");var Xt=/\s\s*/,fu=function(){var y=!1;if(M){var d=!1,m=o(function(){},"listener"),f=Object.defineProperty({},"once",{get:o(function(){return y=!0,d},"get"),set:o(function(v){d=v},"set")});C.addEventListener("test",m,f),C.removeEventListener("test",m,f)}return y}();function Pt(y,d,m){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},_=m;d.trim().split(Xt).forEach(function(v){if(!fu){var x=y.listeners;x&&x[v]&&x[v][m]&&(_=x[v][m],delete x[v][m],Object.keys(x[v]).length===0&&delete x[v],Object.keys(x).length===0&&delete y.listeners)}y.removeEventListener(v,_,f)})}o(Pt,"removeListener");function vt(y,d,m){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},_=m;d.trim().split(Xt).forEach(function(v){if(f.once&&!fu){var x=y.listeners,R=x===void 0?{}:x;_=o(function(){delete R[v][m],y.removeEventListener(v,_,f);for(var j=arguments.length,I=new Array(j),N=0;N<j;N++)I[N]=arguments[N];m.apply(y,I)},"handler"),R[v]||(R[v]={}),R[v][m]&&y.removeEventListener(v,R[v][m],f),R[v][m]=_,y.listeners=R}y.addEventListener(v,_,f)})}o(vt,"addListener");function Hi(y,d,m){var f;return tt(Event)&&tt(CustomEvent)?f=new CustomEvent(d,{detail:m,bubbles:!0,cancelable:!0}):(f=document.createEvent("CustomEvent"),f.initCustomEvent(d,!0,!0,m)),y.dispatchEvent(f)}o(Hi,"dispatchEvent");function mu(y){var d=y.getBoundingClientRect();return{left:d.left+(window.pageXOffset-document.documentElement.clientLeft),top:d.top+(window.pageYOffset-document.documentElement.clientTop)}}o(mu,"getOffset");var dn=C.location,mg=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function gu(y){var d=y.match(mg);return d!==null&&(d[1]!==dn.protocol||d[2]!==dn.hostname||d[3]!==dn.port)}o(gu,"isCrossOriginURL");function yu(y){var d="timestamp=".concat(new Date().getTime());return y+(y.indexOf("?")===-1?"?":"&")+d}o(yu,"addTimestamp");function Tr(y){var d=y.rotate,m=y.scaleX,f=y.scaleY,_=y.translateX,v=y.translateY,x=[];oe(_)&&_!==0&&x.push("translateX(".concat(_,"px)")),oe(v)&&v!==0&&x.push("translateY(".concat(v,"px)")),oe(d)&&d!==0&&x.push("rotate(".concat(d,"deg)")),oe(m)&&m!==1&&x.push("scaleX(".concat(m,")")),oe(f)&&f!==1&&x.push("scaleY(".concat(f,")"));var R=x.length?x.join(" "):"none";return{WebkitTransform:R,msTransform:R,transform:R}}o(Tr,"getTransforms");function gg(y){var d=e({},y),m=0;return Fe(y,function(f,_){delete d[_],Fe(d,function(v){var x=Math.abs(f.startX-v.startX),R=Math.abs(f.startY-v.startY),V=Math.abs(f.endX-v.endX),j=Math.abs(f.endY-v.endY),I=Math.sqrt(x*x+R*R),N=Math.sqrt(V*V+j*j),H=(N-I)/I;Math.abs(H)>Math.abs(m)&&(m=H)})}),m}o(gg,"getMaxZoomRatio");function Vs(y,d){var m=y.pageX,f=y.pageY,_={endX:m,endY:f};return d?_:e({startX:m,startY:f},_)}o(Vs,"getPointer");function yg(y){var d=0,m=0,f=0;return Fe(y,function(_){var v=_.startX,x=_.startY;d+=v,m+=x,f+=1}),d/=f,m/=f,{pageX:d,pageY:m}}o(yg,"getPointersCenter");function Yt(y){var d=y.aspectRatio,m=y.height,f=y.width,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",v=Er(f),x=Er(m);if(v&&x){var R=m*d;_==="contain"&&R>f||_==="cover"&&R<f?m=f/d:f=m*d}else v?m=f/d:x&&(f=m*d);return{width:f,height:m}}o(Yt,"getAdjustedSizes");function vg(y){var d=y.width,m=y.height,f=y.degree;if(f=Math.abs(f)%180,f===90)return{width:m,height:d};var _=f%90*Math.PI/180,v=Math.sin(_),x=Math.cos(_),R=d*x+m*v,V=d*v+m*x;return f>90?{width:V,height:R}:{width:R,height:V}}o(vg,"getRotatedSizes");function bg(y,d,m,f){var _=d.aspectRatio,v=d.naturalWidth,x=d.naturalHeight,R=d.rotate,V=R===void 0?0:R,j=d.scaleX,I=j===void 0?1:j,N=d.scaleY,H=N===void 0?1:N,ue=m.aspectRatio,ae=m.naturalWidth,ke=m.naturalHeight,he=f.fillColor,je=he===void 0?"transparent":he,We=f.imageSmoothingEnabled,De=We===void 0?!0:We,Lt=f.imageSmoothingQuality,ht=Lt===void 0?"low":Lt,$=f.maxWidth,fe=$===void 0?1/0:$,ze=f.maxHeight,bt=ze===void 0?1/0:ze,Bt=f.minWidth,vi=Bt===void 0?0:Bt,bi=f.minHeight,Jt=bi===void 0?0:bi,Tt=document.createElement("canvas"),lt=Tt.getContext("2d"),wi=Yt({aspectRatio:ue,width:fe,height:bt}),$s=Yt({aspectRatio:ue,width:vi,height:Jt},"cover"),hn=Math.min(wi.width,Math.max($s.width,ae)),fn=Math.min(wi.height,Math.max($s.height,ke)),wu=Yt({aspectRatio:_,width:fe,height:bt}),Su=Yt({aspectRatio:_,width:vi,height:Jt},"cover"),xu=Math.min(wu.width,Math.max(Su.width,v)),_u=Math.min(wu.height,Math.max(Su.height,x)),Ug=[-xu/2,-_u/2,xu,_u];return Tt.width=Ct(hn),Tt.height=Ct(fn),lt.fillStyle=je,lt.fillRect(0,0,hn,fn),lt.save(),lt.translate(hn/2,fn/2),lt.rotate(V*Math.PI/180),lt.scale(I,H),lt.imageSmoothingEnabled=De,lt.imageSmoothingQuality=ht,lt.drawImage.apply(lt,[y].concat(p(Ug.map(function(Dg){return Math.floor(Ct(Dg))})))),lt.restore(),Tt}o(bg,"getSourceCanvas");var vu=String.fromCharCode;function wg(y,d,m){var f="";m+=d;for(var _=d;_<m;_+=1)f+=vu(y.getUint8(_));return f}o(wg,"getStringFromCharCode");var Sg=/^data:.*,/;function xg(y){var d=y.replace(Sg,""),m=atob(d),f=new ArrayBuffer(m.length),_=new Uint8Array(f);return Fe(_,function(v,x){_[x]=m.charCodeAt(x)}),f}o(xg,"dataURLToArrayBuffer");function _g(y,d){for(var m=[],f=8192,_=new Uint8Array(y);_.length>0;)m.push(vu.apply(null,Bi(_.subarray(0,f)))),_=_.subarray(f);return"data:".concat(d,";base64,").concat(btoa(m.join("")))}o(_g,"arrayBufferToDataURL");function Pg(y){var d=new DataView(y),m;try{var f,_,v;if(d.getUint8(0)===255&&d.getUint8(1)===216)for(var x=d.byteLength,R=2;R+1<x;){if(d.getUint8(R)===255&&d.getUint8(R+1)===225){_=R;break}R+=1}if(_){var V=_+4,j=_+10;if(wg(d,V,4)==="Exif"){var I=d.getUint16(j);if(f=I===18761,(f||I===19789)&&d.getUint16(j+2,f)===42){var N=d.getUint32(j+4,f);N>=8&&(v=j+N)}}}if(v){var H=d.getUint16(v,f),ue,ae;for(ae=0;ae<H;ae+=1)if(ue=v+ae*12+2,d.getUint16(ue,f)===274){ue+=8,m=d.getUint16(ue,f),d.setUint16(ue,1,f);break}}}catch{m=1}return m}o(Pg,"resetAndGetOrientation");function kg(y){var d=0,m=1,f=1;switch(y){case 2:m=-1;break;case 3:d=-180;break;case 4:f=-1;break;case 5:d=90,f=-1;break;case 6:d=90;break;case 7:d=90,m=-1;break;case 8:d=-90;break}return{rotate:d,scaleX:m,scaleY:f}}o(kg,"parseOrientation");var Eg={render:o(function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},"render"),initContainer:o(function(){var d=this.element,m=this.options,f=this.container,_=this.cropper,v=Number(m.minContainerWidth),x=Number(m.minContainerHeight);Re(_,S),dt(d,S);var R={width:Math.max(f.offsetWidth,v>=0?v:_r),height:Math.max(f.offsetHeight,x>=0?x:Pr)};this.containerData=R,_t(_,{width:R.width,height:R.height}),Re(d,S),dt(_,S)},"initContainer"),initCanvas:o(function(){var d=this.containerData,m=this.imageData,f=this.options.viewMode,_=Math.abs(m.rotate)%180===90,v=_?m.naturalHeight:m.naturalWidth,x=_?m.naturalWidth:m.naturalHeight,R=v/x,V=d.width,j=d.height;d.height*R>d.width?f===3?V=d.height*R:j=d.width/R:f===3?j=d.width/R:V=d.height*R;var I={aspectRatio:R,naturalWidth:v,naturalHeight:x,width:V,height:j};this.canvasData=I,this.limited=f===1||f===2,this.limitCanvas(!0,!0),I.width=Math.min(Math.max(I.width,I.minWidth),I.maxWidth),I.height=Math.min(Math.max(I.height,I.minHeight),I.maxHeight),I.left=(d.width-I.width)/2,I.top=(d.height-I.height)/2,I.oldLeft=I.left,I.oldTop=I.top,this.initialCanvasData=ve({},I)},"initCanvas"),limitCanvas:o(function(d,m){var f=this.options,_=this.containerData,v=this.canvasData,x=this.cropBoxData,R=f.viewMode,V=v.aspectRatio,j=this.cropped&&x;if(d){var I=Number(f.minCanvasWidth)||0,N=Number(f.minCanvasHeight)||0;R>1?(I=Math.max(I,_.width),N=Math.max(N,_.height),R===3&&(N*V>I?I=N*V:N=I/V)):R>0&&(I?I=Math.max(I,j?x.width:0):N?N=Math.max(N,j?x.height:0):j&&(I=x.width,N=x.height,N*V>I?I=N*V:N=I/V));var H=Yt({aspectRatio:V,width:I,height:N});I=H.width,N=H.height,v.minWidth=I,v.minHeight=N,v.maxWidth=1/0,v.maxHeight=1/0}if(m)if(R>(j?0:1)){var ue=_.width-v.width,ae=_.height-v.height;v.minLeft=Math.min(0,ue),v.minTop=Math.min(0,ae),v.maxLeft=Math.max(0,ue),v.maxTop=Math.max(0,ae),j&&this.limited&&(v.minLeft=Math.min(x.left,x.left+(x.width-v.width)),v.minTop=Math.min(x.top,x.top+(x.height-v.height)),v.maxLeft=x.left,v.maxTop=x.top,R===2&&(v.width>=_.width&&(v.minLeft=Math.min(0,ue),v.maxLeft=Math.max(0,ue)),v.height>=_.height&&(v.minTop=Math.min(0,ae),v.maxTop=Math.max(0,ae))))}else v.minLeft=-v.width,v.minTop=-v.height,v.maxLeft=_.width,v.maxTop=_.height},"limitCanvas"),renderCanvas:o(function(d,m){var f=this.canvasData,_=this.imageData;if(m){var v=vg({width:_.naturalWidth*Math.abs(_.scaleX||1),height:_.naturalHeight*Math.abs(_.scaleY||1),degree:_.rotate||0}),x=v.width,R=v.height,V=f.width*(x/f.naturalWidth),j=f.height*(R/f.naturalHeight);f.left-=(V-f.width)/2,f.top-=(j-f.height)/2,f.width=V,f.height=j,f.aspectRatio=x/R,f.naturalWidth=x,f.naturalHeight=R,this.limitCanvas(!0,!1)}(f.width>f.maxWidth||f.width<f.minWidth)&&(f.left=f.oldLeft),(f.height>f.maxHeight||f.height<f.minHeight)&&(f.top=f.oldTop),f.width=Math.min(Math.max(f.width,f.minWidth),f.maxWidth),f.height=Math.min(Math.max(f.height,f.minHeight),f.maxHeight),this.limitCanvas(!1,!0),f.left=Math.min(Math.max(f.left,f.minLeft),f.maxLeft),f.top=Math.min(Math.max(f.top,f.minTop),f.maxTop),f.oldLeft=f.left,f.oldTop=f.top,_t(this.canvas,ve({width:f.width,height:f.height},Tr({translateX:f.left,translateY:f.top}))),this.renderImage(d),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},"renderCanvas"),renderImage:o(function(d){var m=this.canvasData,f=this.imageData,_=f.naturalWidth*(m.width/m.naturalWidth),v=f.naturalHeight*(m.height/m.naturalHeight);ve(f,{width:_,height:v,left:(m.width-_)/2,top:(m.height-v)/2}),_t(this.image,ve({width:f.width,height:f.height},Tr(ve({translateX:f.left,translateY:f.top},f)))),d&&this.output()},"renderImage"),initCropBox:o(function(){var d=this.options,m=this.canvasData,f=d.aspectRatio||d.initialAspectRatio,_=Number(d.autoCropArea)||.8,v={width:m.width,height:m.height};f&&(m.height*f>m.width?v.height=v.width/f:v.width=v.height*f),this.cropBoxData=v,this.limitCropBox(!0,!0),v.width=Math.min(Math.max(v.width,v.minWidth),v.maxWidth),v.height=Math.min(Math.max(v.height,v.minHeight),v.maxHeight),v.width=Math.max(v.minWidth,v.width*_),v.height=Math.max(v.minHeight,v.height*_),v.left=m.left+(m.width-v.width)/2,v.top=m.top+(m.height-v.height)/2,v.oldLeft=v.left,v.oldTop=v.top,this.initialCropBoxData=ve({},v)},"initCropBox"),limitCropBox:o(function(d,m){var f=this.options,_=this.containerData,v=this.canvasData,x=this.cropBoxData,R=this.limited,V=f.aspectRatio;if(d){var j=Number(f.minCropBoxWidth)||0,I=Number(f.minCropBoxHeight)||0,N=R?Math.min(_.width,v.width,v.width+v.left,_.width-v.left):_.width,H=R?Math.min(_.height,v.height,v.height+v.top,_.height-v.top):_.height;j=Math.min(j,_.width),I=Math.min(I,_.height),V&&(j&&I?I*V>j?I=j/V:j=I*V:j?I=j/V:I&&(j=I*V),H*V>N?H=N/V:N=H*V),x.minWidth=Math.min(j,N),x.minHeight=Math.min(I,H),x.maxWidth=N,x.maxHeight=H}m&&(R?(x.minLeft=Math.max(0,v.left),x.minTop=Math.max(0,v.top),x.maxLeft=Math.min(_.width,v.left+v.width)-x.width,x.maxTop=Math.min(_.height,v.top+v.height)-x.height):(x.minLeft=0,x.minTop=0,x.maxLeft=_.width-x.width,x.maxTop=_.height-x.height))},"limitCropBox"),renderCropBox:o(function(){var d=this.options,m=this.containerData,f=this.cropBoxData;(f.width>f.maxWidth||f.width<f.minWidth)&&(f.left=f.oldLeft),(f.height>f.maxHeight||f.height<f.minHeight)&&(f.top=f.oldTop),f.width=Math.min(Math.max(f.width,f.minWidth),f.maxWidth),f.height=Math.min(Math.max(f.height,f.minHeight),f.maxHeight),this.limitCropBox(!1,!0),f.left=Math.min(Math.max(f.left,f.minLeft),f.maxLeft),f.top=Math.min(Math.max(f.top,f.minTop),f.maxTop),f.oldLeft=f.left,f.oldTop=f.top,d.movable&&d.cropBoxMovable&&yt(this.face,E,f.width>=m.width&&f.height>=m.height?W:J),_t(this.cropBox,ve({width:f.width,height:f.height},Tr({translateX:f.left,translateY:f.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},"renderCropBox"),output:o(function(){this.preview(),Hi(this.element,ce,this.getData())},"output")},Fg={initPreview:o(function(){var d=this.element,m=this.crossOrigin,f=this.options.preview,_=m?this.crossOriginUrl:this.url,v=d.alt||"The image to preview",x=document.createElement("img");if(m&&(x.crossOrigin=m),x.src=_,x.alt=v,this.viewBox.appendChild(x),this.viewBoxImage=x,!!f){var R=f;typeof f=="string"?R=d.ownerDocument.querySelectorAll(f):f.querySelector&&(R=[f]),this.previews=R,Fe(R,function(V){var j=document.createElement("img");yt(V,T,{width:V.offsetWidth,height:V.offsetHeight,html:V.innerHTML}),m&&(j.crossOrigin=m),j.src=_,j.alt=v,j.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',V.innerHTML="",V.appendChild(j)})}},"initPreview"),resetPreview:o(function(){Fe(this.previews,function(d){var m=zi(d,T);_t(d,{width:m.width,height:m.height}),d.innerHTML=m.html,Cr(d,T)})},"resetPreview"),preview:o(function(){var d=this.imageData,m=this.canvasData,f=this.cropBoxData,_=f.width,v=f.height,x=d.width,R=d.height,V=f.left-m.left-d.left,j=f.top-m.top-d.top;!this.cropped||this.disabled||(_t(this.viewBoxImage,ve({width:x,height:R},Tr(ve({translateX:-V,translateY:-j},d)))),Fe(this.previews,function(I){var N=zi(I,T),H=N.width,ue=N.height,ae=H,ke=ue,he=1;_&&(he=H/_,ke=v*he),v&&ke>ue&&(he=ue/v,ae=_*he,ke=ue),_t(I,{width:ae,height:ke}),_t(I.getElementsByTagName("img")[0],ve({width:x*he,height:R*he},Tr(ve({translateX:-V*he,translateY:-j*he},d))))}))},"preview")},Cg={bind:o(function(){var d=this.element,m=this.options,f=this.cropper;tt(m.cropstart)&&vt(d,se,m.cropstart),tt(m.cropmove)&&vt(d,re,m.cropmove),tt(m.cropend)&&vt(d,le,m.cropend),tt(m.crop)&&vt(d,ce,m.crop),tt(m.zoom)&&vt(d,Mt,m.zoom),vt(f,ee,this.onCropStart=this.cropStart.bind(this)),m.zoomable&&m.zoomOnWheel&&vt(f,$t,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),m.toggleDragModeOnDblclick&&vt(f,xe,this.onDblclick=this.dblclick.bind(this)),vt(d.ownerDocument,et,this.onCropMove=this.cropMove.bind(this)),vt(d.ownerDocument,Ue,this.onCropEnd=this.cropEnd.bind(this)),m.responsive&&vt(window,Mi,this.onResize=this.resize.bind(this))},"bind"),unbind:o(function(){var d=this.element,m=this.options,f=this.cropper;tt(m.cropstart)&&Pt(d,se,m.cropstart),tt(m.cropmove)&&Pt(d,re,m.cropmove),tt(m.cropend)&&Pt(d,le,m.cropend),tt(m.crop)&&Pt(d,ce,m.crop),tt(m.zoom)&&Pt(d,Mt,m.zoom),Pt(f,ee,this.onCropStart),m.zoomable&&m.zoomOnWheel&&Pt(f,$t,this.onWheel,{passive:!1,capture:!0}),m.toggleDragModeOnDblclick&&Pt(f,xe,this.onDblclick),Pt(d.ownerDocument,et,this.onCropMove),Pt(d.ownerDocument,Ue,this.onCropEnd),m.responsive&&Pt(window,Mi,this.onResize)},"unbind")},Tg={resize:o(function(){if(!this.disabled){var d=this.options,m=this.container,f=this.containerData,_=m.offsetWidth/f.width,v=m.offsetHeight/f.height,x=Math.abs(_-1)>Math.abs(v-1)?_:v;if(x!==1){var R,V;d.restore&&(R=this.getCanvasData(),V=this.getCropBoxData()),this.render(),d.restore&&(this.setCanvasData(Fe(R,function(j,I){R[I]=j*x})),this.setCropBoxData(Fe(V,function(j,I){V[I]=j*x})))}}},"resize"),dblclick:o(function(){this.disabled||this.options.dragMode===Y||this.setDragMode(qs(this.dragBox,k)?X:L)},"dblclick"),wheel:o(function(d){var m=this,f=Number(this.options.wheelZoomRatio)||.1,_=1;this.disabled||(d.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){m.wheeling=!1},50),d.deltaY?_=d.deltaY>0?1:-1:d.wheelDelta?_=-d.wheelDelta/120:d.detail&&(_=d.detail>0?1:-1),this.zoom(-_*f,d)))},"wheel"),cropStart:o(function(d){var m=d.buttons,f=d.button;if(!(this.disabled||(d.type==="mousedown"||d.type==="pointerdown"&&d.pointerType==="mouse")&&(oe(m)&&m!==1||oe(f)&&f!==0||d.ctrlKey))){var _=this.options,v=this.pointers,x;d.changedTouches?Fe(d.changedTouches,function(R){v[R.identifier]=Vs(R)}):v[d.pointerId||0]=Vs(d),Object.keys(v).length>1&&_.zoomable&&_.zoomOnTouch?x=K:x=zi(d.target,E),mi.test(x)&&Hi(this.element,se,{originalEvent:d,action:x})!==!1&&(d.preventDefault(),this.action=x,this.cropping=!1,x===G&&(this.cropping=!0,Re(this.dragBox,z)))}},"cropStart"),cropMove:o(function(d){var m=this.action;if(!(this.disabled||!m)){var f=this.pointers;d.preventDefault(),Hi(this.element,re,{originalEvent:d,action:m})!==!1&&(d.changedTouches?Fe(d.changedTouches,function(_){ve(f[_.identifier]||{},Vs(_,!0))}):ve(f[d.pointerId||0]||{},Vs(d,!0)),this.change(d))}},"cropMove"),cropEnd:o(function(d){if(!this.disabled){var m=this.action,f=this.pointers;d.changedTouches?Fe(d.changedTouches,function(_){delete f[_.identifier]}):delete f[d.pointerId||0],m&&(d.preventDefault(),Object.keys(f).length||(this.action=""),this.cropping&&(this.cropping=!1,gi(this.dragBox,z,this.cropped&&this.options.modal)),Hi(this.element,le,{originalEvent:d,action:m}))}},"cropEnd")},Ag={change:o(function(d){var m=this.options,f=this.canvasData,_=this.containerData,v=this.cropBoxData,x=this.pointers,R=this.action,V=m.aspectRatio,j=v.left,I=v.top,N=v.width,H=v.height,ue=j+N,ae=I+H,ke=0,he=0,je=_.width,We=_.height,De=!0,Lt;!V&&d.shiftKey&&(V=N&&H?N/H:1),this.limited&&(ke=v.minLeft,he=v.minTop,je=ke+Math.min(_.width,f.width,f.left+f.width),We=he+Math.min(_.height,f.height,f.top+f.height));var ht=x[Object.keys(x)[0]],$={x:ht.endX-ht.startX,y:ht.endY-ht.startY},fe=o(function(bt){switch(bt){case te:ue+$.x>je&&($.x=je-ue);break;case Q:j+$.x<ke&&($.x=ke-j);break;case ne:I+$.y<he&&($.y=he-I);break;case be:ae+$.y>We&&($.y=We-ae);break}},"check");switch(R){case J:j+=$.x,I+=$.y;break;case te:if($.x>=0&&(ue>=je||V&&(I<=he||ae>=We))){De=!1;break}fe(te),N+=$.x,N<0&&(R=Q,N=-N,j-=N),V&&(H=N/V,I+=(v.height-H)/2);break;case ne:if($.y<=0&&(I<=he||V&&(j<=ke||ue>=je))){De=!1;break}fe(ne),H-=$.y,I+=$.y,H<0&&(R=be,H=-H,I-=H),V&&(N=H*V,j+=(v.width-N)/2);break;case Q:if($.x<=0&&(j<=ke||V&&(I<=he||ae>=We))){De=!1;break}fe(Q),N-=$.x,j+=$.x,N<0&&(R=te,N=-N,j-=N),V&&(H=N/V,I+=(v.height-H)/2);break;case be:if($.y>=0&&(ae>=We||V&&(j<=ke||ue>=je))){De=!1;break}fe(be),H+=$.y,H<0&&(R=ne,H=-H,I-=H),V&&(N=H*V,j+=(v.width-N)/2);break;case Pe:if(V){if($.y<=0&&(I<=he||ue>=je)){De=!1;break}fe(ne),H-=$.y,I+=$.y,N=H*V}else fe(ne),fe(te),$.x>=0?ue<je?N+=$.x:$.y<=0&&I<=he&&(De=!1):N+=$.x,$.y<=0?I>he&&(H-=$.y,I+=$.y):(H-=$.y,I+=$.y);N<0&&H<0?(R=Se,H=-H,N=-N,I-=H,j-=N):N<0?(R=ye,N=-N,j-=N):H<0&&(R=Te,H=-H,I-=H);break;case ye:if(V){if($.y<=0&&(I<=he||j<=ke)){De=!1;break}fe(ne),H-=$.y,I+=$.y,N=H*V,j+=v.width-N}else fe(ne),fe(Q),$.x<=0?j>ke?(N-=$.x,j+=$.x):$.y<=0&&I<=he&&(De=!1):(N-=$.x,j+=$.x),$.y<=0?I>he&&(H-=$.y,I+=$.y):(H-=$.y,I+=$.y);N<0&&H<0?(R=Te,H=-H,N=-N,I-=H,j-=N):N<0?(R=Pe,N=-N,j-=N):H<0&&(R=Se,H=-H,I-=H);break;case Se:if(V){if($.x<=0&&(j<=ke||ae>=We)){De=!1;break}fe(Q),N-=$.x,j+=$.x,H=N/V}else fe(be),fe(Q),$.x<=0?j>ke?(N-=$.x,j+=$.x):$.y>=0&&ae>=We&&(De=!1):(N-=$.x,j+=$.x),$.y>=0?ae<We&&(H+=$.y):H+=$.y;N<0&&H<0?(R=Pe,H=-H,N=-N,I-=H,j-=N):N<0?(R=Te,N=-N,j-=N):H<0&&(R=ye,H=-H,I-=H);break;case Te:if(V){if($.x>=0&&(ue>=je||ae>=We)){De=!1;break}fe(te),N+=$.x,H=N/V}else fe(be),fe(te),$.x>=0?ue<je?N+=$.x:$.y>=0&&ae>=We&&(De=!1):N+=$.x,$.y>=0?ae<We&&(H+=$.y):H+=$.y;N<0&&H<0?(R=ye,H=-H,N=-N,I-=H,j-=N):N<0?(R=Se,N=-N,j-=N):H<0&&(R=Pe,H=-H,I-=H);break;case W:this.move($.x,$.y),De=!1;break;case K:this.zoom(gg(x),d),De=!1;break;case G:if(!$.x||!$.y){De=!1;break}Lt=mu(this.cropper),j=ht.startX-Lt.left,I=ht.startY-Lt.top,N=v.minWidth,H=v.minHeight,$.x>0?R=$.y>0?Te:Pe:$.x<0&&(j-=N,R=$.y>0?Se:ye),$.y<0&&(I-=H),this.cropped||(dt(this.cropBox,S),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}De&&(v.width=N,v.height=H,v.left=j,v.top=I,this.action=R,this.renderCropBox()),Fe(x,function(ze){ze.startX=ze.endX,ze.startY=ze.endY})},"change")},Rg={crop:o(function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Re(this.dragBox,z),dt(this.cropBox,S),this.setCropBoxData(this.initialCropBoxData)),this},"crop"),reset:o(function(){return this.ready&&!this.disabled&&(this.imageData=ve({},this.initialImageData),this.canvasData=ve({},this.initialCanvasData),this.cropBoxData=ve({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},"reset"),clear:o(function(){return this.cropped&&!this.disabled&&(ve(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),dt(this.dragBox,z),Re(this.cropBox,S)),this},"clear"),replace:o(function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&d&&(this.isImg&&(this.element.src=d),m?(this.url=d,this.image.src=d,this.ready&&(this.viewBoxImage.src=d,Fe(this.previews,function(f){f.getElementsByTagName("img")[0].src=d}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(d))),this},"replace"),enable:o(function(){return this.ready&&this.disabled&&(this.disabled=!1,dt(this.cropper,w)),this},"enable"),disable:o(function(){return this.ready&&!this.disabled&&(this.disabled=!0,Re(this.cropper,w)),this},"disable"),destroy:o(function(){var d=this.element;return d[A]?(d[A]=void 0,this.isImg&&this.replaced&&(d.src=this.originalUrl),this.uncreate(),this):this},"destroy"),move:o(function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,f=this.canvasData,_=f.left,v=f.top;return this.moveTo(Li(d)?d:_+Number(d),Li(m)?m:v+Number(m))},"move"),moveTo:o(function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,f=this.canvasData,_=!1;return d=Number(d),m=Number(m),this.ready&&!this.disabled&&this.options.movable&&(oe(d)&&(f.left=d,_=!0),oe(m)&&(f.top=m,_=!0),_&&this.renderCanvas(!0)),this},"moveTo"),zoom:o(function(d,m){var f=this.canvasData;return d=Number(d),d<0?d=1/(1-d):d=1+d,this.zoomTo(f.width*d/f.naturalWidth,null,m)},"zoom"),zoomTo:o(function(d,m,f){var _=this.options,v=this.canvasData,x=v.width,R=v.height,V=v.naturalWidth,j=v.naturalHeight;if(d=Number(d),d>=0&&this.ready&&!this.disabled&&_.zoomable){var I=V*d,N=j*d;if(Hi(this.element,Mt,{ratio:d,oldRatio:x/V,originalEvent:f})===!1)return this;if(f){var H=this.pointers,ue=mu(this.cropper),ae=H&&Object.keys(H).length?yg(H):{pageX:f.pageX,pageY:f.pageY};v.left-=(I-x)*((ae.pageX-ue.left-v.left)/x),v.top-=(N-R)*((ae.pageY-ue.top-v.top)/R)}else Kt(m)&&oe(m.x)&&oe(m.y)?(v.left-=(I-x)*((m.x-v.left)/x),v.top-=(N-R)*((m.y-v.top)/R)):(v.left-=(I-x)/2,v.top-=(N-R)/2);v.width=I,v.height=N,this.renderCanvas(!0)}return this},"zoomTo"),rotate:o(function(d){return this.rotateTo((this.imageData.rotate||0)+Number(d))},"rotate"),rotateTo:o(function(d){return d=Number(d),oe(d)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=d%360,this.renderCanvas(!0,!0)),this},"rotateTo"),scaleX:o(function(d){var m=this.imageData.scaleY;return this.scale(d,oe(m)?m:1)},"scaleX"),scaleY:o(function(d){var m=this.imageData.scaleX;return this.scale(oe(m)?m:1,d)},"scaleY"),scale:o(function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,f=this.imageData,_=!1;return d=Number(d),m=Number(m),this.ready&&!this.disabled&&this.options.scalable&&(oe(d)&&(f.scaleX=d,_=!0),oe(m)&&(f.scaleY=m,_=!0),_&&this.renderCanvas(!0,!0)),this},"scale"),getData:o(function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.options,f=this.imageData,_=this.canvasData,v=this.cropBoxData,x;if(this.ready&&this.cropped){x={x:v.left-_.left,y:v.top-_.top,width:v.width,height:v.height};var R=f.width/f.naturalWidth;if(Fe(x,function(I,N){x[N]=I/R}),d){var V=Math.round(x.y+x.height),j=Math.round(x.x+x.width);x.x=Math.round(x.x),x.y=Math.round(x.y),x.width=j-x.x,x.height=V-x.y}}else x={x:0,y:0,width:0,height:0};return m.rotatable&&(x.rotate=f.rotate||0),m.scalable&&(x.scaleX=f.scaleX||1,x.scaleY=f.scaleY||1),x},"getData"),setData:o(function(d){var m=this.options,f=this.imageData,_=this.canvasData,v={};if(this.ready&&!this.disabled&&Kt(d)){var x=!1;m.rotatable&&oe(d.rotate)&&d.rotate!==f.rotate&&(f.rotate=d.rotate,x=!0),m.scalable&&(oe(d.scaleX)&&d.scaleX!==f.scaleX&&(f.scaleX=d.scaleX,x=!0),oe(d.scaleY)&&d.scaleY!==f.scaleY&&(f.scaleY=d.scaleY,x=!0)),x&&this.renderCanvas(!0,!0);var R=f.width/f.naturalWidth;oe(d.x)&&(v.left=d.x*R+_.left),oe(d.y)&&(v.top=d.y*R+_.top),oe(d.width)&&(v.width=d.width*R),oe(d.height)&&(v.height=d.height*R),this.setCropBoxData(v)}return this},"setData"),getContainerData:o(function(){return this.ready?ve({},this.containerData):{}},"getContainerData"),getImageData:o(function(){return this.sized?ve({},this.imageData):{}},"getImageData"),getCanvasData:o(function(){var d=this.canvasData,m={};return this.ready&&Fe(["left","top","width","height","naturalWidth","naturalHeight"],function(f){m[f]=d[f]}),m},"getCanvasData"),setCanvasData:o(function(d){var m=this.canvasData,f=m.aspectRatio;return this.ready&&!this.disabled&&Kt(d)&&(oe(d.left)&&(m.left=d.left),oe(d.top)&&(m.top=d.top),oe(d.width)?(m.width=d.width,m.height=d.width/f):oe(d.height)&&(m.height=d.height,m.width=d.height*f),this.renderCanvas(!0)),this},"setCanvasData"),getCropBoxData:o(function(){var d=this.cropBoxData,m;return this.ready&&this.cropped&&(m={left:d.left,top:d.top,width:d.width,height:d.height}),m||{}},"getCropBoxData"),setCropBoxData:o(function(d){var m=this.cropBoxData,f=this.options.aspectRatio,_,v;return this.ready&&this.cropped&&!this.disabled&&Kt(d)&&(oe(d.left)&&(m.left=d.left),oe(d.top)&&(m.top=d.top),oe(d.width)&&d.width!==m.width&&(_=!0,m.width=d.width),oe(d.height)&&d.height!==m.height&&(v=!0,m.height=d.height),f&&(_?m.height=m.width/f:v&&(m.width=m.height*f)),this.renderCropBox()),this},"setCropBoxData"),getCroppedCanvas:o(function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var m=this.canvasData,f=bg(this.image,this.imageData,m,d);if(!this.cropped)return f;var _=this.getData(d.rounded),v=_.x,x=_.y,R=_.width,V=_.height,j=f.width/Math.floor(m.naturalWidth);j!==1&&(v*=j,x*=j,R*=j,V*=j);var I=R/V,N=Yt({aspectRatio:I,width:d.maxWidth||1/0,height:d.maxHeight||1/0}),H=Yt({aspectRatio:I,width:d.minWidth||0,height:d.minHeight||0},"cover"),ue=Yt({aspectRatio:I,width:d.width||(j!==1?f.width:R),height:d.height||(j!==1?f.height:V)}),ae=ue.width,ke=ue.height;ae=Math.min(N.width,Math.max(H.width,ae)),ke=Math.min(N.height,Math.max(H.height,ke));var he=document.createElement("canvas"),je=he.getContext("2d");he.width=Ct(ae),he.height=Ct(ke),je.fillStyle=d.fillColor||"transparent",je.fillRect(0,0,ae,ke);var We=d.imageSmoothingEnabled,De=We===void 0?!0:We,Lt=d.imageSmoothingQuality;je.imageSmoothingEnabled=De,Lt&&(je.imageSmoothingQuality=Lt);var ht=f.width,$=f.height,fe=v,ze=x,bt,Bt,vi,bi,Jt,Tt;fe<=-R||fe>ht?(fe=0,bt=0,vi=0,Jt=0):fe<=0?(vi=-fe,fe=0,bt=Math.min(ht,R+fe),Jt=bt):fe<=ht&&(vi=0,bt=Math.min(R,ht-fe),Jt=bt),bt<=0||ze<=-V||ze>$?(ze=0,Bt=0,bi=0,Tt=0):ze<=0?(bi=-ze,ze=0,Bt=Math.min($,V+ze),Tt=Bt):ze<=$&&(bi=0,Bt=Math.min(V,$-ze),Tt=Bt);var lt=[fe,ze,bt,Bt];if(Jt>0&&Tt>0){var wi=ae/R;lt.push(vi*wi,bi*wi,Jt*wi,Tt*wi)}return je.drawImage.apply(je,[f].concat(p(lt.map(function($s){return Math.floor(Ct($s))})))),he},"getCroppedCanvas"),setAspectRatio:o(function(d){var m=this.options;return!this.disabled&&!Li(d)&&(m.aspectRatio=Math.max(0,d)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},"setAspectRatio"),setDragMode:o(function(d){var m=this.options,f=this.dragBox,_=this.face;if(this.ready&&!this.disabled){var v=d===L,x=m.movable&&d===X;d=v||x?d:Y,m.dragMode=d,yt(f,E,d),gi(f,k,v),gi(f,D,x),m.cropBoxMovable||(yt(_,E,d),gi(_,k,v),gi(_,D,x))}return this},"setDragMode")},Og=C.Cropper,bu=function(){function y(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n(this,y),!d||!$e.test(d.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=d,this.options=ve({},kr,Kt(m)&&m),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return o(y,"Cropper"),u(y,[{key:"init",value:o(function(){var m=this.element,f=m.tagName.toLowerCase(),_;if(!m[A]){if(m[A]=this,f==="img"){if(this.isImg=!0,_=m.getAttribute("src")||"",this.originalUrl=_,!_)return;_=m.src}else f==="canvas"&&window.HTMLCanvasElement&&(_=m.toDataURL());this.load(_)}},"init")},{key:"load",value:o(function(m){var f=this;if(m){this.url=m,this.imageData={};var _=this.element,v=this.options;if(!v.rotatable&&!v.scalable&&(v.checkOrientation=!1),!v.checkOrientation||!window.ArrayBuffer){this.clone();return}if(Gt.test(m)){Ve.test(m)?this.read(xg(m)):this.clone();return}var x=new XMLHttpRequest,R=this.clone.bind(this);this.reloading=!0,this.xhr=x,x.onabort=R,x.onerror=R,x.ontimeout=R,x.onprogress=function(){x.getResponseHeader("content-type")!==Wt&&x.abort()},x.onload=function(){f.read(x.response)},x.onloadend=function(){f.reloading=!1,f.xhr=null},v.checkCrossOrigin&&gu(m)&&_.crossOrigin&&(m=yu(m)),x.open("GET",m,!0),x.responseType="arraybuffer",x.withCredentials=_.crossOrigin==="use-credentials",x.send()}},"load")},{key:"read",value:o(function(m){var f=this.options,_=this.imageData,v=Pg(m),x=0,R=1,V=1;if(v>1){this.url=_g(m,Wt);var j=kg(v);x=j.rotate,R=j.scaleX,V=j.scaleY}f.rotatable&&(_.rotate=x),f.scalable&&(_.scaleX=R,_.scaleY=V),this.clone()},"read")},{key:"clone",value:o(function(){var m=this.element,f=this.url,_=m.crossOrigin,v=f;this.options.checkCrossOrigin&&gu(f)&&(_||(_="anonymous"),v=yu(f)),this.crossOrigin=_,this.crossOriginUrl=v;var x=document.createElement("img");_&&(x.crossOrigin=_),x.src=v||f,x.alt=m.alt||"The image to crop",this.image=x,x.onload=this.start.bind(this),x.onerror=this.stop.bind(this),Re(x,B),m.parentNode.insertBefore(x,m.nextSibling)},"clone")},{key:"start",value:o(function(){var m=this,f=this.image;f.onload=null,f.onerror=null,this.sizing=!0;var _=C.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(C.navigator.userAgent),v=o(function(j,I){ve(m.imageData,{naturalWidth:j,naturalHeight:I,aspectRatio:j/I}),m.initialImageData=ve({},m.imageData),m.sizing=!1,m.sized=!0,m.build()},"done");if(f.naturalWidth&&!_){v(f.naturalWidth,f.naturalHeight);return}var x=document.createElement("img"),R=document.body||document.documentElement;this.sizingImage=x,x.onload=function(){v(x.width,x.height),_||R.removeChild(x)},x.src=f.src,_||(x.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",R.appendChild(x))},"start")},{key:"stop",value:o(function(){var m=this.image;m.onload=null,m.onerror=null,m.parentNode.removeChild(m),this.image=null},"stop")},{key:"build",value:o(function(){if(!(!this.sized||this.ready)){var m=this.element,f=this.options,_=this.image,v=m.parentNode,x=document.createElement("div");x.innerHTML=js;var R=x.querySelector(".".concat(A,"-container")),V=R.querySelector(".".concat(A,"-canvas")),j=R.querySelector(".".concat(A,"-drag-box")),I=R.querySelector(".".concat(A,"-crop-box")),N=I.querySelector(".".concat(A,"-face"));this.container=v,this.cropper=R,this.canvas=V,this.dragBox=j,this.cropBox=I,this.viewBox=R.querySelector(".".concat(A,"-view-box")),this.face=N,V.appendChild(_),Re(m,S),v.insertBefore(R,m.nextSibling),dt(_,B),this.initPreview(),this.bind(),f.initialAspectRatio=Math.max(0,f.initialAspectRatio)||NaN,f.aspectRatio=Math.max(0,f.aspectRatio)||NaN,f.viewMode=Math.max(0,Math.min(3,Math.round(f.viewMode)))||0,Re(I,S),f.guides||Re(I.getElementsByClassName("".concat(A,"-dashed")),S),f.center||Re(I.getElementsByClassName("".concat(A,"-center")),S),f.background&&Re(R,"".concat(A,"-bg")),f.highlight||Re(N,q),f.cropBoxMovable&&(Re(N,D),yt(N,E,J)),f.cropBoxResizable||(Re(I.getElementsByClassName("".concat(A,"-line")),S),Re(I.getElementsByClassName("".concat(A,"-point")),S)),this.render(),this.ready=!0,this.setDragMode(f.dragMode),f.autoCrop&&this.crop(),this.setData(f.data),tt(f.ready)&&vt(m,Nt,f.ready,{once:!0}),Hi(m,Nt)}},"build")},{key:"unbuild",value:o(function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var m=this.cropper.parentNode;m&&m.removeChild(this.cropper),dt(this.element,S)}},"unbuild")},{key:"uncreate",value:o(function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()},"uncreate")}],[{key:"noConflict",value:o(function(){return window.Cropper=Og,y},"noConflict")},{key:"setDefaults",value:o(function(m){ve(kr,Kt(m)&&m)},"setDefaults")}])}();return ve(bu.prototype,Eg,Fg,Cg,Tg,Ag,Rg),bu})});var Jf=pe((uD,Yf)=>{"use strict";Yf.exports=o(function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0},"required")});var em=pe(Tl=>{"use strict";var dw=Object.prototype.hasOwnProperty,hw;function Qf(i){try{return decodeURIComponent(i.replace(/\+/g," "))}catch{return null}}o(Qf,"decode");function Zf(i){try{return encodeURIComponent(i)}catch{return null}}o(Zf,"encode");function fw(i){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},r;r=e.exec(i);){var s=Qf(r[1]),n=Qf(r[2]);s===null||n===null||s in t||(t[s]=n)}return t}o(fw,"querystring");function mw(i,e){e=e||"";var t=[],r,s;typeof e!="string"&&(e="?");for(s in i)if(dw.call(i,s)){if(r=i[s],!r&&(r===null||r===hw||isNaN(r))&&(r=""),s=Zf(s),r=Zf(r),s===null||r===null)continue;t.push(s+"="+r)}return t.length?e+t.join("&"):""}o(mw,"querystringify");Tl.stringify=mw;Tl.parse=fw});var lm=pe((hD,am)=>{"use strict";var im=Jf(),Qo=em(),gw=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,rm=/[\n\r\t]/g,yw=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,sm=/:\d+$/,vw=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,bw=/^[a-zA-Z]:/;function Rl(i){return(i||"").toString().replace(gw,"")}o(Rl,"trimLeft");var Al=[["#","hash"],["?","query"],o(function(e,t){return Dt(t.protocol)?e.replace(/\\/g,"/"):e},"sanitize"),["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],tm={hash:1,query:1};function om(i){var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e={};var t=e.location||{};i=i||t;var r={},s=typeof i,n;if(i.protocol==="blob:")r=new It(unescape(i.pathname),{});else if(s==="string"){r=new It(i,{});for(n in tm)delete r[n]}else if(s==="object"){for(n in i)n in tm||(r[n]=i[n]);r.slashes===void 0&&(r.slashes=yw.test(i.href))}return r}o(om,"lolcation");function Dt(i){return i==="file:"||i==="ftp:"||i==="http:"||i==="https:"||i==="ws:"||i==="wss:"}o(Dt,"isSpecial");function nm(i,e){i=Rl(i),i=i.replace(rm,""),e=e||{};var t=vw.exec(i),r=t[1]?t[1].toLowerCase():"",s=!!t[2],n=!!t[3],a=0,u;return s?n?(u=t[2]+t[3]+t[4],a=t[2].length+t[3].length):(u=t[2]+t[4],a=t[2].length):n?(u=t[3]+t[4],a=t[3].length):u=t[4],r==="file:"?a>=2&&(u=u.slice(2)):Dt(r)?u=t[4]:r?s&&(u=u.slice(2)):a>=2&&Dt(e.protocol)&&(u=t[4]),{protocol:r,slashes:s||Dt(r),slashesCount:a,rest:u}}o(nm,"extractProtocol");function ww(i,e){if(i==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(i.split("/")),r=t.length,s=t[r-1],n=!1,a=0;r--;)t[r]==="."?t.splice(r,1):t[r]===".."?(t.splice(r,1),a++):a&&(r===0&&(n=!0),t.splice(r,1),a--);return n&&t.unshift(""),(s==="."||s==="..")&&t.push(""),t.join("/")}o(ww,"resolve");function It(i,e,t){if(i=Rl(i),i=i.replace(rm,""),!(this instanceof It))return new It(i,e,t);var r,s,n,a,u,c,p=Al.slice(),g=typeof e,h=this,b=0;for(g!=="object"&&g!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=Qo.parse),e=om(e),s=nm(i||"",e),r=!s.protocol&&!s.slashes,h.slashes=s.slashes||r&&e.slashes,h.protocol=s.protocol||e.protocol||"",i=s.rest,(s.protocol==="file:"&&(s.slashesCount!==2||bw.test(i))||!s.slashes&&(s.protocol||s.slashesCount<2||!Dt(h.protocol)))&&(p[3]=[/(.*)/,"pathname"]);b<p.length;b++){if(a=p[b],typeof a=="function"){i=a(i,h);continue}n=a[0],c=a[1],n!==n?h[c]=i:typeof n=="string"?(u=n==="@"?i.lastIndexOf(n):i.indexOf(n),~u&&(typeof a[2]=="number"?(h[c]=i.slice(0,u),i=i.slice(u+a[2])):(h[c]=i.slice(u),i=i.slice(0,u)))):(u=n.exec(i))&&(h[c]=u[1],i=i.slice(0,u.index)),h[c]=h[c]||r&&a[3]&&e[c]||"",a[4]&&(h[c]=h[c].toLowerCase())}t&&(h.query=t(h.query)),r&&e.slashes&&h.pathname.charAt(0)!=="/"&&(h.pathname!==""||e.pathname!=="")&&(h.pathname=ww(h.pathname,e.pathname)),h.pathname.charAt(0)!=="/"&&Dt(h.protocol)&&(h.pathname="/"+h.pathname),im(h.port,h.protocol)||(h.host=h.hostname,h.port=""),h.username=h.password="",h.auth&&(u=h.auth.indexOf(":"),~u?(h.username=h.auth.slice(0,u),h.username=encodeURIComponent(decodeURIComponent(h.username)),h.password=h.auth.slice(u+1),h.password=encodeURIComponent(decodeURIComponent(h.password))):h.username=encodeURIComponent(decodeURIComponent(h.auth)),h.auth=h.password?h.username+":"+h.password:h.username),h.origin=h.protocol!=="file:"&&Dt(h.protocol)&&h.host?h.protocol+"//"+h.host:"null",h.href=h.toString()}o(It,"Url");function Sw(i,e,t){var r=this;switch(i){case"query":typeof e=="string"&&e.length&&(e=(t||Qo.parse)(e)),r[i]=e;break;case"port":r[i]=e,im(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[i]="");break;case"hostname":r[i]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[i]=e,sm.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!t;break;case"pathname":case"hash":if(e){var s=i==="pathname"?"/":"#";r[i]=e.charAt(0)!==s?s+e:e}else r[i]=e;break;case"username":case"password":r[i]=encodeURIComponent(e);break;case"auth":var n=e.indexOf(":");~n?(r.username=e.slice(0,n),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(n+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var a=0;a<Al.length;a++){var u=Al[a];u[4]&&(r[u[1]]=r[u[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin=r.protocol!=="file:"&&Dt(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}o(Sw,"set");function xw(i){(!i||typeof i!="function")&&(i=Qo.stringify);var e,t=this,r=t.host,s=t.protocol;s&&s.charAt(s.length-1)!==":"&&(s+=":");var n=s+(t.protocol&&t.slashes||Dt(t.protocol)?"//":"");return t.username?(n+=t.username,t.password&&(n+=":"+t.password),n+="@"):t.password?(n+=":"+t.password,n+="@"):t.protocol!=="file:"&&Dt(t.protocol)&&!r&&t.pathname!=="/"&&(n+="@"),(r[r.length-1]===":"||sm.test(t.hostname)&&!t.port)&&(r+=":"),n+=r+t.pathname,e=typeof t.query=="object"?i(t.query):t.query,e&&(n+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(n+=t.hash),n}o(xw,"toString");It.prototype={set:Sw,toString:xw};It.extractProtocol=nm;It.location=om;It.trimLeft=Rl;It.qs=Qo;am.exports=It});var Kl=pe((_7,Gl)=>{function Ze(i){if(i)return w2(i);this._callbacks=new Map}o(Ze,"Emitter");function w2(i){return Object.assign(i,Ze.prototype),i._callbacks=new Map,i}o(w2,"mixin");Ze.prototype.on=function(i,e){let t=this._callbacks.get(i)??[];return t.push(e),this._callbacks.set(i,t),this};Ze.prototype.once=function(i,e){let t=o((...r)=>{this.off(i,t),e.apply(this,r)},"on");return t.fn=e,this.on(i,t),this};Ze.prototype.off=function(i,e){if(i===void 0&&e===void 0)return this._callbacks.clear(),this;if(e===void 0)return this._callbacks.delete(i),this;let t=this._callbacks.get(i);if(t){for(let[r,s]of t.entries())if(s===e||s.fn===e){t.splice(r,1);break}t.length===0?this._callbacks.delete(i):this._callbacks.set(i,t)}return this};Ze.prototype.emit=function(i,...e){let t=this._callbacks.get(i);if(t){let r=[...t];for(let s of r)s.apply(this,e)}return this};Ze.prototype.listeners=function(i){return this._callbacks.get(i)??[]};Ze.prototype.listenerCount=function(i){if(i)return this.listeners(i).length;let e=0;for(let t of this._callbacks.values())e+=t.length;return e};Ze.prototype.hasListeners=function(i){return this.listenerCount(i)>0};Ze.prototype.addEventListener=Ze.prototype.on;Ze.prototype.removeListener=Ze.prototype.off;Ze.prototype.removeEventListener=Ze.prototype.off;Ze.prototype.removeAllListeners=Ze.prototype.off;typeof Gl<"u"&&(Gl.exports=Ze)});var tg=pe((Y7,an)=>{"use strict";an.exports=iu;an.exports.isMobile=iu;an.exports.default=iu;var k2=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,E2=/CrOS/,F2=/android|ipad|playbook|silk/i;function iu(i){i||(i={});let e=i.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;let t=k2.test(e)&&!E2.test(e)||!!i.tablet&&F2.test(e);return!t&&i.tablet&&i.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(t=!0),t}o(iu,"isMobile")});var hu={};Gs(hu,{Audio:()=>Yi,AwsS3:()=>is,BasePlugin:()=>we,Box:()=>ei,Compressor:()=>rs,Core:()=>M2,Dashboard:()=>nr,DefaultStore:()=>to,DragDrop:()=>ar,DropTarget:()=>xs,Dropbox:()=>si,Facebook:()=>oi,FileInput:()=>lr,Form:()=>_s,GoldenRetriever:()=>Ps,GoogleDrive:()=>ai,GoogleDrivePicker:()=>ur,GooglePhotosPicker:()=>cr,ImageEditor:()=>pr,Informer:()=>ti,Instagram:()=>li,OneDrive:()=>ui,ProgressBar:()=>dr,ReduxDevTools:()=>Fs,ReduxStore:()=>Ff,RemoteSources:()=>Cs,ScreenCapture:()=>hr,StatusBar:()=>ii,ThumbnailGenerator:()=>Oi,Transloadit:()=>fi,Tus:()=>hi,UIPlugin:()=>Z,Unsplash:()=>ci,Uppy:()=>no,Url:()=>Vt,Webcam:()=>xr,XHRUpload:()=>Bs,Zoom:()=>pi,debugLogger:()=>Ar,locales:()=>B2,server:()=>Wn,views:()=>L2});function zg(i,e,t){let r=[];return i.forEach(s=>typeof s!="string"?r.push(s):e[Symbol.split](s).forEach((n,a,u)=>{n!==""&&r.push(n),a<u.length-1&&r.push(t)})),r}o(zg,"insertReplacement");function Pu(i,e){let t=/\$/g,r="$$$$",s=[i];if(e==null)return s;for(let n of Object.keys(e))if(n!=="_"){let a=e[n];typeof a=="string"&&(a=t[Symbol.replace](a,r)),s=zg(s,new RegExp(`%\\{${n}\\}`,"g"),a)}return s}o(Pu,"interpolate");var Hg=o(i=>{throw new Error(`missing string: ${i}`)},"defaultOnMissingKey"),Si=class{static{o(this,"Translator")}locale;constructor(e,{onMissingKey:t=Hg}={}){this.locale={strings:{},pluralize(r){return r===1?0:1}},Array.isArray(e)?e.forEach(this.#t,this):this.#t(e),this.#e=t}#e;#t(e){if(!e?.strings)return;let t=this.locale;Object.assign(this.locale,{strings:{...t.strings,...e.strings},pluralize:e.pluralize||t.pluralize})}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let r=this.locale.strings[e];if(r==null&&(this.#e(e),r=e),typeof r=="object"){if(t&&typeof t.smart_count<"u"){let n=this.locale.pluralize(t.smart_count);return Pu(r[n],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof r!="string")throw new Error("string was not a string");return Pu(r,t)}};var we=class{static{o(this,"BasePlugin")}uppy;opts;id;defaultLocale;i18n;i18nArray;type;VERSION;constructor(e,t){this.uppy=e,this.opts=t??{}}getPluginState(){let{plugins:e}=this.uppy.getState();return e?.[this.id]||{}}setPluginState(e){let{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){let e=new Si([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}};function mn(i){return i<10?`0${i}`:i.toString()}o(mn,"pad");function qi(){let i=new Date,e=mn(i.getHours()),t=mn(i.getMinutes()),r=mn(i.getSeconds());return`${e}:${t}:${r}`}o(qi,"getTimeStamp");var ku={debug:o(()=>{},"debug"),warn:o(()=>{},"warn"),error:o((...i)=>console.error(`[Uppy] [${qi()}]`,...i),"error")},Ar={debug:o((...i)=>console.debug(`[Uppy] [${qi()}]`,...i),"debug"),warn:o((...i)=>console.warn(`[Uppy] [${qi()}]`,...i),"warn"),error:o((...i)=>console.error(`[Uppy] [${qi()}]`,...i),"error")};function Rr(i){return typeof i!="object"||i===null||!("nodeType"in i)?!1:i.nodeType===Node.ELEMENT_NODE}o(Rr,"isDOMElement");function qg(i,e=document){return typeof i=="string"?e.querySelector(i):Rr(i)?i:null}o(qg,"findDOMElement");var Ks=qg;function Vg(i){for(;i&&!i.dir;)i=i.parentNode;return i?.dir}o(Vg,"getTextDirection");var Xs=Vg;var Dr,ie,Au,$g,xi,Eu,Ru,Ou,Uu,vn,gn,yn,Wg,Ur={},Du=[],Gg=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ir=Array.isArray;function At(i,e){for(var t in e)i[t]=e[t];return i}o(At,"d");function bn(i){i&&i.parentNode&&i.parentNode.removeChild(i)}o(bn,"g");function jt(i,e,t){var r,s,n,a={};for(n in e)n=="key"?r=e[n]:n=="ref"?s=e[n]:a[n]=e[n];if(arguments.length>2&&(a.children=arguments.length>3?Dr.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(n in i.defaultProps)a[n]===void 0&&(a[n]=i.defaultProps[n]);return Or(i,a,r,s,null)}o(jt,"_");function Or(i,e,t,r,s){var n={type:i,props:e,key:t,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Au,__i:-1,__u:0};return s==null&&ie.vnode!=null&&ie.vnode(n),n}o(Or,"m");function Qs(){return{current:null}}o(Qs,"b");function _e(i){return i.children}o(_e,"k");function ge(i,e){this.props=i,this.context=e}o(ge,"x");function Vi(i,e){if(e==null)return i.__?Vi(i.__,i.__i+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?Vi(i):null}o(Vi,"S");function Iu(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return Iu(i)}}o(Iu,"C");function Fu(i){(!i.__d&&(i.__d=!0)&&xi.push(i)&&!Js.__r++||Eu!=ie.debounceRendering)&&((Eu=ie.debounceRendering)||Ru)(Js)}o(Fu,"M");function Js(){for(var i,e,t,r,s,n,a,u=1;xi.length;)xi.length>u&&xi.sort(Ou),i=xi.shift(),u=xi.length,i.__d&&(t=void 0,s=(r=(e=i).__v).__e,n=[],a=[],e.__P&&((t=At({},r)).__v=r.__v+1,ie.vnode&&ie.vnode(t),wn(e.__P,t,r,e.__n,e.__P.namespaceURI,32&r.__u?[s]:null,n,s??Vi(r),!!(32&r.__u),a),t.__v=r.__v,t.__.__k[t.__i]=t,Lu(n,t,a),t.__e!=s&&Iu(t)));Js.__r=0}o(Js,"$");function Nu(i,e,t,r,s,n,a,u,c,p,g){var h,b,P,F,M,C,O=r&&r.__k||Du,U=e.length;for(c=Kg(t,e,O,c,U),h=0;h<U;h++)(P=t.__k[h])!=null&&(b=P.__i==-1?Ur:O[P.__i]||Ur,P.__i=h,C=wn(i,P,b,s,n,a,u,c,p,g),F=P.__e,P.ref&&b.ref!=P.ref&&(b.ref&&Sn(b.ref,null,P),g.push(P.ref,P.__c||F,P)),M==null&&F!=null&&(M=F),4&P.__u||b.__k===P.__k?c=Mu(P,c,i):typeof P.type=="function"&&C!==void 0?c=C:F&&(c=F.nextSibling),P.__u&=-7);return t.__e=M,c}o(Nu,"I");function Kg(i,e,t,r,s){var n,a,u,c,p,g=t.length,h=g,b=0;for(i.__k=new Array(s),n=0;n<s;n++)(a=e[n])!=null&&typeof a!="boolean"&&typeof a!="function"?(c=n+b,(a=i.__k[n]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?Or(null,a,null,null,null):Ir(a)?Or(_e,{children:a},null,null,null):a.constructor==null&&a.__b>0?Or(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=i,a.__b=i.__b+1,u=null,(p=a.__i=Xg(a,t,c,h))!=-1&&(h--,(u=t[p])&&(u.__u|=2)),u==null||u.__v==null?(p==-1&&(s>g?b--:s<g&&b++),typeof a.type!="function"&&(a.__u|=4)):p!=c&&(p==c-1?b--:p==c+1?b++:(p>c?b--:b++,a.__u|=4))):i.__k[n]=null;if(h)for(n=0;n<g;n++)(u=t[n])!=null&&(2&u.__u)==0&&(u.__e==r&&(r=Vi(u)),ju(u,u));return r}o(Kg,"P");function Mu(i,e,t){var r,s;if(typeof i.type=="function"){for(r=i.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=i,e=Mu(r[s],e,t));return e}i.__e!=e&&(e&&i.type&&!t.contains(e)&&(e=Vi(i)),t.insertBefore(i.__e,e||null),e=i.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}o(Mu,"A");function ut(i,e){return e=e||[],i==null||typeof i=="boolean"||(Ir(i)?i.some(function(t){ut(t,e)}):e.push(i)),e}o(ut,"H");function Xg(i,e,t,r){var s,n,a=i.key,u=i.type,c=e[t];if(c===null&&i.key==null||c&&a==c.key&&u==c.type&&(2&c.__u)==0)return t;if(r>(c!=null&&(2&c.__u)==0?1:0))for(s=t-1,n=t+1;s>=0||n<e.length;){if(s>=0){if((c=e[s])&&(2&c.__u)==0&&a==c.key&&u==c.type)return s;s--}if(n<e.length){if((c=e[n])&&(2&c.__u)==0&&a==c.key&&u==c.type)return n;n++}}return-1}o(Xg,"L");function Cu(i,e,t){e[0]=="-"?i.setProperty(e,t??""):i[e]=t==null?"":typeof t!="number"||Gg.test(e)?t:t+"px"}o(Cu,"T");function Ys(i,e,t,r,s){var n,a;e:if(e=="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof r=="string"&&(i.style.cssText=r=""),r)for(e in r)t&&e in t||Cu(i.style,e,"");if(t)for(e in t)r&&t[e]==r[e]||Cu(i.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")n=e!=(e=e.replace(Uu,"$1")),a=e.toLowerCase(),e=a in i||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),i.l||(i.l={}),i.l[e+n]=t,t?r?t.u=r.u:(t.u=vn,i.addEventListener(e,n?yn:gn,n)):i.removeEventListener(e,n?yn:gn,n);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in i)try{i[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?i.removeAttribute(e):i.setAttribute(e,e=="popover"&&t==1?"":t))}}o(Ys,"j");function Tu(i){return function(e){if(this.l){var t=this.l[e.type+i];if(e.t==null)e.t=vn++;else if(e.t<t.u)return;return t(ie.event?ie.event(e):e)}}}o(Tu,"F");function wn(i,e,t,r,s,n,a,u,c,p){var g,h,b,P,F,M,C,O,U,A,J,G,W,K,te,Q,be,ne=e.type;if(e.constructor!=null)return null;128&t.__u&&(c=!!(32&t.__u),n=[u=e.__e=t.__e]),(g=ie.__b)&&g(e);e:if(typeof ne=="function")try{if(O=e.props,U="prototype"in ne&&ne.prototype.render,A=(g=ne.contextType)&&r[g.__c],J=g?A?A.props.value:g.__:r,t.__c?C=(h=e.__c=t.__c).__=h.__E:(U?e.__c=h=new ne(O,J):(e.__c=h=new ge(O,J),h.constructor=ne,h.render=Jg),A&&A.sub(h),h.props=O,h.state||(h.state={}),h.context=J,h.__n=r,b=h.__d=!0,h.__h=[],h._sb=[]),U&&h.__s==null&&(h.__s=h.state),U&&ne.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=At({},h.__s)),At(h.__s,ne.getDerivedStateFromProps(O,h.__s))),P=h.props,F=h.state,h.__v=e,b)U&&ne.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),U&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(U&&ne.getDerivedStateFromProps==null&&O!==P&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(O,J),!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(O,h.__s,J)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(h.props=O,h.state=h.__s,h.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(Pe){Pe&&(Pe.__=e)}),G=0;G<h._sb.length;G++)h.__h.push(h._sb[G]);h._sb=[],h.__h.length&&a.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(O,h.__s,J),U&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(P,F,M)})}if(h.context=J,h.props=O,h.__P=i,h.__e=!1,W=ie.__r,K=0,U){for(h.state=h.__s,h.__d=!1,W&&W(e),g=h.render(h.props,h.state,h.context),te=0;te<h._sb.length;te++)h.__h.push(h._sb[te]);h._sb=[]}else do h.__d=!1,W&&W(e),g=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++K<25);h.state=h.__s,h.getChildContext!=null&&(r=At(At({},r),h.getChildContext())),U&&!b&&h.getSnapshotBeforeUpdate!=null&&(M=h.getSnapshotBeforeUpdate(P,F)),Q=g,g!=null&&g.type===_e&&g.key==null&&(Q=Bu(g.props.children)),u=Nu(i,Ir(Q)?Q:[Q],e,t,r,s,n,a,u,c,p),h.base=e.__e,e.__u&=-161,h.__h.length&&a.push(h),C&&(h.__E=h.__=null)}catch(Pe){if(e.__v=null,c||n!=null)if(Pe.then){for(e.__u|=c?160:128;u&&u.nodeType==8&&u.nextSibling;)u=u.nextSibling;n[n.indexOf(u)]=null,e.__e=u}else for(be=n.length;be--;)bn(n[be]);else e.__e=t.__e,e.__k=t.__k;ie.__e(Pe,e,t)}else n==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):u=e.__e=Yg(t.__e,e,t,r,s,n,a,c,p);return(g=ie.diffed)&&g(e),128&e.__u?void 0:u}o(wn,"O");function Lu(i,e,t){for(var r=0;r<t.length;r++)Sn(t[r],t[++r],t[++r]);ie.__c&&ie.__c(e,i),i.some(function(s){try{i=s.__h,s.__h=[],i.some(function(n){n.call(s)})}catch(n){ie.__e(n,s.__v)}})}o(Lu,"z");function Bu(i){return typeof i!="object"||i==null||i.__b&&i.__b>0?i:Ir(i)?i.map(Bu):At({},i)}o(Bu,"N");function Yg(i,e,t,r,s,n,a,u,c){var p,g,h,b,P,F,M,C=t.props,O=e.props,U=e.type;if(U=="svg"?s="http://www.w3.org/2000/svg":U=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),n!=null){for(p=0;p<n.length;p++)if((P=n[p])&&"setAttribute"in P==!!U&&(U?P.localName==U:P.nodeType==3)){i=P,n[p]=null;break}}if(i==null){if(U==null)return document.createTextNode(O);i=document.createElementNS(s,U,O.is&&O),u&&(ie.__m&&ie.__m(e,n),u=!1),n=null}if(U==null)C===O||u&&i.data==O||(i.data=O);else{if(n=n&&Dr.call(i.childNodes),C=t.props||Ur,!u&&n!=null)for(C={},p=0;p<i.attributes.length;p++)C[(P=i.attributes[p]).name]=P.value;for(p in C)if(P=C[p],p!="children"){if(p=="dangerouslySetInnerHTML")h=P;else if(!(p in O)){if(p=="value"&&"defaultValue"in O||p=="checked"&&"defaultChecked"in O)continue;Ys(i,p,null,P,s)}}for(p in O)P=O[p],p=="children"?b=P:p=="dangerouslySetInnerHTML"?g=P:p=="value"?F=P:p=="checked"?M=P:u&&typeof P!="function"||C[p]===P||Ys(i,p,P,C[p],s);if(g)u||h&&(g.__html==h.__html||g.__html==i.innerHTML)||(i.innerHTML=g.__html),e.__k=[];else if(h&&(i.innerHTML=""),Nu(e.type=="template"?i.content:i,Ir(b)?b:[b],e,t,r,U=="foreignObject"?"http://www.w3.org/1999/xhtml":s,n,a,n?n[0]:t.__k&&Vi(t,0),u,c),n!=null)for(p=n.length;p--;)bn(n[p]);u||(p="value",U=="progress"&&F==null?i.removeAttribute("value"):F!=null&&(F!==i[p]||U=="progress"&&!F||U=="option"&&F!=C[p])&&Ys(i,p,F,C[p],s),p="checked",M!=null&&M!=i[p]&&Ys(i,p,M,C[p],s))}return i}o(Yg,"V");function Sn(i,e,t){try{if(typeof i=="function"){var r=typeof i.__u=="function";r&&i.__u(),r&&e==null||(i.__u=i(e))}else i.current=e}catch(s){ie.__e(s,t)}}o(Sn,"q");function ju(i,e,t){var r,s;if(ie.unmount&&ie.unmount(i),(r=i.ref)&&(r.current&&r.current!=i.__e||Sn(r,null,e)),(r=i.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(n){ie.__e(n,e)}r.base=r.__P=null}if(r=i.__k)for(s=0;s<r.length;s++)r[s]&&ju(r[s],e,t||typeof i.type!="function");t||bn(i.__e),i.__c=i.__=i.__e=void 0}o(ju,"B");function Jg(i,e,t){return this.constructor(i,t)}o(Jg,"D");function zu(i,e,t){var r,s,n,a;e==document&&(e=document.documentElement),ie.__&&ie.__(i,e),s=(r=typeof t=="function")?null:t&&t.__k||e.__k,n=[],a=[],wn(e,i=(!r&&t||e).__k=jt(_e,null,[i]),s||Ur,Ur,e.namespaceURI,!r&&t?[t]:s?null:e.firstChild?Dr.call(e.childNodes):null,n,!r&&t?t:s?s.__e:e.firstChild,r,a),Lu(n,i,a)}o(zu,"E");function Nr(i,e,t){var r,s,n,a,u=At({},i.props);for(n in i.type&&i.type.defaultProps&&(a=i.type.defaultProps),e)n=="key"?r=e[n]:n=="ref"?s=e[n]:u[n]=e[n]===void 0&&a!=null?a[n]:e[n];return arguments.length>2&&(u.children=arguments.length>3?Dr.call(arguments,2):t),Or(i.type,u,r||i.key,s||i.ref,null)}o(Nr,"J");Dr=Du.slice,ie={__e:o(function(i,e,t,r){for(var s,n,a;e=e.__;)if((s=e.__c)&&!s.__)try{if((n=s.constructor)&&n.getDerivedStateFromError!=null&&(s.setState(n.getDerivedStateFromError(i)),a=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,r||{}),a=s.__d),a)return s.__E=s}catch(u){i=u}throw i},"__e")},Au=0,$g=o(function(i){return i!=null&&i.constructor==null},"t"),ge.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=At({},this.state),typeof i=="function"&&(i=i(At({},t),this.props)),i&&At(t,i),i!=null&&this.__v&&(e&&this._sb.push(e),Fu(this))},ge.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Fu(this))},ge.prototype.render=_e,xi=[],Ru=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ou=o(function(i,e){return i.__v.__b-e.__v.__b},"e"),Js.__r=0,Uu=/(PointerCapture)$|Capture$/i,vn=0,gn=Tu(!1),yn=Tu(!0),Wg=0;var Mr,Oe,xn,Hu,Lr=0,Yu=[],Ie=ie,qu=Ie.__b,Vu=Ie.__r,$u=Ie.diffed,Wu=Ie.__c,Gu=Ie.unmount,Ku=Ie.__;function Pn(i,e){Ie.__h&&Ie.__h(Oe,i,Lr||e),Lr=0;var t=Oe.__H||(Oe.__H={__:[],__h:[]});return i>=t.__.length&&t.__.push({}),t.__[i]}o(Pn,"p");function Xe(i){return Lr=1,Ju(Zu,i)}o(Xe,"d");function Ju(i,e,t){var r=Pn(Mr++,2);if(r.t=i,!r.__c&&(r.__=[t?t(e):Zu(void 0,e),function(u){var c=r.__N?r.__N[0]:r.__[0],p=r.t(c,u);c!==p&&(r.__N=[p,r.__[1]],r.__c.setState({}))}],r.__c=Oe,!Oe.__f)){var s=o(function(u,c,p){if(!r.__c.__H)return!0;var g=r.__c.__H.__.filter(function(b){return!!b.__c});if(g.every(function(b){return!b.__N}))return!n||n.call(this,u,c,p);var h=r.__c.props!==u;return g.forEach(function(b){if(b.__N){var P=b.__[0];b.__=b.__N,b.__N=void 0,P!==b.__[0]&&(h=!0)}}),n&&n.call(this,u,c,p)||h},"f");Oe.__f=!0;var n=Oe.shouldComponentUpdate,a=Oe.componentWillUpdate;Oe.componentWillUpdate=function(u,c,p){if(this.__e){var g=n;n=void 0,s(u,c,p),n=g}a&&a.call(this,u,c,p)},Oe.shouldComponentUpdate=s}return r.__N||r.__}o(Ju,"h");function Ne(i,e){var t=Pn(Mr++,3);!Ie.__s&&Qu(t.__H,e)&&(t.__=i,t.u=e,Oe.__H.__h.push(t))}o(Ne,"y");function it(i){return Lr=5,Qt(function(){return{current:i}},[])}o(it,"A");function Qt(i,e){var t=Pn(Mr++,7);return Qu(t.__H,e)&&(t.__=i(),t.__H=e,t.__h=i),t.__}o(Qt,"T");function Ye(i,e){return Lr=8,Qt(function(){return i},e)}o(Ye,"q");function Qg(){for(var i;i=Yu.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(Zs),i.__H.__h.forEach(_n),i.__H.__h=[]}catch(e){i.__H.__h=[],Ie.__e(e,i.__v)}}o(Qg,"j");Ie.__b=function(i){Oe=null,qu&&qu(i)},Ie.__=function(i,e){i&&e.__k&&e.__k.__m&&(i.__m=e.__k.__m),Ku&&Ku(i,e)},Ie.__r=function(i){Vu&&Vu(i),Mr=0;var e=(Oe=i.__c).__H;e&&(xn===Oe?(e.__h=[],Oe.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(Zs),e.__h.forEach(_n),e.__h=[],Mr=0)),xn=Oe},Ie.diffed=function(i){$u&&$u(i);var e=i.__c;e&&e.__H&&(e.__H.__h.length&&(Yu.push(e)!==1&&Hu===Ie.requestAnimationFrame||((Hu=Ie.requestAnimationFrame)||Zg)(Qg)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),xn=Oe=null},Ie.__c=function(i,e){e.some(function(t){try{t.__h.forEach(Zs),t.__h=t.__h.filter(function(r){return!r.__||_n(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],Ie.__e(r,t.__v)}}),Wu&&Wu(i,e)},Ie.unmount=function(i){Gu&&Gu(i);var e,t=i.__c;t&&t.__H&&(t.__H.__.forEach(function(r){try{Zs(r)}catch(s){e=s}}),t.__H=void 0,e&&Ie.__e(e,t.__v))};var Xu=typeof requestAnimationFrame=="function";function Zg(i){var e,t=o(function(){clearTimeout(r),Xu&&cancelAnimationFrame(e),setTimeout(i)},"r"),r=setTimeout(t,35);Xu&&(e=requestAnimationFrame(t))}o(Zg,"w");function Zs(i){var e=Oe,t=i.__c;typeof t=="function"&&(i.__c=void 0,t()),Oe=e}o(Zs,"z");function _n(i){var e=Oe;i.__c=i.__(),Oe=e}o(_n,"B");function Qu(i,e){return!i||i.length!==e.length||e.some(function(t,r){return t!==i[r]})}o(Qu,"C");function Zu(i,e){return typeof e=="function"?e(i):e}o(Zu,"D");function ty(i,e){for(var t in e)i[t]=e[t];return i}o(ty,"g");function ec(i,e){for(var t in i)if(t!=="__source"&&!(t in e))return!0;for(var r in e)if(r!=="__source"&&i[r]!==e[r])return!0;return!1}o(ec,"E");function tc(i,e){this.props=i,this.context=e}o(tc,"N");(tc.prototype=new ge).isPureReactComponent=!0,tc.prototype.shouldComponentUpdate=function(i,e){return ec(this.props,i)||ec(this.state,e)};var ic=ie.__b;ie.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),ic&&ic(i)};var yS=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;var iy=ie.__e;ie.__e=function(i,e,t,r){if(i.then){for(var s,n=e;n=n.__;)if((s=n.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(i,e)}iy(i,e,t,r)};var rc=ie.unmount;function uc(i,e,t){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),i.__c.__H=null),(i=ty({},i)).__c!=null&&(i.__c.__P===t&&(i.__c.__P=e),i.__c.__e=!0,i.__c=null),i.__k=i.__k&&i.__k.map(function(r){return uc(r,e,t)})),i}o(uc,"V");function cc(i,e,t){return i&&t&&(i.__v=null,i.__k=i.__k&&i.__k.map(function(r){return cc(r,e,t)}),i.__c&&i.__c.__P===e&&(i.__e&&t.appendChild(i.__e),i.__c.__e=!0,i.__c.__P=t)),i}o(cc,"W");function kn(){this.__u=0,this.o=null,this.__b=null}o(kn,"P");function pc(i){var e=i.__.__c;return e&&e.__a&&e.__a(i)}o(pc,"j");function eo(){this.i=null,this.l=null}o(eo,"B");ie.unmount=function(i){var e=i.__c;e&&e.__R&&e.__R(),e&&32&i.__u&&(i.type=null),rc&&rc(i)},(kn.prototype=new ge).__c=function(i,e){var t=e.__c,r=this;r.o==null&&(r.o=[]),r.o.push(t);var s=pc(r.__v),n=!1,a=o(function(){n||(n=!0,t.__R=null,s?s(u):u())},"i");t.__R=a;var u=o(function(){if(!--r.__u){if(r.state.__a){var c=r.state.__a;r.__v.__k[0]=cc(c,c.__c.__P,c.__c.__O)}var p;for(r.setState({__a:r.__b=null});p=r.o.pop();)p.forceUpdate()}},"l");r.__u++||32&e.__u||r.setState({__a:r.__b=r.__v.__k[0]}),i.then(a,a)},kn.prototype.componentWillUnmount=function(){this.o=[]},kn.prototype.render=function(i,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=uc(this.__b,t,r.__O=r.__P)}this.__b=null}var s=e.__a&&jt(_e,null,i.fallback);return s&&(s.__u&=-33),[jt(_e,null,e.__a?null:i.children),s]};var sc=o(function(i,e,t){if(++t[1]===t[0]&&i.l.delete(e),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.l.size))for(t=i.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;i.i=t=t[2]}},"H");(eo.prototype=new ge).__a=function(i){var e=this,t=pc(e.__v),r=e.l.get(i);return r[0]++,function(s){var n=o(function(){e.props.revealOrder?(r.push(s),sc(e,i,r)):s()},"o");t?t(n):n()}},eo.prototype.render=function(i){this.i=null,this.l=new Map;var e=ut(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return i.children},eo.prototype.componentDidUpdate=eo.prototype.componentDidMount=function(){var i=this;this.l.forEach(function(e,t){sc(i,t,e)})};var ry=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,sy=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,oy=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ny=/[A-Z0-9]/g,ay=typeof document<"u",ly=o(function(i){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(i)},"X");function En(i,e,t){return e.__k==null&&(e.textContent=""),zu(i,e),typeof t=="function"&&t(),i?i.__c:null}o(En,"nn");ge.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty(ge.prototype,i,{configurable:!0,get:o(function(){return this["UNSAFE_"+i]},"get"),set:o(function(e){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:e})},"set")})});var oc=ie.event;function uy(){}o(uy,"rn");function cy(){return this.cancelBubble}o(cy,"un");function py(){return this.defaultPrevented}o(py,"on");ie.event=function(i){return oc&&(i=oc(i)),i.persist=uy,i.isPropagationStopped=cy,i.isDefaultPrevented=py,i.nativeEvent=i};var dc,dy={enumerable:!1,configurable:!0,get:o(function(){return this.class},"get")},nc=ie.vnode;ie.vnode=function(i){typeof i.type=="string"&&function(e){var t=e.props,r=e.type,s={},n=r.indexOf("-")===-1;for(var a in t){var u=t[a];if(!(a==="value"&&"defaultValue"in t&&u==null||ay&&a==="children"&&r==="noscript"||a==="class"||a==="className")){var c=a.toLowerCase();a==="defaultValue"&&"value"in t&&t.value==null?a="value":a==="download"&&u===!0?u="":c==="translate"&&u==="no"?u=!1:c[0]==="o"&&c[1]==="n"?c==="ondoubleclick"?a="ondblclick":c!=="onchange"||r!=="input"&&r!=="textarea"||ly(t.type)?c==="onfocus"?a="onfocusin":c==="onblur"?a="onfocusout":oy.test(a)&&(a=c):c=a="oninput":n&&sy.test(a)?a=a.replace(ny,"-$&").toLowerCase():u===null&&(u=void 0),c==="oninput"&&s[a=c]&&(a="oninputCapture"),s[a]=u}}r=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=ut(t.children).forEach(function(p){p.props.selected=s.value.indexOf(p.props.value)!=-1})),r=="select"&&s.defaultValue!=null&&(s.value=ut(t.children).forEach(function(p){p.props.selected=s.multiple?s.defaultValue.indexOf(p.props.value)!=-1:s.defaultValue==p.props.value})),t.class&&!t.className?(s.class=t.class,Object.defineProperty(s,"className",dy)):(t.className&&!t.class||t.class&&t.className)&&(s.class=s.className=t.className),e.props=s}(i),i.$$typeof=ry,nc&&nc(i)};var ac=ie.__r;ie.__r=function(i){ac&&ac(i),dc=i.__c};var lc=ie.diffed;ie.diffed=function(i){lc&&lc(i);var e=i.props,t=i.__e;t!=null&&i.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value),dc=null};function hy(i){let e=null,t;return(...r)=>(t=r,e||(e=Promise.resolve().then(()=>(e=null,i(...t)))),e)}o(hy,"debounce");var Fn=class i extends we{static{o(this,"UIPlugin")}#e;isTargetDOMEl;el;parent;title;getTargetPlugin(e){let t;if(typeof e?.addTarget=="function")t=e,t instanceof i||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:t,UIPlugin:i}}));else if(typeof e=="function"){let r=e;this.uppy.iteratePlugins(s=>{s instanceof r&&(t=s)})}return t}mount(e,t){let r=t.id,s=Ks(e);if(s){this.isTargetDOMEl=!0;let u=document.createElement("div");return u.classList.add("uppy-Root"),this.#e=hy(c=>{this.uppy.getPlugin(this.id)&&(En(this.render(c,u),u),this.afterUpdate())}),this.uppy.log(`Installing ${r} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(s.innerHTML=""),En(this.render(this.uppy.getState(),u),u),this.el=u,s.appendChild(u),u.dir=this.opts.direction||Xs(u)||"ltr",this.onMount(),this.el}let n=this.getTargetPlugin(e);if(n)return this.uppy.log(`Installing ${r} to ${n.id}`),this.parent=n,this.el=n.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${r}`);let a=`Invalid target option given to ${r}.`;throw typeof e=="function"?a+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":a+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(a)}render(e,t){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){this.el!=null&&this.#e?.(e)}unmount(){this.isTargetDOMEl&&this.el?.remove(),this.onUnmount()}onMount(){}onUnmount(){}},Z=Fn;var hc={name:"@uppy/store-default",description:"The default simple object-based store for Uppy.",version:"4.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-store"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},devDependencies:{jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"]};var Cn=class{static{o(this,"DefaultStore")}static VERSION=hc.version;state={};#e=new Set;getState(){return this.state}setState(e){let t={...this.state},r={...this.state,...e};this.state=r,this.#t(t,r,e)}subscribe(e){return this.#e.add(e),()=>{this.#e.delete(e)}}#t(...e){this.#e.forEach(t=>{t(...e)})}},to=Cn;function Rt(i){let e=i.lastIndexOf(".");return e===-1||e===i.length-1?{name:i,extension:void 0}:{name:i.slice(0,e),extension:i.slice(e+1)}}o(Rt,"getFileNameAndExtension");var Br={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function jr(i){if(i.type)return i.type;let e=i.name?Rt(i.name).extension?.toLowerCase():null;return e&&e in Br?Br[e]:"application/octet-stream"}o(jr,"getFileType");function my(i){return i.charCodeAt(0).toString(32)}o(my,"encodeCharacter");function fc(i){let e="";return i.replace(/[^A-Z0-9]/gi,t=>(e+=`-${my(t)}`,"/"))+e}o(fc,"encodeFilename");function mc(i,e){let t=e||"uppy";return typeof i.name=="string"&&(t+=`-${fc(i.name.toLowerCase())}`),i.type!==void 0&&(t+=`-${i.type}`),i.meta&&typeof i.meta.relativePath=="string"&&(t+=`-${fc(i.meta.relativePath.toLowerCase())}`),i.data.size!==void 0&&(t+=`-${i.data.size}`),i.data.lastModified!==void 0&&(t+=`-${i.data.lastModified}`),t}o(mc,"generateFileID");function gy(i){return!i.isRemote||!i.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(i.remote.provider)}o(gy,"hasFileStableId");function io(i,e){if(gy(i))return i.id;let t=jr(i);return mc({...i,type:t},e)}o(io,"getSafeFileId");var np=de(Un(),1),ap=de(Xc(),1);var uv="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var wt=o((i=21)=>{let e="",t=i|0;for(;t--;)e+=uv[Math.random()*64|0];return e},"nanoid");var Yc={name:"@uppy/core",description:"Core module for the extensible JavaScript file upload widget with support for drag&drop, resumable uploads, previews, restrictions, file processing/encoding, remote providers like Instagram, Dropbox, Google Drive, S3 and more :dog:",version:"4.5.3",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",sideEffects:["*.css"],scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/store-default":"workspace:^","@uppy/utils":"workspace:^",lodash:"^4.17.21","mime-match":"^1.0.2","namespace-emitter":"^2.0.1",nanoid:"^5.0.9",preact:"^10.5.13"},devDependencies:{"@types/deep-freeze":"^0",cssnano:"^7.0.7","deep-freeze":"^0.0.1",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"}};function Dn(i,e){return e.name?e.name:i.split("/")[0]==="image"?`${i.split("/")[0]}.${i.split("/")[1]}`:"noname"}o(Dn,"getFileName");var Jc={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};var qr=de(Hr(),1),sp=de(rp(),1);var op={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]},ct=class extends Error{static{o(this,"RestrictionError")}isUserFacing;file;constructor(e,t){super(e),this.isUserFacing=t?.isUserFacing??!0,t?.file&&(this.file=t.file)}isRestriction=!0},so=class{static{o(this,"Restricter")}getI18n;getOpts;constructor(e,t){this.getI18n=t,this.getOpts=()=>{let r=e();if(r.restrictions?.allowedFileTypes!=null&&!Array.isArray(r.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return r}}validateAggregateRestrictions(e,t){let{maxTotalFileSize:r,maxNumberOfFiles:s}=this.getOpts().restrictions;if(s&&e.filter(a=>!a.isGhost).length+t.length>s)throw new ct(`${this.getI18n()("youCanOnlyUploadX",{smart_count:s})}`);if(r){let n=[...e,...t].reduce((a,u)=>a+(u.size??0),0);if(n>r)throw new ct(this.getI18n()("aggregateExceedsSize",{sizeAllowed:(0,qr.default)(r),size:(0,qr.default)(n)}))}}validateSingleFile(e){let{maxFileSize:t,minFileSize:r,allowedFileTypes:s}=this.getOpts().restrictions;if(s&&!s.some(a=>a.includes("/")?e.type?(0,sp.default)(e.type.replace(/;.*?$/,""),a):!1:a[0]==="."&&e.extension?e.extension.toLowerCase()===a.slice(1).toLowerCase():!1)){let a=s.join(", ");throw new ct(this.getI18n()("youCanOnlyUploadFileTypes",{types:a}),{file:e})}if(t&&e.size!=null&&e.size>t)throw new ct(this.getI18n()("exceedsSize",{size:(0,qr.default)(t),file:e.name??this.getI18n()("unnamed")}),{file:e});if(r&&e.size!=null&&e.size<r)throw new ct(this.getI18n()("inferiorSize",{size:(0,qr.default)(r)}),{file:e})}validate(e,t){t.forEach(r=>{this.validateSingleFile(r)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){let{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new ct(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){let t=new ct(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:e.name??this.getI18n()("unnamed")})),{requiredMetaFields:r}=this.getOpts().restrictions,s=[];for(let n of r)(!Object.hasOwn(e.meta,n)||e.meta[n]==="")&&s.push(n);return{missingFields:s,error:t}}};function In(i){if(i==null&&typeof navigator<"u"&&(i=navigator.userAgent),!i)return!0;let e=/Edge\/(\d+\.\d+)/.exec(i);if(!e)return!0;let r=e[1].split(".",2),s=parseInt(r[0],10),n=parseInt(r[1],10);return s<15||s===15&&n<15063||s>18||s===18&&n>=18218}o(In,"supportsUploadProgress");var oo={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null},Nn=class i{static{o(this,"Uppy")}static VERSION=Yc.version;#e=Object.create(null);#t;#r;#i=(0,ap.default)();#s=new Set;#a=new Set;#o=new Set;defaultLocale;locale;opts;store;i18n;i18nArray;scheduledAutoProceed=null;wasOffline=!1;constructor(e){this.defaultLocale=Jc;let t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:op,meta:{},onBeforeFileAdded:o((s,n)=>!Object.hasOwn(n,s.id),"onBeforeFileAdded"),onBeforeUpload:o(s=>s,"onBeforeUpload"),store:new to,logger:ku,infoTimeout:5e3},r={...t,...e};this.opts={...r,restrictions:{...t.restrictions,...e?.restrictions}},e?.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e?.debug&&(this.opts.logger=Ar),this.log(`Using Core v${i.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...oo,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:In(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),this.#t=new so(()=>this.opts,()=>this.i18n),this.#r=this.store.subscribe((s,n,a)=>{this.emit("state-update",s,n,a),this.updateAll(n)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),this.#w()}emit(e,...t){this.#i.emit(e,...t)}on(e,t){return this.#i.on(e,t),this}once(e,t){return this.#i.once(e,t),this}off(e,t){return this.#i.off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){let t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(([r,s])=>[r,{...t[r],...s}]))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can\u2019t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){let e=o(r=>this.log(`Missing i18n string: ${r}`,"error"),"onMissingKey"),t=new Si([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e?.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){let e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},r=Object.create(null);Object.keys(t).forEach(s=>{r[s]={...t[s],progress:{...t[s].progress,...e},tus:void 0,transloadit:void 0}}),this.setState({files:r,...oo})}clear(){let{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...oo,files:{}})}addPreProcessor(e){this.#s.add(e)}removePreProcessor(e){return this.#s.delete(e)}addPostProcessor(e){this.#o.add(e)}removePostProcessor(e){return this.#o.delete(e)}addUploader(e){this.#a.add(e)}removeUploader(e){return this.#a.delete(e)}setMeta(e){let t={...this.getState().meta,...e},r={...this.getState().files};Object.keys(r).forEach(s=>{r[s]={...r[s],meta:{...r[s].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:r})}setFileMeta(e,t){let r={...this.getState().files};if(!r[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}let s={...r[e].meta,...t};r[e]={...r[e],meta:s},this.setState({files:r})}getFile(e){return this.getState().files[e]}getFiles(){let{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){let{files:e,totalProgress:t,error:r}=this.getState(),s=Object.values(e),n=[],a=[],u=[],c=[],p=[],g=[],h=[],b=[],P=[];for(let F of s){let{progress:M}=F;!M.uploadComplete&&M.uploadStarted&&(n.push(F),F.isPaused||b.push(F)),M.uploadStarted||a.push(F),(M.uploadStarted||M.preprocess||M.postprocess)&&u.push(F),M.uploadStarted&&c.push(F),F.isPaused&&p.push(F),M.uploadComplete&&g.push(F),F.error&&h.push(F),(M.preprocess||M.postprocess)&&P.push(F)}return{newFiles:a,startedFiles:u,uploadStartedFiles:c,pausedFiles:p,completeFiles:g,erroredFiles:h,inProgressFiles:n,inProgressNotPausedFiles:b,processingFiles:P,isUploadStarted:c.length>0,isAllComplete:t===100&&g.length===s.length&&P.length===0,isAllErrored:!!r&&h.length===s.length,isAllPaused:n.length!==0&&p.length===n.length,isUploadInProgress:n.length>0,isSomeGhost:s.some(F=>F.isGhost)}}#l(e){for(let a of e)a.isRestriction?this.emit("restriction-failed",a.file,a):this.emit("error",a,a.file),this.log(a,"warning");let t=e.filter(a=>a.isUserFacing),r=4,s=t.slice(0,r),n=t.slice(r);s.forEach(({message:a,details:u=""})=>{this.info({message:a,details:u},"error",this.opts.infoTimeout)}),n.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:n.length})})}validateRestrictions(e,t=this.getFiles()){try{this.#t.validate(t,[e])}catch(r){return r}return null}validateSingleFile(e){try{this.#t.validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){let t=this.getFiles();try{this.#t.validateAggregateRestrictions(t,e)}catch(r){return r.message}return null}#n(e){let{missingFields:t,error:r}=this.#t.getMissingRequiredMetaFields(e);return t.length>0?(this.setFileState(e.id,{missingRequiredMetaFields:t,error:r.message}),this.log(r.message),this.emit("restriction-failed",e,r),!1):(t.length===0&&e.missingRequiredMetaFields&&this.setFileState(e.id,{missingRequiredMetaFields:[]}),!0)}#p(e){let t=!0;for(let r of Object.values(e))this.#n(r)||(t=!1);return t}#c(e){let{allowNewUpload:t}=this.getState();if(t===!1){let r=new ct(this.i18n("noMoreFilesAllowed"),{file:e});throw this.#l([r]),r}}checkIfFileAlreadyExists(e){let{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}#d(e){let t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,r=jr(t),s=Dn(r,t),n=Rt(s).extension,a=io(t,this.getID()),u=t.meta||{};u.name=s,u.type=r;let c=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:a,name:s,extension:n||"",meta:{...this.getState().meta,...u},type:r,data:t.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:c,uploadComplete:!1,uploadStarted:null},size:c,isGhost:!1,isRemote:t.isRemote||!1,remote:t.remote,preview:t.preview}}#u(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(e=>{e.isRestriction||this.log(e.stack||e.message||e)})},4))}#h(e){let{files:t}=this.getState(),r={...t},s=[],n=[];for(let a of e)try{let u=this.#d(a),c=t[u.id]?.isGhost;c&&(u={...t[u.id],isGhost:!1,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${u.name}, ${u.id}`));let p=this.opts.onBeforeFileAdded(u,r);if(t=this.getState().files,r={...t,...r},!p&&this.checkIfFileAlreadyExists(u.id))throw new ct(this.i18n("noDuplicates",{fileName:u.name??this.i18n("unnamed")}),{file:a});if(p===!1&&!c)throw new ct("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});typeof p=="object"&&p!==null&&(u=p),this.#t.validateSingleFile(u),r[u.id]=u,s.push(u)}catch(u){n.push(u)}try{this.#t.validateAggregateRestrictions(Object.values(t),s)}catch(a){return n.push(a),{nextFilesState:t,validFilesToAdd:[],errors:n}}return{nextFilesState:r,validFilesToAdd:s,errors:n}}addFile(e){this.#c(e);let{nextFilesState:t,validFilesToAdd:r,errors:s}=this.#h([e]),n=s.filter(u=>u.isRestriction);if(this.#l(n),s.length>0)throw s[0];this.setState({files:t});let[a]=r;return this.emit("file-added",a),this.emit("files-added",r),this.log(`Added file: ${a.name}, ${a.id}, mime type: ${a.type}`),this.#u(),a.id}addFiles(e){this.#c();let{nextFilesState:t,validFilesToAdd:r,errors:s}=this.#h(e),n=s.filter(u=>u.isRestriction);this.#l(n);let a=s.filter(u=>!u.isRestriction);if(a.length>0){let u=`Multiple errors occurred while adding files:
`;if(a.forEach(c=>{u+=`
 * ${c.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:a.length}),details:u},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(a,u);{let c=new Error(u);throw c.errors=a,c}}this.setState({files:t}),r.forEach(u=>{this.emit("file-added",u)}),this.emit("files-added",r),r.length>5?this.log(`Added batch of ${r.length} files`):Object.values(r).forEach(u=>{this.log(`Added file: ${u.name}
 id: ${u.id}
 type: ${u.type}`)}),r.length>0&&this.#u()}removeFiles(e){let{files:t,currentUploads:r}=this.getState(),s={...t},n={...r},a=Object.create(null);e.forEach(g=>{t[g]&&(a[g]=t[g],delete s[g])});function u(g){return a[g]===void 0}o(u,"fileIsNotRemoved"),Object.keys(n).forEach(g=>{let h=r[g].fileIDs.filter(u);if(h.length===0){delete n[g];return}let{capabilities:b}=this.getState();if(h.length!==r[g].fileIDs.length&&!b.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");n[g]={...r[g],fileIDs:h}});let c={currentUploads:n,files:s};Object.keys(s).length===0&&(c.allowNewUpload=!0,c.error=null,c.recoveredState=null),this.setState(c),this.#v();let p=Object.keys(a);p.forEach(g=>{this.emit("file-removed",a[g])}),p.length>5?this.log(`Removed ${p.length} files`):this.log(`Removed files: ${p.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;let t=this.getFile(e),s=!(t.isPaused||!1);return this.setFileState(e,{isPaused:s}),this.emit("upload-pause",t,s),s}pauseAll(){let e={...this.getState().files};Object.keys(e).filter(r=>!e[r].progress.uploadComplete&&e[r].progress.uploadStarted).forEach(r=>{let s={...e[r],isPaused:!0};e[r]=s}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){let e={...this.getState().files};Object.keys(e).filter(r=>!e[r].progress.uploadComplete&&e[r].progress.uploadStarted).forEach(r=>{let s={...e[r],isPaused:!1,error:null};e[r]=s}),this.setState({files:e}),this.emit("resume-all")}#f(){let{files:e}=this.getState();return Object.keys(e).filter(t=>{let r=e[t];return r.error&&(!r.missingRequiredMetaFields||r.missingRequiredMetaFields.length===0)})}async#m(){let e=this.#f(),t={...this.getState().files};if(e.forEach(s=>{t[s]={...t[s],isPaused:!1,error:null}}),this.setState({files:t,error:null}),this.emit("retry-all",this.getFilesByIds(e)),e.length===0)return{successful:[],failed:[]};let r=this.#S(e,{forceAllowNewUpload:!0});return this.#k(r)}async retryAll(){let e=await this.#m();return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");let{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(oo)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));let t=this.#S([e],{forceAllowNewUpload:!0});return this.#k(t)}logout(){this.iteratePlugins(e=>{e.provider?.logout?.()})}#y=o((e,t)=>{let r=e?this.getFile(e.id):void 0;if(e==null||!r){this.log(`Not setting progress for a file that has been removed: ${e?.id}`);return}if(r.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);return}let s={bytesTotal:t.bytesTotal,percentage:t.bytesTotal!=null&&Number.isFinite(t.bytesTotal)&&t.bytesTotal>0?Math.round(t.bytesUploaded/t.bytesTotal*100):void 0};r.progress.uploadStarted!=null?this.setFileState(e.id,{progress:{...r.progress,...s,bytesUploaded:t.bytesUploaded}}):this.setFileState(e.id,{progress:{...r.progress,...s}}),this.#v()},"#handleUploadProgress");#g(){let e=this.#P(),t=null;e!=null&&(t=Math.round(e*100),t>100?t=100:t<0&&(t=0)),this.emit("progress",t??0),this.setState({totalProgress:t??0})}#v=(0,np.default)(()=>this.#g(),500,{leading:!0,trailing:!0});[Symbol.for("uppy test: updateTotalProgress")](){return this.#g()}#P(){let t=this.getFiles().filter(c=>c.progress.uploadStarted||c.progress.preprocess||c.progress.postprocess);if(t.length===0)return 0;if(t.every(c=>c.progress.uploadComplete))return 1;let r=o(c=>c.progress.bytesTotal!=null&&c.progress.bytesTotal!==0,"isSizedFile"),s=t.filter(r),n=t.filter(c=>!r(c));if(s.every(c=>c.progress.uploadComplete)&&n.length>0&&!n.every(c=>c.progress.uploadComplete))return null;let a=s.reduce((c,p)=>c+(p.progress.bytesTotal??0),0),u=s.reduce((c,p)=>c+(p.progress.bytesUploaded||0),0);return a===0?0:u/a}#w(){let e=o((s,n,a)=>{let u=s.message||"Unknown error";s.details&&(u+=` ${s.details}`),this.setState({error:u}),n!=null&&n.id in this.getState().files&&this.setFileState(n.id,{error:u,response:a})},"errorHandler");this.on("error",e),this.on("upload-error",(s,n,a)=>{if(e(n,s,a),typeof n=="object"&&n.message){this.log(n.message,"error");let u=new Error(this.i18n("failedToUpload",{file:s?.name??""}));u.isUserFacing=!0,u.details=n.message,n.details&&(u.details+=` ${n.details}`),this.#l([u])}else this.#l([n])});let t=null;this.on("upload-stalled",(s,n)=>{let{message:a}=s,u=n.map(c=>c.meta.name).join(", ");t||(this.info({message:a,details:u},"warning",this.opts.infoTimeout),t=setTimeout(()=>{t=null},this.opts.infoTimeout)),this.log(`${a} ${u}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});let r=o(s=>{let n=s.filter(u=>{let c=u!=null&&this.getFile(u.id);return c||this.log(`Not setting progress for a file that has been removed: ${u?.id}`),c}),a=Object.fromEntries(n.map(u=>[u.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:u.size}}]));this.patchFilesState(a)},"onUploadStarted");this.on("upload-start",r),this.on("upload-progress",this.#y),this.on("upload-success",(s,n)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}let a=this.getFile(s.id).progress;this.setFileState(s.id,{progress:{...a,postprocess:this.#o.size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:a.bytesTotal},response:n,uploadURL:n.uploadURL,isPaused:!1}),s.size==null&&this.setFileState(s.id,{size:n.bytesUploaded||a.bytesTotal}),this.#v()}),this.on("preprocess-progress",(s,n)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}this.setFileState(s.id,{progress:{...this.getFile(s.id).progress,preprocess:n}})}),this.on("preprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}let n={...this.getState().files};n[s.id]={...n[s.id],progress:{...n[s.id].progress}},delete n[s.id].progress.preprocess,this.setState({files:n})}),this.on("postprocess-progress",(s,n)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}this.setFileState(s.id,{progress:{...this.getState().files[s.id].progress,postprocess:n}})}),this.on("postprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}let n={...this.getState().files};n[s.id]={...n[s.id],progress:{...n[s.id].progress}},delete n[s.id].progress.postprocess,this.setState({files:n})}),this.on("restored",()=>{this.#v()}),this.on("dashboard:file-edit-complete",s=>{s&&this.#n(s)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",this.#b),window.addEventListener("offline",this.#b),setTimeout(this.#b,3e3))}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}#b=this.updateOnlineStatus.bind(this);getID(){return this.opts.id}use(e,...t){if(typeof e!="function"){let a=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(a)}let r=new e(this,...t),s=r.id;if(!s)throw new Error("Your plugin must have an id");if(!r.type)throw new Error("Your plugin must have a type");let n=this.getPlugin(s);if(n){let a=`Already found a plugin named '${n.id}'. Tried to use: '${s}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(a)}return e.VERSION&&this.log(`Using ${s} v${e.VERSION}`),r.type in this.#e?this.#e[r.type].push(r):this.#e[r.type]=[r],r.install(),this.emit("plugin-added",r),this}getPlugin(e){for(let t of Object.values(this.#e)){let r=t.find(s=>s.id===e);if(r!=null)return r}}[Symbol.for("uppy test: getPlugins")](e){return this.#e[e]}iteratePlugins(e){Object.values(this.#e).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();let t=this.#e[e.type],r=t.findIndex(a=>a.id===e.id);r!==-1&&t.splice(r,1);let n={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(n)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),this.#r(),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",this.#b),window.removeEventListener("offline",this.#b))}hideInfo(){let{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t="info",r=3e3){let s=typeof e=="object";this.setState({info:[...this.getState().info,{type:t,message:s?e.message:e,details:s?e.details:null}]}),setTimeout(()=>this.hideInfo(),r),this.emit("info-visible")}log(e,t){let{logger:r}=this.opts;switch(t){case"error":r.error(e);break;case"warning":r.warn(e);break;default:r.debug(e);break}}#x=new Map;registerRequestClient(e,t){this.#x.set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);let t=this.#x.get(e.remote.requestClientId);if(t==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?this.#k(e):(this.#_(e),Promise.reject(new Error("Nonexistent upload")))}#S(e,t={}){let{forceAllowNewUpload:r=!1}=t,{allowNewUpload:s,currentUploads:n}=this.getState();if(!s&&!r)throw new Error("Cannot create a new upload: already uploading.");let a=wt();return this.emit("upload",a,this.getFilesByIds(e)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...n,[a]:{fileIDs:e,step:0,result:{}}}}),a}[Symbol.for("uppy test: createUpload")](...e){return this.#S(...e)}#E(e){let{currentUploads:t}=this.getState();return t[e]}addResultData(e,t){if(!this.#E(e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}let{currentUploads:r}=this.getState(),s={...r[e],result:{...r[e].result,...t}};this.setState({currentUploads:{...r,[e]:s}})}#_(e){let t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})}async#k(e){let t=o(()=>{let{currentUploads:a}=this.getState();return a[e]},"getCurrentUpload"),r=t(),s=[...this.#s,...this.#a,...this.#o];try{for(let a=r.step||0;a<s.length&&r;a++){let u=s[a];this.setState({currentUploads:{...this.getState().currentUploads,[e]:{...r,step:a}}});let{fileIDs:c}=r;await u(c,e),r=t()}}catch(a){throw this.#_(e),a}if(r){r.fileIDs.forEach(p=>{let g=this.getFile(p);g?.progress.postprocess&&this.emit("postprocess-complete",g)});let a=r.fileIDs.map(p=>this.getFile(p)),u=a.filter(p=>!p.error),c=a.filter(p=>p.error);this.addResultData(e,{successful:u,failed:c,uploadID:e}),r=t()}let n;return r&&(n=r.result,this.#_(e)),n==null&&(this.log(`Not setting result for an upload that has been removed: ${e}`),n={successful:[],failed:[],uploadID:e}),n}async upload(){this.#e.uploader?.length||this.log("No uploader type plugins are used","warning");let{files:e}=this.getState();if(this.#f().length>0){let s=await this.#m();if(!(this.getFiles().filter(a=>a.progress.uploadStarted==null).length>0))return this.emit("complete",s),s;({files:e}=this.getState())}let r=this.opts.onBeforeUpload(e);return r===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(r&&typeof r=="object"&&(e=r,this.setState({files:e})),Promise.resolve().then(()=>this.#t.validateMinNumberOfFiles(e)).catch(s=>{throw this.#l([s]),s}).then(()=>{if(!this.#p(e))throw new ct(this.i18n("missingRequiredMetaField"))}).catch(s=>{throw s}).then(async()=>{let{currentUploads:s}=this.getState(),n=Object.values(s).flatMap(p=>p.fileIDs),a=[];Object.keys(e).forEach(p=>{let g=this.getFile(p);!g.progress.uploadStarted&&n.indexOf(p)===-1&&a.push(g.id)});let u=this.#S(a),c=await this.#k(u);return this.emit("complete",c),c}).catch(s=>{throw this.emit("error",s),this.log(s,"error"),s}))}},no=Nn;var Wn={};Gs(Wn,{Provider:()=>qe,RequestClient:()=>Je,SearchProvider:()=>ki,getAllowedHosts:()=>He,tokenStorage:()=>Ce});function hv(i){return i.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}o(hv,"escapeRegex");function Mn(i){if(typeof i=="string")return new RegExp(`^${i}$`);if(i instanceof RegExp)return i}o(Mn,"wrapInRegex");function He(i,e){if(i){let r=o(s=>{if(!(typeof s=="string"&&Mn(s))&&!(s instanceof RegExp))throw new TypeError('The option "companionAllowedHosts" must be one of string, Array, RegExp')},"validate");return Array.isArray(i)?i.every(r):r(i),i}let t=e;return/^(?!https?:\/\/).*$/i.test(t)&&(t=`https://${e.replace(/^\/\//,"")}`),t=new URL(t).origin,t=hv(t),t}o(He,"getAllowedHosts");function lp(i,e){return(Array.isArray(e)?e.map(Mn):[Mn(e)]).some(r=>r?.test(i)||r?.test(`${i}/`))}o(lp,"isOriginAllowed");function ft(i,e){return Object.hasOwn(i,e)}o(ft,"hasProperty");var Ln=class extends Error{static{o(this,"ErrorWithCause")}isNetworkError;cause;constructor(e,t){super(e),this.cause=t?.cause,this.cause&&ft(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}},$i=Ln;var Bn=class extends Error{static{o(this,"NetworkError")}cause;isNetworkError;request;constructor(e,t=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}},kt=Bn;function _i(...i){return fetch(...i).catch(e=>{throw e.name==="AbortError"?e:new kt(e)})}o(_i,"fetchWithNetworkError");function jn(i){let t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?([^\n]+)/i.exec(i)?.[1];return`${/^http:\/\//i.test(i)?"ws":"wss"}://${t}`}o(jn,"getSocketHost");var zn=class extends Error{static{o(this,"UserFacingApiError")}name="UserFacingApiError"},up=zn;var gp=de(fp(),1);var mv=Object.prototype.toString,gv=o(i=>mv.call(i)==="[object Error]","isError"),yv=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function Hn(i){return i&&gv(i)&&i.name==="TypeError"&&typeof i.message=="string"?i.message==="Load failed"?i.stack===void 0:yv.has(i.message):!1}o(Hn,"isNetworkError");var Wi=class extends Error{static{o(this,"AbortError")}constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},mp=o((i,e,t)=>{let r=t.retries-(e-1);return i.attemptNumber=e,i.retriesLeft=r,i},"decorateErrorWithCounts");async function ao(i,e){return new Promise((t,r)=>{e={onFailedAttempt(){},retries:10,shouldRetry:o(()=>!0,"shouldRetry"),...e};let s=gp.default.operation(e),n=o(()=>{s.stop(),r(e.signal?.reason)},"abortHandler");e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",n,{once:!0});let a=o(()=>{e.signal?.removeEventListener("abort",n),s.stop()},"cleanUp");s.attempt(async u=>{try{let c=await i(u);a(),t(c)}catch(c){try{if(!(c instanceof Error))throw new TypeError(`Non-error was thrown: "${c}". You should only throw errors.`);if(c instanceof Wi)throw c.originalError;if(c instanceof TypeError&&!Hn(c))throw c;if(mp(c,u,e),await e.shouldRetry(c)||(s.stop(),r(c)),await e.onFailedAttempt(c),!s.retry(c))throw s.mainError()}catch(p){mp(p,u,e),a(),r(p)}}})})}o(ao,"pRetry");var yp={name:"@uppy/companion-client",description:"Client library for communication with Companion. Intended for use in Uppy plugins.",version:"4.5.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","companion","provider"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^","namespace-emitter":"^2.0.1","p-retry":"^6.1.0"},devDependencies:{jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"workspace:^"}};var qn=class extends Error{static{o(this,"AuthError")}isAuthError;constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}},vp=qn;function bv(i){return i.replace(/\/$/,"")}o(bv,"stripSlash");var bp=10,wv=5*60*1e3,$n=401,Vn=class extends Error{static{o(this,"HttpError")}statusCode;constructor({statusCode:e,message:t}){super(t),this.name="HttpError",this.statusCode=e}};async function Sv(i){if(i.status===$n)throw new vp;if(i.ok)return i.json();let e=`Failed request with status: ${i.status}. ${i.statusText}`,t;try{t=await i.json(),t.message&&(e=`${e} message: ${t.message}`),t.requestId&&(e=`${e} request-Id: ${t.requestId}`)}catch(r){throw new Error(e,{cause:r})}throw i.status>=400&&i.status<=499&&t.message?new up(t.message):new Vn({statusCode:i.status,message:e})}o(Sv,"handleJSONResponse");function xv(i,e,t){let{progress:r,bytesUploaded:s,bytesTotal:n}=e;r&&(i.uppy.log(`Upload progress: ${r}`),i.uppy.emit("upload-progress",t,{uploadStarted:t.progress.uploadStarted??0,bytesUploaded:s,bytesTotal:n}))}o(xv,"emitSocketProgress");var Je=class{static{o(this,"RequestClient")}static VERSION=yp.version;#e;uppy;opts;constructor(e,t){this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),this.#e=t.companionHeaders}setCompanionHeaders(e){this.#e=e}[Symbol.for("uppy test: getCompanionHeaders")](){return this.#e}get hostname(){let{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return bv(e?.[t]?e[t]:t)}async headers(e=!1){return{...{Accept:"application/json",...e?void 0:{"Content-Type":"application/json"}},...this.#e}}onReceiveResponse(e){let{headers:t}=e,s=this.uppy.getState().companion||{},n=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==s[n]&&this.uppy.setState({companion:{...s,[n]:t.get("i-am")}})}#t(e){return/^(https?:|)\/\//.test(e)?e:`${this.hostname}/${e}`}async request({path:e,method:t="GET",data:r,skipPostResponse:s,signal:n}){try{let a=await this.headers(!r),u=await _i(this.#t(e),{method:t,signal:n,headers:a,credentials:this.opts.companionCookiesRule||"same-origin",body:r?JSON.stringify(r):null});return s||this.onReceiveResponse(u),await Sv(u)}catch(a){throw a.isAuthError||a.name==="UserFacingApiError"||a.name==="AbortError"?a:new $i(`Could not ${t} ${this.#t(e)}`,{cause:a})}}async get(e,t){return this.request({...t,path:e})}async post(e,t,r){return this.request({...r,path:e,method:"POST",data:t})}async delete(e,t,r){return this.request({...r,path:e,method:"DELETE",data:t})}async uploadRemoteFile(e,t,r){try{let{signal:s,getQueue:n}=r||{};return await ao(async()=>{let a=this.uppy.getFile(e.id)?.serverToken;if(a!=null)return this.uppy.log(`Connecting to exiting websocket ${a}`),this.#i({file:e,queue:n(),signal:s});let c=await n().wrapPromiseFunction(async(...p)=>{try{return await this.#r(...p)}catch(g){if(g.isAuthError)throw new Wi(g);if(g.cause==null)throw g;let h=g.cause,b=o(()=>[408,409,429,418,423].includes(h.statusCode)||h.statusCode>=500&&h.statusCode<=599&&![501,505].includes(h.statusCode),"isRetryableHttpError");throw h.name==="HttpError"&&!b()?new Wi(h):h}},{priority:-1})({file:e,postBody:t,signal:s}).abortOn(s);if(this.uppy.getFile(e.id))return this.uppy.setFileState(e.id,{serverToken:c}),this.#i({file:this.uppy.getFile(e.id),queue:n(),signal:s})},{retries:bp,signal:s,onFailedAttempt:o(a=>this.uppy.log(`Retrying upload due to: ${a.message}`,"warning"),"onFailedAttempt")})}catch(s){if(s.name==="AbortError")return;throw this.uppy.emit("upload-error",e,s),s}}#r=o(async({file:e,postBody:t,signal:r})=>{if(e.remote?.url==null)throw new Error("Cannot connect to an undefined URL");return(await this.post(e.remote.url,{...e.remote.body,...t},{signal:r})).token},"#requestSocketToken");async#i({file:e,queue:t,signal:r}){let s,{capabilities:n}=this.uppy.getState();try{return await new Promise((a,u)=>{let c=e.serverToken,p=jn(e.remote.companionUrl),g,h,b,{isPaused:P}=e,F=o((K,te)=>{if(g==null||g.readyState!==g.OPEN){this.uppy.log(`Cannot send "${K}" to socket ${e.id} because the socket state was ${String(g?.readyState)}`,"warning");return}g.send(JSON.stringify({action:K,payload:te??{}}))},"socketSend");function M(){n.resumableUploads&&F(P?"pause":"resume")}o(M,"sendState");let C=o(async()=>{h&&h.abort(),h=new AbortController;let K=o(Q=>{this.uppy.setFileState(e.id,{serverToken:null}),h?.abort?.(),u(Q)},"onFatalError");function te(){clearTimeout(b),!P&&(b=setTimeout(()=>K(new Error("Timeout waiting for message from Companion socket")),wv))}o(te,"resetActivityTimeout");try{await t.wrapPromiseFunction(async()=>{await ao(o(async()=>new Promise((be,ne)=>{g=new WebSocket(`${p}/api/${c}`),te(),g.addEventListener("close",()=>{g=void 0,ne(new Error("Socket closed unexpectedly"))}),g.addEventListener("error",ye=>{this.uppy.log(`Companion socket error ${JSON.stringify(ye)}, closing socket`,"warning"),g?.close()}),g.addEventListener("open",()=>{M()}),g.addEventListener("message",ye=>{te();try{let{action:Te,payload:Se}=JSON.parse(ye.data);switch(Te){case"progress":{xv(this,Se,this.uppy.getFile(e.id));break}case"success":{let k=Se.response?.responseText;this.uppy.emit("upload-success",this.uppy.getFile(e.id),{uploadURL:Se.url,status:Se.response?.status??200,body:k?JSON.parse(k):void 0}),h?.abort?.(),a();break}case"error":{let{message:k}=Se.error;throw Object.assign(new Error(k),{cause:Se.error})}default:this.uppy.log(`Companion socket unknown action ${Te}`,"warning")}}catch(Te){K(Te)}});let Pe=o(()=>{this.uppy.log(`Closing socket ${e.id}`),clearTimeout(b),g&&g.close(),g=void 0},"closeSocket");h.signal.addEventListener("abort",()=>{Pe()})}),"reconnectWebsocket"),{retries:bp,signal:h.signal,onFailedAttempt:o(()=>{h.signal.aborted||this.uppy.log(`Retrying websocket ${e.id}`)},"onFailedAttempt")})})().abortOn(h.signal)}catch(Q){if(h.signal.aborted)return;K(Q)}},"createWebsocket"),O=o(K=>{n.resumableUploads&&(P=K,g&&M())},"pause"),U=o(K=>{n.individualCancellation&&K.id===e.id&&(F("cancel"),h?.abort?.(),this.uppy.log(`upload ${e.id} was removed`),a())},"onFileRemove"),A=o(()=>{F("cancel"),h?.abort?.(),this.uppy.log(`upload ${e.id} was canceled`),a()},"onCancelAll"),J=o((K,te)=>{K?.id===e.id&&O(te)},"onFilePausedChange"),G=o(()=>O(!0),"onPauseAll"),W=o(()=>O(!1),"onResumeAll");this.uppy.on("file-removed",U),this.uppy.on("cancel-all",A),this.uppy.on("upload-pause",J),this.uppy.on("pause-all",G),this.uppy.on("resume-all",W),s=o(()=>{this.uppy.off("file-removed",U),this.uppy.off("cancel-all",A),this.uppy.off("upload-pause",J),this.uppy.off("pause-all",G),this.uppy.off("resume-all",W)},"removeEventHandlers"),r.addEventListener("abort",()=>{h?.abort()}),C()})}finally{s?.()}}};var _v=o(i=>i.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),"getName");function Pv(){return location.origin}o(Pv,"getOrigin");var qe=class extends Je{static{o(this,"Provider")}#e;provider;id;name;pluginId;tokenKey;companionKeysParams;preAuthToken;supportsRefreshToken;constructor(e,t){super(e,t),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||_v(this.id),this.pluginId=this.opts.pluginId,this.tokenKey=`companion-${this.pluginId}-auth-token`,this.companionKeysParams=this.opts.companionKeysParams,this.preAuthToken=null,this.supportsRefreshToken=!!t.supportsRefreshToken}async headers(){let[e,t]=await Promise.all([super.headers(),this.#t()]),r={};return t&&(r["uppy-auth-token"]=t),this.companionKeysParams&&(r["uppy-credentials-params"]=btoa(JSON.stringify({params:this.companionKeysParams}))),{...e,...r}}onReceiveResponse(e){super.onReceiveResponse(e);let t=this.#r(),s=t.getPluginState().authenticated?e.status!==$n:e.status<400;return t.setPluginState({authenticated:s}),e}async setAuthToken(e){return this.#r().storage.setItem(this.tokenKey,e)}async#t(){return this.#r().storage.getItem(this.tokenKey)}async removeAuthToken(){return this.#r().storage.removeItem(this.tokenKey)}#r(){let e=this.uppy.getPlugin(this.pluginId);if(e==null)throw new Error("Plugin was nullish");return e}async ensurePreAuth(){if(this.companionKeysParams&&!this.preAuthToken&&(await this.fetchPreAuthToken(),!this.preAuthToken))throw new Error("Could not load authentication data required for third-party login. Please try again later.")}authQuery(e){return{}}authUrl({authFormData:e,query:t}){let r=new URLSearchParams({...t,state:btoa(JSON.stringify({origin:Pv()})),...this.authQuery({authFormData:e})});return this.preAuthToken&&r.set("uppyPreAuthToken",this.preAuthToken),`${this.hostname}/${this.id}/connect?${r}`}async loginSimpleAuth({uppyVersions:e,authFormData:t,signal:r}){let s=await this.post(`${this.id}/simple-auth`,{form:t},{qs:{uppyVersions:e},signal:r});this.setAuthToken(s.uppyAuthToken)}async loginOAuth({uppyVersions:e,authFormData:t,signal:r}){await this.ensurePreAuth(),r.throwIfAborted();let s=this.authUrl({query:{uppyVersions:e},authFormData:t}),n=window.open(s,"_blank"),a,u;try{return await new Promise((c,p)=>{u=o(g=>{if(g.source!==n){let P="";try{P=JSON.stringify(g.data)}catch{}this.uppy.log(`ignoring event from unknown source ${P}`,"warning");return}let{companionAllowedHosts:h}=this.#r().opts;if(!lp(g.origin,h)){this.uppy.log(`ignoring event from ${g.origin} vs allowed pattern ${h}`,"warning");return}let b=typeof g.data=="string"?JSON.parse(g.data):g.data;if(b.error){let{uppy:P}=this,F=P.i18n("authAborted");P.info({message:F},"warning",5e3),p(new Error("auth aborted"));return}if(!b.token){p(new Error("did not receive token from auth window"));return}c(this.setAuthToken(b.token))},"handleMessage"),n&&(a=window.setInterval(()=>{n.closed&&p(new Error("Auth window was closed by the user"))},500)),r.addEventListener("abort",()=>p(new Error("Aborted"))),window.addEventListener("message",u)})}finally{n?.close(),window.clearInterval(a),u&&window.removeEventListener("message",u)}}async login({uppyVersions:e,authFormData:t,signal:r}){return this.loginOAuth({uppyVersions:e,authFormData:t,signal:r})}refreshTokenUrl(){return`${this.hostname}/${this.id}/refresh-token`}fileUrl(e){return`${this.hostname}/${this.id}/get/${e}`}async request(...e){await this.#e;try{return await super.request(...e)}catch(t){if(!this.supportsRefreshToken)throw t;let r=await this.#t();if(!t.isAuthError||!r)throw t;return this.#e==null&&(this.#e=(async()=>{try{this.uppy.log("[CompanionClient] Refreshing expired auth token");let s=await super.request({path:this.refreshTokenUrl(),method:"POST"});await this.setAuthToken(s.uppyAuthToken)}catch(s){throw s.isAuthError&&await this.removeAuthToken(),t}finally{this.#e=void 0}})()),await this.#e,super.request(...e)}}async fetchPreAuthToken(){if(this.companionKeysParams)try{let e=await this.post(`${this.id}/preauth/`,{params:this.companionKeysParams});this.preAuthToken=e.token}catch(e){this.uppy.log(`[CompanionClient] unable to fetch preAuthToken ${e}`,"warning")}}list(e,t){return this.get(`${this.id}/list/${e||""}`,t)}async logout(e){let t=await this.get(`${this.id}/logout`,e);return await this.removeAuthToken(),t}};var kv=o(i=>i.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),"getName"),ki=class extends Je{static{o(this,"SearchProvider")}provider;id;name;pluginId;constructor(e,t){super(e,t),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||kv(this.id),this.pluginId=this.opts.pluginId}fileUrl(e){return`${this.hostname}/search/${this.id}/get/${e}`}search(e,t){return this.get(`search/${this.id}/list?q=${encodeURIComponent(e)}${t?`&${t}`:""}`)}};var Ce={};Gs(Ce,{getItem:()=>Fv,removeItem:()=>Cv,setItem:()=>Ev});async function Ev(i,e){localStorage.setItem(i,e)}o(Ev,"setItem");async function Fv(i){return localStorage.getItem(i)}o(Fv,"getItem");async function Cv(i){localStorage.removeItem(i)}o(Cv,"removeItem");var la={};Gs(la,{GooglePickerView:()=>Ei,ProviderViews:()=>Me,SearchInput:()=>Fi,SearchProviderViews:()=>Zt,defaultPickerIcon:()=>Xi});var Tv=0,X_=Array.isArray;function l(i,e,t,r,s,n){e||(e={});var a,u,c=e;if("ref"in c)for(u in c={},e)u=="ref"?a=e[u]:c[u]=e[u];var p={type:i,props:c,key:t,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Tv,__i:-1,__u:0,__source:s,__self:n};if(typeof i=="function"&&(a=i.defaultProps))for(u in a)c[u]===void 0&&(c[u]=a[u]);return ie.vnode&&ie.vnode(p),p}o(l,"u");function Av(){return l("svg",{width:"26",height:"26",viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg",children:l("g",{fill:"none","fill-rule":"evenodd",children:[l("circle",{fill:"#FFF",cx:"13",cy:"13",r:"13"}),l("path",{d:"M21.64 13.205c0-.639-.057-1.252-.164-1.841H13v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z",fill:"#4285F4","fill-rule":"nonzero"}),l("path",{d:"M13 22c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H4.957v2.332A8.997 8.997 0 0013 22z",fill:"#34A853","fill-rule":"nonzero"}),l("path",{d:"M7.964 14.71A5.41 5.41 0 017.682 13c0-.593.102-1.17.282-1.71V8.958H4.957A8.996 8.996 0 004 13c0 1.452.348 2.827.957 4.042l3.007-2.332z",fill:"#FBBC05","fill-rule":"nonzero"}),l("path",{d:"M13 7.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C17.463 4.891 15.426 4 13 4a8.997 8.997 0 00-8.043 4.958l3.007 2.332C8.672 9.163 10.656 7.58 13 7.58z",fill:"#EA4335","fill-rule":"nonzero"}),l("path",{d:"M4 4h18v18H4z"})]})})}o(Av,"GoogleIcon");function Rv({pluginName:i,i18n:e,onAuth:t}){let r=i==="Google Drive",s=Ye(n=>{n.preventDefault(),t()},[t]);return l("form",{onSubmit:s,children:r?l("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn uppy-Provider-btn-google","data-uppy-super-focusable":!0,children:[l(Av,{}),e("signInWithGoogle")]}):l("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn","data-uppy-super-focusable":!0,children:e("authenticateWith",{pluginName:i})})})}o(Rv,"DefaultForm");var Ov=o(({pluginName:i,i18n:e,onAuth:t})=>l(Rv,{pluginName:i,i18n:e,onAuth:t}),"defaultRenderForm");function Vr({loading:i,pluginName:e,pluginIcon:t,i18n:r,handleAuth:s,renderForm:n=Ov}){return l("div",{className:"uppy-Provider-auth",children:[l("div",{className:"uppy-Provider-authIcon",children:t()}),l("div",{className:"uppy-Provider-authTitle",children:r("authenticateWithTitle",{pluginName:e})}),n({pluginName:e,i18n:r,loading:i,onAuth:s})]})}o(Vr,"AuthView");var Gn=o(i=>({authorization:`Bearer ${i}`}),"getAuthHeader"),wp=new Set,Sp=!1;async function xp(i){wp.has(i)||(await new Promise((e,t)=>{let r=document.createElement("script");r.src=i,r.addEventListener("load",()=>e()),r.addEventListener("error",s=>t(s.error)),document.head.appendChild(r)}),wp.add(i))}o(xp,"injectScript");async function _p(i){await Promise.all([xp("https://accounts.google.com/gsi/client"),(async()=>{await xp("https://apis.google.com/js/api.js"),i==="drive"&&!Sp&&(await new Promise(e=>gapi.load("client:picker",()=>e())),await gapi.client.load("https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"),Sp=!0)})()])}o(_p,"ensureScriptsInjected");async function Uv(i,e){return!!(await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${encodeURIComponent(i)}`,{signal:e})).ok}o(Uv,"isTokenValid");async function Kn({pickerType:i,clientId:e,accessToken:t}){let r=await new Promise((s,n)=>{let a=i==="drive"?["https://www.googleapis.com/auth/drive.file"]:["https://www.googleapis.com/auth/photospicker.mediaitems.readonly"],u=google.accounts.oauth2.initTokenClient({client_id:e,scope:a.join(" "),callback:s,error_callback:n});t===null?u.requestAccessToken({prompt:"consent"}):u.requestAccessToken({prompt:""})});if(r.error)throw new Error(`OAuth2 error: ${r.error}`);return r.access_token}o(Kn,"authorize");async function Pp(i){await new Promise(e=>google.accounts.oauth2.revoke(i,e))}o(Pp,"logout");var Gi=class extends Error{static{o(this,"InvalidTokenError")}constructor(){super("Invalid or expired token"),this.name="InvalidTokenError"}};async function kp({token:i,apiKey:e,appId:t,onFilesPicked:r,signal:s}){if(!await Uv(i,s))throw new Gi;let n=o(u=>{u.action===google.picker.Action.PICKED&&r(u.docs.map(c=>({platform:"drive",id:c.id,name:c.name,mimeType:c.mimeType})),i)},"onPicked"),a=new google.picker.PickerBuilder().enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setDeveloperKey(e).setAppId(t).setOAuthToken(i).addView(new google.picker.DocsView(google.picker.ViewId.DOCS).setIncludeFolders(!0).setSelectFolderEnabled(!1).setMode(google.picker.DocsViewMode.LIST)).setCallback(n).build();a.setVisible(!0),s?.addEventListener("abort",()=>a.dispose())}o(kp,"showDrivePicker");async function Ep({token:i,pickingSession:e,onPickingSessionChange:t,signal:r}){let s=Gn(i),n=e;if(n==null){let u=await fetch("https://photospicker.googleapis.com/v1/sessions",{method:"post",headers:s,signal:r});if(u.status===401&&(await u.json()).error?.status==="UNAUTHENTICATED")throw new Gi;if(!u.ok)throw new Error("Failed to create a session");n=await u.json(),t(n)}let a=window.open(n.pickerUri);r?.addEventListener("abort",()=>a?.close())}o(Ep,"showPhotosPicker");async function Dv({accessToken:i,pickingSession:e,signal:t}){let r=Gn(i),s,n=[];do{let u=await fetch(`https://photospicker.googleapis.com/v1/mediaItems?${new URLSearchParams({sessionId:e.id,pageSize:String(100),...s&&{pageToken:s}}).toString()}`,{headers:r,signal:t});if(!u.ok)throw new Error("Failed to get a media items");let{mediaItems:c,nextPageToken:p}=await u.json();s=p,n.push(...c)}while(s);return n=n.flatMap(a=>a.type==="PHOTO"||a.type==="VIDEO"&&a.mediaFile.mediaFileMetadata.videoMetadata.processingStatus==="READY"?[a]:[]),n.map(a=>{let{id:u,type:c,mediaFile:{mimeType:p,filename:g,baseUrl:h}}=a;return{platform:"photos",id:u,mimeType:p,url:c==="VIDEO"?`${h}=dv`:`${h}=d`,name:g,metadata:{googlePhotosFileType:a.type,createTime:a.createTime,width:a.mediaFile.mediaFileMetadata.width,height:a.mediaFile.mediaFileMetadata.height,...a.type==="PHOTO"&&{cameraMake:a.mediaFile.mediaFileMetadata.photoMetadata?.cameraMake,cameraModel:a.mediaFile.mediaFileMetadata.photoMetadata?.cameraModel,focalLength:a.mediaFile.mediaFileMetadata.photoMetadata?.focalLength,apertureFNumber:a.mediaFile.mediaFileMetadata.photoMetadata?.apertureFNumber,isoEquivalent:a.mediaFile.mediaFileMetadata.photoMetadata?.isoEquivalent,exposureTime:a.mediaFile.mediaFileMetadata.photoMetadata?.exposureTime},...a.type==="VIDEO"&&{cameraMake:a.mediaFile.mediaFileMetadata.videoMetadata.cameraMake,cameraModel:a.mediaFile.mediaFileMetadata.videoMetadata.cameraModel,fps:a.mediaFile.mediaFileMetadata.videoMetadata.fps,processingStatus:a.mediaFile.mediaFileMetadata.videoMetadata.processingStatus}}}})}o(Dv,"resolvePickedPhotos");async function Fp({pickingSessionRef:i,accessTokenRef:e,signal:t,onFilesPicked:r,onError:s}){for(let n=1;;)try{i.current!=null?n=parseFloat(i.current.pollingConfig.pollInterval):n=1,await Promise.race([new Promise(c=>setTimeout(c,n*1e3)),new Promise((c,p)=>{t.addEventListener("abort",p)})]),t.throwIfAborted();let a=e.current,u=i.current;if(u!=null&&a!=null){let c=Gn(a),p=await fetch(`https://photospicker.googleapis.com/v1/sessions/${encodeURIComponent(u.id)}`,{headers:c,signal:t});if(!p.ok)throw new Error("Failed to get session");if((await p.json()).mediaItemsSet){let h=await Dv({accessToken:a,pickingSession:u,signal:t});i.current=void 0,r(h,a)}u.pollingConfig.timeoutIn==="0s"&&(i.current=void 0)}}catch(a){if(a instanceof Error&&a.name==="AbortError")return;s(a)}}o(Fp,"pollPickingSession");var lo=o(()=>l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"-7 -7 73 73",children:l("g",{fill:"none","fill-rule":"evenodd",children:[l("path",{d:"M-3-3h64v64H-3z"}),l("g",{"fill-rule":"nonzero",children:[l("path",{fill:"#FBBC04",d:"M14.8 13.4c8.1 0 14.7 6.6 14.7 14.8v1.3H1.3c-.7 0-1.3-.6-1.3-1.3C0 20 6.6 13.4 14.8 13.4z"}),l("path",{fill:"#EA4335",d:"M45.6 14.8c0 8.1-6.6 14.7-14.8 14.7h-1.3V1.3c0-.7.6-1.3 1.3-1.3C39 0 45.6 6.6 45.6 14.8z"}),l("path",{fill:"#4285F4",d:"M44.3 45.6c-8.2 0-14.8-6.6-14.8-14.8v-1.3h28.2c.7 0 1.3.6 1.3 1.3 0 8.2-6.6 14.8-14.8 14.8z"}),l("path",{fill:"#34A853",d:"M13.4 44.3c0-8.2 6.6-14.8 14.8-14.8h1.3v28.2c0 .7-.6 1.3-1.3 1.3-8.2 0-14.8-6.6-14.8-14.8z"})]})]})}),"GooglePhotosIcon"),uo=o(()=>l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("g",{fillRule:"nonzero",fill:"none",children:[l("path",{d:"M6.663 22.284l.97 1.62c.202.34.492.609.832.804l3.465-5.798H5c0 .378.1.755.302 1.096l1.361 2.278z",fill:"#0066DA"}),l("path",{d:"M16 12.09l-3.465-5.798c-.34.195-.63.463-.832.804l-6.4 10.718A2.15 2.15 0 005 18.91h6.93L16 12.09z",fill:"#00AC47"}),l("path",{d:"M23.535 24.708c.34-.195.63-.463.832-.804l.403-.67 1.928-3.228c.201-.34.302-.718.302-1.096h-6.93l1.474 2.802 1.991 2.996z",fill:"#EA4335"}),l("path",{d:"M16 12.09l3.465-5.798A2.274 2.274 0 0018.331 6h-4.662c-.403 0-.794.11-1.134.292L16 12.09z",fill:"#00832D"}),l("path",{d:"M20.07 18.91h-8.14l-3.465 5.798c.34.195.73.292 1.134.292h12.802c.403 0 .794-.11 1.134-.292L20.07 18.91z",fill:"#2684FC"}),l("path",{d:"M23.497 12.455l-3.2-5.359a2.252 2.252 0 00-.832-.804L16 12.09l4.07 6.82h6.917c0-.377-.1-.755-.302-1.096l-3.188-5.359z",fill:"#FFBA00"})]})}),"GoogleDriveIcon");function Iv(i,e){let[t,r]=Xe();Ne(()=>{(async()=>r(await i.getItem(e)))()},[e,i]);let s=Ye(async n=>(r(n),n==null?i.removeItem(e):i.setItem(e,n)),[e,i]);return[t,s]}o(Iv,"useStore");function Ei({uppy:i,i18n:e,clientId:t,onFilesPicked:r,pickerType:s,apiKey:n,appId:a,storage:u}){let[c,p]=Xe(!1),[g,h]=Iv(u,`uppy:google-${s}-picker:accessToken`),b=it(),P=it(g),F=it(!1),M=Ye(U=>{i.log("Access token updated"),h(U),P.current=U},[h,i]);Ne(()=>{P.current=g},[g]);let C=Ye(async U=>{let A=g,J=o(async G=>{if(s==="drive")await kp({token:G,apiKey:n,appId:a,onFilesPicked:r,signal:U});else{let W=o(K=>{b.current=K},"onPickingSessionChange");await Ep({token:G,pickingSession:b.current,onPickingSessionChange:W,signal:U})}},"doShowPicker");p(!0);try{try{if(await _p(s),A==null&&(A=await Kn({clientId:t,pickerType:s})),A==null)throw new Error;await J(A),F.current=!0,M(A)}catch(G){if(G instanceof Gi)i.log("Token is invalid or expired, reauthenticating"),A=await Kn({pickerType:s,accessToken:A,clientId:t}),await J(A),F.current=!0,M(A);else throw G}}catch(G){G instanceof Error&&"type"in G&&G.type==="popup_closed"||(M(null),i.log(G))}finally{p(!1)}},[g,n,a,t,r,s,M,i]);Ne(()=>{let U=new AbortController;return Fp({pickingSessionRef:b,accessTokenRef:P,signal:U.signal,onFilesPicked:r,onError:o(A=>i.log(A),"onError")}),()=>U.abort()},[r,i]),Ne(()=>{if(g===void 0||F.current)return;let U=new AbortController;return C(U.signal),()=>{F.current||U.abort()}},[g,C]);let O=Ye(async()=>{g&&(await Pp(g),M(null),b.current=void 0)},[g,M]);return c?l("div",{children:[e("pleaseWait"),"..."]}):g==null?l(Vr,{pluginName:e(s==="drive"?"pluginNameGoogleDrivePicker":"pluginNameGooglePhotosPicker"),pluginIcon:s==="drive"?uo:lo,handleAuth:C,i18n:e,loading:c}):l("div",{style:{textAlign:"center"},children:[l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary",style:{display:"block",marginBottom:"1em"},disabled:c,onClick:o(()=>C(),"onClick"),children:e(s==="drive"?"pickFiles":"pickPhotos")}),l("button",{type:"button",className:"uppy-u-reset uppy-c-btn",disabled:c,onClick:O,children:e("logOut")})]})}o(Ei,"GooglePickerView");function $r(i){return{...i,type:i.mimeType,extension:i.name?Rt(i.name).extension:null}}o($r,"remoteFileObjToLocal");var Vp=de(ot(),1);var po={name:"@uppy/provider-views",description:"View library for Uppy remote provider plugins.",version:"4.5.3",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",classnames:"^2.2.6",nanoid:"^5.0.9","p-queue":"^8.0.0",preact:"^10.5.13"},devDependencies:{"@types/gapi":"^0.0.47","@types/google.accounts":"^0.0.14","@types/google.picker":"^0.0.42",cssnano:"^7.0.7",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"workspace:^"}};var Mv={position:"relative",width:"100%",minHeight:"100%"},Lv={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};function Wr({data:i,rowHeight:e,renderRow:t,overscanCount:r=10,padding:s=4,...n}){let a=it(null),[u,c]=Xe(0),[p,g]=Xe(0);Ne(()=>{function U(){a.current!=null&&p!==a.current.offsetHeight&&g(a.current.offsetHeight)}return o(U,"resize"),U(),window.addEventListener("resize",U),()=>{window.removeEventListener("resize",U)}},[p]);let h=Ye(()=>{a.current&&c(a.current.scrollTop)},[]),b=Math.floor(u/e),P=Math.floor(p/e);r&&(b=Math.max(0,b-b%r),P+=r);let F=b+P+s,M=i.slice(b,F),C={...Mv,height:i.length*e},O={...Lv,top:b*e};return l("div",{onScroll:h,ref:a,...n,children:l("div",{role:"presentation",style:C,children:l("div",{role:"presentation",style:O,children:M.map(t)})})})}o(Wr,"VirtualList");var Cp=de(ot(),1);function Bv(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:11,height:14.5,viewBox:"0 0 44 58",children:l("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"})})}o(Bv,"FileIcon");function jv(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",style:{minWidth:16,marginRight:3},viewBox:"0 0 276.157 276.157",children:l("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"})})}o(jv,"FolderIcon");function zv(){return l("svg",{"aria-hidden":"true",focusable:"false",style:{width:16,marginRight:4},viewBox:"0 0 58 58",children:[l("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),l("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"})]})}o(zv,"VideoIcon");function Ki({itemIconString:i,alt:e=void 0}){if(i===null)return null;switch(i){case"file":return l(Bv,{});case"folder":return l(jv,{});case"video":return l(zv,{});default:return l("img",{src:i,alt:e,referrerPolicy:"no-referrer",loading:"lazy",width:16,height:16})}}o(Ki,"ItemIcon");function Hv({file:i,toggleCheckbox:e,className:t,isDisabled:r,restrictionError:s,showTitles:n,children:a=null,i18n:u}){return l("li",{className:t,title:r&&s?s:void 0,children:[l("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox uppy-ProviderBrowserItem-checkbox--grid",onChange:e,name:"listitem",id:i.id,checked:i.status==="checked",disabled:r,"data-uppy-super-focusable":!0}),l("label",{htmlFor:i.id,"aria-label":i.data.name??u("unnamed"),className:"uppy-u-reset uppy-ProviderBrowserItem-inner",children:[l(Ki,{itemIconString:i.data.thumbnail||i.data.icon}),n&&(i.data.name??u("unnamed")),a]})]})}o(Hv,"GridItem");var Xn=Hv;function Yn({file:i,openFolder:e,className:t,isDisabled:r,restrictionError:s,toggleCheckbox:n,showTitles:a,i18n:u}){return l("li",{className:t,title:i.status!=="checked"&&s?s:void 0,children:[l("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox",onChange:n,name:"listitem",id:i.id,checked:i.status==="checked","aria-label":i.data.isFolder?u("allFilesFromFolderNamed",{name:i.data.name??u("unnamed")}):null,disabled:r,"data-uppy-super-focusable":!0}),i.data.isFolder?l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowserItem-inner",onClick:o(()=>e(i.id),"onClick"),"aria-label":u("openFolderNamed",{name:i.data.name??u("unnamed")}),children:[l("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:l(Ki,{itemIconString:i.data.icon})}),a&&i.data.name?l("span",{children:i.data.name}):u("unnamed")]}):l("label",{htmlFor:i.id,className:"uppy-u-reset uppy-ProviderBrowserItem-inner",children:[l("div",{className:"uppy-ProviderBrowserItem-iconWrap",children:l(Ki,{itemIconString:i.data.icon})}),a&&(i.data.name??u("unnamed"))]})]})}o(Yn,"ListItem");function Jn(i){let{viewType:e,toggleCheckbox:t,showTitles:r,i18n:s,openFolder:n,file:a,utmSource:u}=i,c=a.type==="folder"?null:a.restrictionError,p=!!c&&a.status!=="checked",g={file:a,openFolder:n,toggleCheckbox:t,utmSource:u,i18n:s,viewType:e,showTitles:r,className:(0,Cp.default)("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--disabled":p},{"uppy-ProviderBrowserItem--noPreview":a.data.icon==="video"},{"uppy-ProviderBrowserItem--is-checked":a.status==="checked"},{"uppy-ProviderBrowserItem--is-partial":a.status==="partial"}),isDisabled:p,restrictionError:c};switch(e){case"grid":return l(Xn,{...g});case"list":return l(Yn,{...g});case"unsplash":return l(Xn,{...g,children:l("a",{href:`${a.data.author.url}?utm_source=${u}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",className:"uppy-ProviderBrowserItem-author",tabIndex:-1,children:a.data.author.name})});default:throw new Error(`There is no such type ${e}`)}}o(Jn,"Item");function qv(i){let{displayedPartialTree:e,viewType:t,toggleCheckbox:r,handleScroll:s,showTitles:n,i18n:a,isLoading:u,openFolder:c,noResultsLabel:p,virtualList:g,utmSource:h}=i,[b,P]=Xe(!1);if(Ne(()=>{let M=o(O=>{O.key==="Shift"&&P(!1)},"handleKeyUp"),C=o(O=>{O.key==="Shift"&&P(!0)},"handleKeyDown");return document.addEventListener("keyup",M),document.addEventListener("keydown",C),()=>{document.removeEventListener("keyup",M),document.removeEventListener("keydown",C)}},[]),u)return l("div",{className:"uppy-Provider-loading",children:typeof u=="string"?u:a("loading")});if(e.length===0)return l("div",{className:"uppy-Provider-empty",children:p});let F=o(M=>l(Jn,{viewType:t,toggleCheckbox:o(C=>{C.stopPropagation(),C.preventDefault(),document.getSelection()?.removeAllRanges(),r(M,b)},"toggleCheckbox"),showTitles:n,i18n:a,openFolder:c,file:M,utmSource:h},M.id),"renderItem");return g?l("div",{className:"uppy-ProviderBrowser-body",children:l(Wr,{className:"uppy-ProviderBrowser-list",data:e,renderRow:F,rowHeight:35.5})}):l("div",{className:"uppy-ProviderBrowser-body",children:l("ul",{className:"uppy-ProviderBrowser-list",onScroll:s,tabIndex:-1,children:e.map(F)})})}o(qv,"Browser");var ho=qv;var Tp=de(ot(),1);var Vv=o(i=>i.filter(t=>t.type==="file"&&t.status==="checked"?!0:t.type==="folder"&&t.status==="checked"?!i.some(s=>s.type!=="root"&&s.parentId===t.id):!1).length,"getNumberOfSelectedFiles"),fo=Vv;function Gr({cancelSelection:i,donePicking:e,i18n:t,partialTree:r,validateAggregateRestrictions:s}){let n=Qt(()=>s(r),[r,s]),a=Qt(()=>fo(r),[r]);return a===0?null:l("div",{className:"uppy-ProviderBrowser-footer",children:[l("div",{className:"uppy-ProviderBrowser-footer-buttons",children:[l("button",{className:(0,Tp.default)("uppy-u-reset uppy-c-btn uppy-c-btn-primary",{"uppy-c-btn--disabled":n}),disabled:!!n,onClick:e,type:"button",children:t("selectX",{smart_count:a})}),l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onClick:i,type:"button",children:t("cancel")})]}),n&&l("div",{className:"uppy-ProviderBrowser-footer-error",children:n})]})}o(Gr,"FooterActions");function $v({searchString:i,setSearchString:e,submitSearchString:t,wrapperClassName:r,inputClassName:s,inputLabel:n,clearSearchLabel:a="",showButton:u=!1,buttonLabel:c="",buttonCSSClassName:p=""}){let g=o(P=>{e(P.target.value)},"onInput"),h=Ye(P=>{P.preventDefault(),t()},[t]),[b]=Xe(()=>{let P=document.createElement("form");return P.setAttribute("tabindex","-1"),P.id=wt(),P});return Ne(()=>(document.body.appendChild(b),b.addEventListener("submit",h),()=>{b.removeEventListener("submit",h),document.body.removeChild(b)}),[b,h]),l("section",{className:r,children:[l("input",{className:`uppy-u-reset ${s}`,type:"search","aria-label":n,placeholder:n,value:i,onInput:g,form:b.id,"data-uppy-super-focusable":!0}),!u&&l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-ProviderBrowser-searchFilterIcon",width:"12",height:"12",viewBox:"0 0 12 12",children:l("path",{d:"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z"})}),!u&&i&&l("button",{className:"uppy-u-reset uppy-ProviderBrowser-searchFilterReset",type:"button","aria-label":a,title:a,onClick:o(()=>e(""),"onClick"),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",viewBox:"0 0 19 19",children:l("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"})})}),u&&l("button",{className:`uppy-u-reset uppy-c-btn uppy-c-btn-primary ${p}`,type:"submit",form:b.id,children:c})]})}o($v,"SearchInput");var Fi=$v;var Wv=o((i,e,t)=>({id:i.id,source:e.id,name:i.name||i.id,type:i.mimeType,isRemote:!0,data:i,preview:i.thumbnail||void 0,meta:{authorName:i.author?.name,authorUrl:i.author?.url,relativePath:i.relDirPath||null,absolutePath:i.absDirPath},body:{fileId:i.id},remote:{companionUrl:e.opts.companionUrl,url:`${t.fileUrl(i.requestPath)}`,body:{fileId:i.id},providerName:t.name,provider:t.provider,requestClientId:t.provider}}),"getTagFile"),Ap=Wv;var Gv=o((i,e,t)=>{let r=i.map(a=>Ap(a,e,t)),s=[],n=[];r.forEach(a=>{e.uppy.checkIfFileAlreadyExists(io(a,e.uppy.getID()))?n.push(a):s.push(a)}),s.length>0&&e.uppy.info(e.uppy.i18n("addedNumFiles",{numFiles:s.length})),n.length>0&&e.uppy.info(`Not adding ${n.length} files because they already exist`),e.uppy.addFiles(s)},"addFiles"),mo=Gv;var Kv=o((i,e,t,r)=>{let s=e.findIndex(n=>n.id===r);if(s!==-1&&t){let n=e.findIndex(u=>u.id===i);return e.slice(Math.min(s,n),Math.max(s,n)+1).map(u=>u.id)}return[i]},"getClickedRange"),go=Kv;var Xv=o(i=>e=>{if(!e.isAuthError){if(e.name==="AbortError"){i.log("Aborting request","warning");return}i.log(e,"error"),e.name==="UserFacingApiError"&&i.info({message:i.i18n("companionError"),details:i.i18n(e.message)},"warning",5e3)}},"handleError"),zt=Xv;var Yv=o((i,e)=>{let t=i.find(s=>s.id===e),r=[];for(;r=[t,...r],t.type!=="root";){let s=t.parentId;t=i.find(n=>n.id===s)}return r},"getBreadcrumbs"),Rp=Yv;var Op=o((i,e,t)=>{let r=e===null?"null":e;if(t[r])return t[r];let s=i.find(a=>a.id===e);if(s.type==="root")return[];let n=[...Op(i,s.parentId,t),s];return t[r]=n,n},"getPath"),Jv=o(i=>{let e=Object.create(null);return i.filter(s=>s.type==="file"&&s.status==="checked").map(s=>{let n=Op(i,s.id,e),a=n.findIndex(g=>g.type==="folder"&&g.status==="checked"),u=n.slice(a),c=`/${n.map(g=>g.data.name).join("/")}`,p=u.length===1?void 0:u.map(g=>g.data.name).join("/");return{...s.data,absDirPath:c,relDirPath:p}})},"getCheckedFilesWithPaths"),yo=Jv;var Zn=de(Dp(),1);var Xr=class extends Error{static{o(this,"TimeoutError")}constructor(e){super(e),this.name="TimeoutError"}},ea=class extends Error{static{o(this,"AbortError")}constructor(e){super(),this.name="AbortError",this.message=e}},Ip=o(i=>globalThis.DOMException===void 0?new ea(i):new DOMException(i),"getDOMException"),Np=o(i=>{let e=i.reason===void 0?Ip("This operation was aborted."):i.reason;return e instanceof Error?e:Ip(e)},"getAbortedReason");function ta(i,e){let{milliseconds:t,fallback:r,message:s,customTimers:n={setTimeout,clearTimeout}}=e,a,c=new Promise((p,g)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(e.signal){let{signal:b}=e;b.aborted&&g(Np(b)),b.addEventListener("abort",()=>{g(Np(b))})}if(t===Number.POSITIVE_INFINITY){i.then(p,g);return}let h=new Xr;a=n.setTimeout.call(void 0,()=>{if(r){try{p(r())}catch(b){g(b)}return}typeof i.cancel=="function"&&i.cancel(),s===!1?p():s instanceof Error?g(s):(h.message=s??`Promise timed out after ${t} milliseconds`,g(h))},t),(async()=>{try{p(await i)}catch(b){g(b)}})()}).finally(()=>{c.clear()});return c.clear=()=>{n.clearTimeout.call(void 0,a),a=void 0},c}o(ta,"pTimeout");function ia(i,e,t){let r=0,s=i.length;for(;s>0;){let n=Math.trunc(s/2),a=r+n;t(i[a],e)<=0?(r=++a,s-=n+1):s=n}return r}o(ia,"lowerBound");var Yr=class{static{o(this,"PriorityQueue")}#e=[];enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,id:t.id,run:e};if(this.size===0||this.#e[this.size-1].priority>=t.priority){this.#e.push(r);return}let s=ia(this.#e,r,(n,a)=>a.priority-n.priority);this.#e.splice(s,0,r)}setPriority(e,t){let r=this.#e.findIndex(n=>n.id===e);if(r===-1)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);let[s]=this.#e.splice(r,1);this.enqueue(s.run,{priority:t,id:e})}dequeue(){return this.#e.shift()?.run}filter(e){return this.#e.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this.#e.length}};var Jr=class extends Zn.default{static{o(this,"PQueue")}#e;#t;#r=0;#i;#s;#a=0;#o;#l;#n;#p;#c=0;#d;#u;#h;#f=1n;timeout;constructor(e){if(super(),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Yr,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#e=e.carryoverConcurrencyCount,this.#t=e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,this.#i=e.intervalCap,this.#s=e.interval,this.#n=new e.queueClass,this.#p=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#h=e.throwOnTimeout===!0,this.#u=e.autoStart===!1}get#m(){return this.#t||this.#r<this.#i}get#y(){return this.#c<this.#d}#g(){this.#c--,this.#w(),this.emit("next")}#v(){this.#x(),this.#b(),this.#l=void 0}get#P(){let e=Date.now();if(this.#o===void 0){let t=this.#a-e;if(t<0)this.#r=this.#e?this.#c:0;else return this.#l===void 0&&(this.#l=setTimeout(()=>{this.#v()},t)),!0}return!1}#w(){if(this.#n.size===0)return this.#o&&clearInterval(this.#o),this.#o=void 0,this.emit("empty"),this.#c===0&&this.emit("idle"),!1;if(!this.#u){let e=!this.#P;if(this.#m&&this.#y){let t=this.#n.dequeue();return t?(this.emit("active"),t(),e&&this.#b(),!0):!1}}return!1}#b(){this.#t||this.#o!==void 0||(this.#o=setInterval(()=>{this.#x()},this.#s),this.#a=Date.now()+this.#s)}#x(){this.#r===0&&this.#c===0&&this.#o&&(clearInterval(this.#o),this.#o=void 0),this.#r=this.#e?this.#c:0,this.#S()}#S(){for(;this.#w(););}get concurrency(){return this.#d}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#d=e,this.#S()}async#E(e){return new Promise((t,r)=>{e.addEventListener("abort",()=>{r(e.reason)},{once:!0})})}setPriority(e,t){this.#n.setPriority(e,t)}async add(e,t={}){return t.id??=(this.#f++).toString(),t={timeout:this.timeout,throwOnTimeout:this.#h,...t},new Promise((r,s)=>{this.#n.enqueue(async()=>{this.#c++,this.#r++;try{t.signal?.throwIfAborted();let n=e({signal:t.signal});t.timeout&&(n=ta(Promise.resolve(n),{milliseconds:t.timeout})),t.signal&&(n=Promise.race([n,this.#E(t.signal)]));let a=await n;r(a),this.emit("completed",a)}catch(n){if(n instanceof Xr&&!t.throwOnTimeout){r();return}s(n),this.emit("error",n)}finally{this.#g()}},t),this.emit("add"),this.#w()})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return this.#u?(this.#u=!1,this.#S(),this):this}pause(){this.#u=!0}clear(){this.#n=new this.#p}async onEmpty(){this.#n.size!==0&&await this.#_("empty")}async onSizeLessThan(e){this.#n.size<e||await this.#_("next",()=>this.#n.size<e)}async onIdle(){this.#c===0&&this.#n.size===0||await this.#_("idle")}async#_(e,t){return new Promise(r=>{let s=o(()=>{t&&!t()||(this.off(e,s),r())},"listener");this.on(e,s)})}get size(){return this.#n.size}sizeBy(e){return this.#n.filter(e).length}get pending(){return this.#c}get isPaused(){return this.#u}};var e0=o(i=>i.map(e=>({...e})),"shallowClone"),bo=e0;var Mp=o(async(i,e,t,r,s)=>{let n=[],a=t.cached?t.nextPagePath:t.id;for(;a;){let h=await r(a);n=n.concat(h.items),a=h.nextPagePath}let u=n.filter(h=>h.isFolder===!0),c=n.filter(h=>h.isFolder===!1),p=u.map(h=>({type:"folder",id:h.requestPath,cached:!1,nextPagePath:null,status:"checked",parentId:t.id,data:h})),g=c.map(h=>{let b=s(h);return{type:"file",id:h.requestPath,restrictionError:b,status:b?"unchecked":"checked",parentId:t.id,data:h}});t.cached=!0,t.nextPagePath=null,e.push(...g,...p),p.forEach(async h=>{i.add(()=>Mp(i,e,h,r,s))})},"recursivelyFetch"),t0=o(async(i,e,t,r)=>{let s=new Jr({concurrency:6}),n=bo(i);return n.filter(u=>u.type==="folder"&&u.status==="checked"&&(u.cached===!1||u.nextPagePath)).forEach(u=>{s.add(()=>Mp(s,n,u,e,t))}),s.on("completed",()=>{let u=n.filter(c=>c.type==="file"&&c.status==="checked").length;r(u)}),await s.onIdle(),n},"afterFill"),Lp=t0;var i0=o((i,e,t,r,s)=>{let n=e.filter(P=>P.isFolder===!0),a=e.filter(P=>P.isFolder===!1),u=t.type==="folder"&&t.status==="checked",c=n.map(P=>({type:"folder",id:P.requestPath,cached:!1,nextPagePath:null,status:u?"checked":"unchecked",parentId:t.id,data:P})),p=a.map(P=>{let F=s(P);return{type:"file",id:P.requestPath,restrictionError:F,status:u&&!F?"checked":"unchecked",parentId:t.id,data:P}}),g={...t,cached:!0,nextPagePath:r};return[...i.map(P=>P.id===g.id?g:P),...c,...p]},"afterOpenFolder"),Bp=i0;var r0=o((i,e,t,r,s)=>{let n=i.find(F=>F.id===e),a=t.filter(F=>F.isFolder===!0),u=t.filter(F=>F.isFolder===!1),c={...n,nextPagePath:r},p=i.map(F=>F.id===c.id?c:F),g=c.type==="folder"&&c.status==="checked",h=a.map(F=>({type:"folder",id:F.requestPath,cached:!1,nextPagePath:null,status:g?"checked":"unchecked",parentId:c.id,data:F})),b=u.map(F=>{let M=s(F);return{type:"file",id:F.requestPath,restrictionError:M,status:g&&!M?"checked":"unchecked",parentId:c.id,data:F}});return[...p,...h,...b]},"afterScrollFolder"),jp=r0;var ra=o((i,e,t)=>{i.filter(s=>s.type!=="root"&&s.parentId===e).forEach(s=>{s.status=t&&!(s.type==="file"&&s.restrictionError)?"checked":"unchecked",ra(i,s.id,t)})},"percolateDown"),sa=o((i,e)=>{let t=i.find(a=>a.id===e);if(t.type==="root")return;let r=i.filter(a=>a.type!=="root"&&a.parentId===t.id&&!(a.type==="file"&&a.restrictionError)),s=r.every(a=>a.status==="checked"),n=r.every(a=>a.status==="unchecked");s?t.status="checked":n?t.status="unchecked":t.status="partial",sa(i,t.parentId)},"percolateUp"),s0=o((i,e)=>{let t=bo(i);if(e.length>=2){let r=t.filter(s=>s.type!=="root"&&e.includes(s.id));r.forEach(s=>{s.type==="file"?s.status=s.restrictionError?"unchecked":"checked":s.status="checked"}),r.forEach(s=>{ra(t,s.id,!0)}),sa(t,r[0].parentId)}else{let r=t.find(s=>s.id===e[0]);r.status=r.status==="checked"?"unchecked":"checked",ra(t,r.id,r.status==="checked"),sa(t,r.parentId)}return t},"afterToggleCheckbox"),zp=s0;var Ci={afterOpenFolder:Bp,afterScrollFolder:jp,afterToggleCheckbox:zp,afterFill:Lp};var o0=o(i=>{let{scrollHeight:e,scrollTop:t,offsetHeight:r}=i.target;return e-(t+r)<50},"shouldHandleScroll"),wo=o0;var Hp=de(ot(),1);function oa(i){let{openFolder:e,title:t,breadcrumbsIcon:r,breadcrumbs:s,i18n:n}=i;return l("div",{className:"uppy-Provider-breadcrumbs",children:[l("div",{className:"uppy-Provider-breadcrumbsIcon",children:r}),s.map((a,u)=>l(_e,{children:[l("button",{type:"button",className:"uppy-u-reset uppy-c-btn",onClick:o(()=>e(a.id),"onClick"),children:a.type==="root"?t:a.data.name??n("unnamed")},a.id),s.length===u+1?"":" / "]}))]})}o(oa,"Breadcrumbs");function na({i18n:i,logout:e,username:t}){return l(_e,{children:[t&&l("span",{className:"uppy-ProviderBrowser-user",children:t},"username"),l("button",{type:"button",onClick:e,className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowser-userLogout",children:i("logOut")},"logout")]})}o(na,"User");function aa(i){return l("div",{className:"uppy-ProviderBrowser-header",children:l("div",{className:(0,Hp.default)("uppy-ProviderBrowser-headerBar",!i.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple"),children:[i.showBreadcrumbs&&l(oa,{openFolder:i.openFolder,breadcrumbs:i.breadcrumbs,breadcrumbsIcon:i.pluginIcon?.(),title:i.title,i18n:i.i18n}),l(na,{logout:i.logout,username:i.username,i18n:i.i18n})]})})}o(aa,"Header");function Xi(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:l("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}o(Xi,"defaultPickerIcon");var qp=o(i=>({authenticated:void 0,partialTree:[{type:"root",id:i,cached:!1,nextPagePath:null}],currentFolderId:i,searchString:"",didFirstRender:!1,username:null,loading:!1}),"getDefaultState"),Me=class{static{o(this,"ProviderView")}static VERSION=po.version;plugin;provider;opts;isHandlingScroll=!1;lastCheckbox=null;constructor(e,t){this.plugin=e,this.provider=t.provider;let r={viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0,loadAllFiles:!1,virtualList:!1};this.opts={...r,...t},this.openFolder=this.openFolder.bind(this),this.logout=this.logout.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleScroll=this.handleScroll.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.cancelSelection=this.cancelSelection.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.resetPluginState(),this.plugin.uppy.on("dashboard:close-panel",this.resetPluginState),this.plugin.uppy.registerRequestClient(this.provider.provider,this.provider)}resetPluginState(){this.plugin.setPluginState(qp(this.plugin.rootFolderId))}tearDown(){}setLoading(e){this.plugin.setPluginState({loading:e})}cancelSelection(){let{partialTree:e}=this.plugin.getPluginState(),t=e.map(r=>r.type==="root"?r:{...r,status:"unchecked"});this.plugin.setPluginState({partialTree:t})}#e;async#t(e){this.#e?.abort();let t=new AbortController;this.#e=t;let r=o(()=>{t.abort()},"cancelRequest");try{this.plugin.uppy.on("dashboard:close-panel",r),this.plugin.uppy.on("cancel-all",r),await e(t.signal)}finally{this.plugin.uppy.off("dashboard:close-panel",r),this.plugin.uppy.off("cancel-all",r),this.#e=void 0}}async openFolder(e){this.lastCheckbox=null;let{partialTree:t}=this.plugin.getPluginState(),r=t.find(s=>s.id===e);if(r.cached){this.plugin.setPluginState({currentFolderId:e,searchString:""});return}this.setLoading(!0),await this.#t(async s=>{let n=e,a=[];do{let{username:c,nextPagePath:p,items:g}=await this.provider.list(n,{signal:s});this.plugin.setPluginState({username:c}),n=p,a=a.concat(g),this.setLoading(this.plugin.uppy.i18n("loadedXFiles",{numFiles:a.length}))}while(this.opts.loadAllFiles&&n);let u=Ci.afterOpenFolder(t,a,r,n,this.validateSingleFile);this.plugin.setPluginState({partialTree:u,currentFolderId:e,searchString:""})}).catch(zt(this.plugin.uppy)),this.setLoading(!1)}async logout(){await this.#t(async e=>{let t=await this.provider.logout({signal:e});if(t.ok){if(!t.revoked){let r=this.plugin.uppy.i18n("companionUnauthorizeHint",{provider:this.plugin.title,url:t.manual_revoke_url});this.plugin.uppy.info(r,"info",7e3)}this.plugin.setPluginState({...qp(this.plugin.rootFolderId),authenticated:!1})}}).catch(zt(this.plugin.uppy))}async handleAuth(e){await this.#t(async t=>{this.setLoading(!0),await this.provider.login({authFormData:e,signal:t}),this.plugin.setPluginState({authenticated:!0}),await Promise.all([this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId)])}).catch(zt(this.plugin.uppy)),this.setLoading(!1)}async handleScroll(e){let{partialTree:t,currentFolderId:r}=this.plugin.getPluginState(),s=t.find(n=>n.id===r);wo(e)&&!this.isHandlingScroll&&s.nextPagePath&&(this.isHandlingScroll=!0,await this.#t(async n=>{let{nextPagePath:a,items:u}=await this.provider.list(s.nextPagePath,{signal:n}),c=Ci.afterScrollFolder(t,r,u,a,this.validateSingleFile);this.plugin.setPluginState({partialTree:c})}).catch(zt(this.plugin.uppy)),this.isHandlingScroll=!1)}validateSingleFile=o(e=>{let t=$r(e);return this.plugin.uppy.validateSingleFile(t)},"validateSingleFile");async donePicking(){let{partialTree:e}=this.plugin.getPluginState();this.setLoading(!0),await this.#t(async t=>{let r=await Ci.afterFill(e,a=>this.provider.list(a,{signal:t}),this.validateSingleFile,a=>{this.setLoading(this.plugin.uppy.i18n("addedNumFiles",{numFiles:a}))});if(this.validateAggregateRestrictions(r)){this.plugin.setPluginState({partialTree:r});return}let n=yo(r);mo(n,this.plugin,this.provider),this.resetPluginState()}).catch(zt(this.plugin.uppy)),this.setLoading(!1)}toggleCheckbox(e,t){let{partialTree:r}=this.plugin.getPluginState(),s=go(e.id,this.getDisplayedPartialTree(),t,this.lastCheckbox),n=Ci.afterToggleCheckbox(r,s);this.plugin.setPluginState({partialTree:n}),this.lastCheckbox=e.id}getDisplayedPartialTree=o(()=>{let{partialTree:e,currentFolderId:t,searchString:r}=this.plugin.getPluginState(),s=e.filter(a=>a.type!=="root"&&a.parentId===t);return r===""?s:s.filter(a=>(a.data.name??this.plugin.uppy.i18n("unnamed")).toLowerCase().indexOf(r.toLowerCase())!==-1)},"getDisplayedPartialTree");getBreadcrumbs=o(()=>{let{partialTree:e,currentFolderId:t}=this.plugin.getPluginState();return Rp(e,t)},"getBreadcrumbs");getSelectedAmount=o(()=>{let{partialTree:e}=this.plugin.getPluginState();return fo(e)},"getSelectedAmount");validateAggregateRestrictions=o(e=>{let r=e.filter(s=>s.type==="file"&&s.status==="checked").map(s=>s.data);return this.plugin.uppy.validateAggregateRestrictions(r)},"validateAggregateRestrictions");render(e,t={}){let{didFirstRender:r}=this.plugin.getPluginState(),{i18n:s}=this.plugin.uppy;r||(this.plugin.setPluginState({didFirstRender:!0}),this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId));let n={...this.opts,...t},{authenticated:a,loading:u}=this.plugin.getPluginState(),c=this.plugin.icon||Xi;if(a===!1)return l(Vr,{pluginName:this.plugin.title,pluginIcon:c,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,renderForm:n.renderAuthForm,loading:u});let{partialTree:p,username:g,searchString:h}=this.plugin.getPluginState(),b=this.getBreadcrumbs();return l("div",{className:(0,Vp.default)("uppy-ProviderBrowser",`uppy-ProviderBrowser-viewType--${n.viewType}`),children:[l(aa,{showBreadcrumbs:n.showBreadcrumbs,openFolder:this.openFolder,breadcrumbs:b,pluginIcon:c,title:this.plugin.title,logout:this.logout,username:g,i18n:s}),n.showFilter&&l(Fi,{searchString:h,setSearchString:o(P=>{this.plugin.setPluginState({searchString:P})},"setSearchString"),submitSearchString:o(()=>{},"submitSearchString"),inputLabel:s("filter"),clearSearchLabel:s("resetFilter"),wrapperClassName:"uppy-ProviderBrowser-searchFilter",inputClassName:"uppy-ProviderBrowser-searchFilterInput"}),l(ho,{toggleCheckbox:this.toggleCheckbox,displayedPartialTree:this.getDisplayedPartialTree(),openFolder:this.openFolder,virtualList:n.virtualList,noResultsLabel:s("noFilesFound"),handleScroll:this.handleScroll,viewType:n.viewType,showTitles:n.showTitles,i18n:this.plugin.uppy.i18n,isLoading:u,utmSource:"Companion"}),l(Gr,{partialTree:p,donePicking:this.donePicking,cancelSelection:this.cancelSelection,i18n:s,validateAggregateRestrictions:this.validateAggregateRestrictions})]})}};var $p=de(ot(),1);var n0={loading:!1,searchString:"",partialTree:[{type:"root",id:null,cached:!1,nextPagePath:null}],currentFolderId:null,isInputMode:!0},a0={viewType:"grid",showTitles:!0,showFilter:!0,utmSource:"Companion"},Zt=class{static{o(this,"SearchProviderView")}static VERSION=po.version;plugin;provider;opts;isHandlingScroll=!1;lastCheckbox=null;constructor(e,t){this.plugin=e,this.provider=t.provider,this.opts={...a0,...t},this.setSearchString=this.setSearchString.bind(this),this.search=this.search.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.cancelSelection=this.cancelSelection.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.render=this.render.bind(this),this.resetPluginState(),this.plugin.uppy.on("dashboard:close-panel",this.resetPluginState),this.plugin.uppy.registerRequestClient(this.provider.provider,this.provider)}tearDown(){}setLoading(e){this.plugin.setPluginState({loading:e})}resetPluginState(){this.plugin.setPluginState(n0)}cancelSelection(){let{partialTree:e}=this.plugin.getPluginState(),t=e.map(r=>r.type==="root"?r:{...r,status:"unchecked"});this.plugin.setPluginState({partialTree:t})}async search(){let{searchString:e}=this.plugin.getPluginState();if(e!==""){this.setLoading(!0);try{let t=await this.provider.search(e),r=[{type:"root",id:null,cached:!1,nextPagePath:t.nextPageQuery},...t.items.map(s=>({type:"file",id:s.requestPath,status:"unchecked",parentId:null,data:s}))];this.plugin.setPluginState({partialTree:r,isInputMode:!1})}catch(t){zt(this.plugin.uppy)(t)}this.setLoading(!1)}}async handleScroll(e){let{partialTree:t,searchString:r}=this.plugin.getPluginState(),s=t.find(n=>n.type==="root");if(wo(e)&&!this.isHandlingScroll&&s.nextPagePath){this.isHandlingScroll=!0;try{let n=await this.provider.search(r,s.nextPagePath),a={...s,nextPagePath:n.nextPageQuery},u=t.filter(p=>p.type!=="root"),c=[a,...u,...n.items.map(p=>({type:"file",id:p.requestPath,status:"unchecked",parentId:null,data:p}))];this.plugin.setPluginState({partialTree:c})}catch(n){zt(this.plugin.uppy)(n)}this.isHandlingScroll=!1}}async donePicking(){let{partialTree:e}=this.plugin.getPluginState(),t=yo(e);mo(t,this.plugin,this.provider),this.resetPluginState()}toggleCheckbox(e,t){let{partialTree:r}=this.plugin.getPluginState(),s=go(e.id,this.getDisplayedPartialTree(),t,this.lastCheckbox),n=Ci.afterToggleCheckbox(r,s);this.plugin.setPluginState({partialTree:n}),this.lastCheckbox=e.id}validateSingleFile=o(e=>{let t=$r(e);return this.plugin.uppy.validateSingleFile(t)},"validateSingleFile");getDisplayedPartialTree=o(()=>{let{partialTree:e}=this.plugin.getPluginState();return e.filter(t=>t.type!=="root")},"getDisplayedPartialTree");setSearchString=o(e=>{this.plugin.setPluginState({searchString:e}),e===""&&this.plugin.setPluginState({partialTree:[]})},"setSearchString");validateAggregateRestrictions=o(e=>{let r=e.filter(s=>s.type==="file"&&s.status==="checked").map(s=>s.data);return this.plugin.uppy.validateAggregateRestrictions(r)},"validateAggregateRestrictions");render(e,t={}){let{isInputMode:r,searchString:s,loading:n,partialTree:a}=this.plugin.getPluginState(),{i18n:u}=this.plugin.uppy,c={...this.opts,...t};return r?l(Fi,{searchString:s,setSearchString:this.setSearchString,submitSearchString:this.search,inputLabel:u("enterTextToSearch"),buttonLabel:u("searchImages"),wrapperClassName:"uppy-SearchProvider",inputClassName:"uppy-c-textInput uppy-SearchProvider-input",showButton:!0,buttonCSSClassName:"uppy-SearchProvider-searchButton"}):l("div",{className:(0,$p.default)("uppy-ProviderBrowser",`uppy-ProviderBrowser-viewType--${c.viewType}`),children:[c.showFilter&&l(Fi,{searchString:s,setSearchString:this.setSearchString,submitSearchString:this.search,inputLabel:u("search"),clearSearchLabel:u("resetSearch"),wrapperClassName:"uppy-ProviderBrowser-searchFilter",inputClassName:"uppy-ProviderBrowser-searchFilterInput"}),l(ho,{toggleCheckbox:this.toggleCheckbox,displayedPartialTree:this.getDisplayedPartialTree(),handleScroll:this.handleScroll,openFolder:o(async()=>{},"openFolder"),noResultsLabel:u("noSearchResults"),viewType:c.viewType,showTitles:c.showTitles,isLoading:n,i18n:u,virtualList:!1,utmSource:this.opts.utmSource}),l(Gr,{partialTree:a,donePicking:this.donePicking,cancelSelection:this.cancelSelection,i18n:u,validateAggregateRestrictions:this.validateAggregateRestrictions})]})}};var l0={__proto__:null,"audio/mp3":"mp3","audio/mp4":"mp4","audio/ogg":"ogg","audio/webm":"webm","image/gif":"gif","image/heic":"heic","image/heif":"heif","image/jpeg":"jpg","image/webp":"webp","image/png":"png","image/svg+xml":"svg","video/mp4":"mp4","video/ogg":"ogv","video/quicktime":"mov","video/webm":"webm","video/x-matroska":"mkv","video/x-msvideo":"avi"};function Et(i){return[i]=i.split(";",1),l0[i]||null}o(Et,"getFileTypeExtension");var Wp={name:"@uppy/audio",description:"Uppy plugin that records audio using the device\u2019s microphone.",version:"2.2.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",keywords:["file uploader","uppy","uppy-plugin","audio","microphone","sound","record","mediarecorder"],type:"module",homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",preact:"^10.5.13"},devDependencies:{cssnano:"^7.0.7",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"workspace:^"},publishConfig:{access:"public"},scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"}};var Gp={strings:{pluginNameAudio:"Audio",startAudioRecording:"Begin audio recording",stopAudioRecording:"Stop audio recording",allowAudioAccessTitle:"Please allow access to your microphone",allowAudioAccessDescription:"In order to record audio, please allow microphone access for this site.",noAudioTitle:"Microphone Not Available",noAudioDescription:"In order to record audio, please connect a microphone or another audio input device",recordingStoppedMaxSize:"Recording stopped because the file size is about to exceed the limit",recordingLength:"Recording length %{recording_length}",submitRecordedFile:"Submit recorded file",discardRecordedFile:"Discard recorded file"}};var Kp=o(i=>{let{icon:e,hasAudio:t,i18n:r}=i;return l("div",{className:"uppy-Audio-permissons",children:[l("div",{className:"uppy-Audio-permissonsIcon",children:e()}),l("div",{className:"uppy-Audio-title",children:r(t?"allowAudioAccessTitle":"noAudioTitle")}),l("p",{children:r(t?"allowAudioAccessDescription":"noAudioDescription")})]})},"default");var Xp=o(({currentDeviceId:i,audioSources:e,onChangeSource:t})=>l("div",{className:"uppy-Audio-videoSource",children:l("select",{className:"uppy-u-reset uppy-Audio-audioSource-select",onChange:o(r=>{t(r.target.value)},"onChange"),children:e.map(r=>l("option",{value:r.deviceId,selected:r.deviceId===i,children:r.label},r.deviceId))})}),"default");function Yp(i){return typeof i=="function"}o(Yp,"isFunction");function Qr(i){return Yp(i)?i():i}o(Qr,"result");var Zr=class{static{o(this,"AudioOscilloscope")}canvas;canvasContext;width;height;analyser;bufferLength;dataArray;onDrawFrame;streamSource;audioContext;source;constructor(e,t={}){let r=t.canvas||{},s=t.canvasContext||{};this.analyser=null,this.bufferLength=0,this.canvas=e,this.width=Qr(r.width)||this.canvas.width,this.height=Qr(r.height)||this.canvas.height,this.canvas.width=this.width,this.canvas.height=this.height,this.canvasContext=this.canvas.getContext("2d"),this.canvasContext.fillStyle=Qr(s.fillStyle)||"rgb(255, 255, 255)",this.canvasContext.strokeStyle=Qr(s.strokeStyle)||"rgb(0, 0, 0)",this.canvasContext.lineWidth=Qr(s.lineWidth)||1,this.onDrawFrame=Yp(t.onDrawFrame)?t.onDrawFrame:()=>{}}addSource(e){this.streamSource=e,this.audioContext=this.streamSource.context,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.bufferLength=this.analyser.frequencyBinCount,this.source=this.audioContext.createBufferSource(),this.dataArray=new Uint8Array(this.bufferLength),this.analyser.getByteTimeDomainData(this.dataArray),this.streamSource.connect(this.analyser)}draw(){let{analyser:e,dataArray:t,bufferLength:r}=this,s=this.canvasContext,n=this.width,a=this.height;e&&e.getByteTimeDomainData(t),s.fillRect(0,0,n,a),s.beginPath();let u=n*1/r,c=0;r||s.moveTo(0,this.height/2);for(let p=0;p<r;p++){let h=t[p]/128*(a/2);p===0?s.moveTo(c,h):s.lineTo(c,h),c+=u}s.lineTo(n,a/2),s.stroke(),this.onDrawFrame(this),requestAnimationFrame(this.#e)}#e=o(()=>this.draw(),"#draw")};function c0({onDiscard:i,i18n:e}){return l("button",{className:"uppy-u-reset uppy-c-btn uppy-Audio-button",type:"button",title:e("discardRecordedFile"),"aria-label":e("discardRecordedFile"),onClick:i,"data-uppy-super-focusable":!0,children:l("svg",{width:"13",height:"13",viewBox:"0 0 13 13",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",className:"uppy-c-icon",children:l("g",{fill:"#FFF",fillRule:"evenodd",children:[l("path",{d:"M.496 11.367L11.103.76l1.414 1.414L1.911 12.781z"}),l("path",{d:"M11.104 12.782L.497 2.175 1.911.76l10.607 10.606z"})]})})})}o(c0,"DiscardButton");var Jp=c0;function ua({recording:i,onStartRecording:e,onStopRecording:t,i18n:r}){return i?l("button",{className:"uppy-u-reset uppy-c-btn uppy-Audio-button",type:"button",title:r("stopAudioRecording"),"aria-label":r("stopAudioRecording"),onClick:t,"data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100",children:l("rect",{x:"15",y:"15",width:"70",height:"70"})})}):l("button",{className:"uppy-u-reset uppy-c-btn uppy-Audio-button",type:"button",title:r("startAudioRecording"),"aria-label":r("startAudioRecording"),onClick:e,"data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14px",height:"20px",viewBox:"0 0 14 20",children:l("path",{d:"M7 14c2.21 0 4-1.71 4-3.818V3.818C11 1.71 9.21 0 7 0S3 1.71 3 3.818v6.364C3 12.29 4.79 14 7 14zm6.364-7h-.637a.643.643 0 0 0-.636.65V9.6c0 3.039-2.565 5.477-5.6 5.175-2.645-.264-4.582-2.692-4.582-5.407V7.65c0-.36-.285-.65-.636-.65H.636A.643.643 0 0 0 0 7.65v1.631c0 3.642 2.544 6.888 6.045 7.382v1.387H3.818a.643.643 0 0 0-.636.65v.65c0 .36.285.65.636.65h6.364c.351 0 .636-.29.636-.65v-.65c0-.36-.285-.65-.636-.65H7.955v-1.372C11.363 16.2 14 13.212 14 9.6V7.65c0-.36-.285-.65-.636-.65z",fill:"#FFF","fill-rule":"nonzero"})})})}o(ua,"RecordButton");function ca(i){return`${Math.floor(i/60)}:${String(i%60).padStart(2,"0")}`}o(ca,"formatSeconds");function pa({recordingLengthSeconds:i}){let e=ca(i);return l("span",{children:e})}o(pa,"RecordingLength");function p0({onSubmit:i,i18n:e}){return l("button",{className:"uppy-u-reset uppy-c-btn uppy-Audio-button uppy-Audio-button--submit",type:"button",title:e("submitRecordedFile"),"aria-label":e("submitRecordedFile"),onClick:i,"data-uppy-super-focusable":!0,children:l("svg",{width:"12",height:"9",viewBox:"0 0 12 9",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon",children:l("path",{fill:"#fff",fillRule:"nonzero",d:"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z"})})})}o(p0,"SubmitButton");var Qp=p0;function da(i){let{stream:e,recordedAudio:t,onStop:r,recording:s,supportsRecording:n,audioSources:a,showAudioSourceDropdown:u,onSubmit:c,i18n:p,onStartRecording:g,onStopRecording:h,onDiscardRecordedAudio:b,recordingLengthSeconds:P}=i,F=it(null),M=it();Ne(()=>()=>{M.current=null,r()},[r]),Ne(()=>{if(!t&&(M.current=new Zr(F.current,{canvas:{width:600,height:600},canvasContext:{lineWidth:2,fillStyle:"rgb(0,0,0)",strokeStyle:"green"}}),M.current.draw(),e)){let J=new AudioContext().createMediaStreamSource(e);M.current.addSource(J)}},[t,e]);let C=t!=null,O=!C&&n,U=u&&!C&&a&&a.length>1;return l("div",{className:"uppy-Audio-container",children:[l("div",{className:"uppy-Audio-audioContainer",children:C?l("audio",{className:"uppy-Audio-player",controls:!0,src:t}):l("canvas",{ref:F,className:"uppy-Audio-canvas"})}),l("div",{className:"uppy-Audio-footer",children:[l("div",{className:"uppy-Audio-audioSourceContainer",children:U?Xp(i):null}),l("div",{className:"uppy-Audio-buttonContainer",children:[O&&l(ua,{recording:s,onStartRecording:g,onStopRecording:h,i18n:p}),C&&l(Qp,{onSubmit:c,i18n:p}),C&&l(Jp,{onDiscard:b,i18n:p})]}),l("div",{className:"uppy-Audio-recordingLength",children:!C&&l(pa,{recordingLengthSeconds:P})})]})]})}o(da,"RecordingScreen");function ha(){return typeof MediaRecorder=="function"&&typeof MediaRecorder.prototype?.start=="function"}o(ha,"supportsMediaRecorder");var Yi=class extends Z{static{o(this,"Audio")}static VERSION=Wp.version;#e;icon;#t=null;#r=!1;#i=null;#s=null;#a=null;#o;#l;constructor(e,t){super(e,t),this.#o=navigator.mediaDevices,this.#l=this.#o!=null,this.id=this.opts.id||"Audio",this.type="acquirer",this.icon=()=>l("svg",{className:"uppy-DashboardTab-iconAudio","aria-hidden":"true",focusable:"false",width:"32px",height:"32px",viewBox:"0 0 32 32",children:l("path",{d:"M21.143 12.297c.473 0 .857.383.857.857v2.572c0 3.016-2.24 5.513-5.143 5.931v2.64h2.572a.857.857 0 110 1.714H12.57a.857.857 0 110-1.714h2.572v-2.64C12.24 21.24 10 18.742 10 15.726v-2.572a.857.857 0 111.714 0v2.572A4.29 4.29 0 0016 20.01a4.29 4.29 0 004.286-4.285v-2.572c0-.474.384-.857.857-.857zM16 6.5a3 3 0 013 3v6a3 3 0 01-6 0v-6a3 3 0 013-3z",fill:"currentcolor","fill-rule":"nonzero"})}),this.defaultLocale=Gp,this.opts={...t},this.i18nInit(),this.title=this.i18n("pluginNameAudio"),this.setPluginState({hasAudio:!1,audioReady:!1,cameraError:null,recordingLengthSeconds:0,audioSources:[],currentDeviceId:null})}#n(){return this.#o?this.#o.enumerateDevices().then(e=>e.some(t=>t.kind==="audioinput")):Promise.resolve(!1)}#p=o(e=>{if(!this.#l)return Promise.reject(new Error("Microphone access not supported"));this.#r=!0,this.#n().then(t=>(this.setPluginState({hasAudio:t}),this.#o.getUserMedia({audio:!0}).then(r=>{this.#t=r;let s=null,n=r.getAudioTracks();e?.deviceId?s=n.findLast(a=>a.getSettings().deviceId===e.deviceId):s=n[0].getSettings().deviceId,this.#g(),this.setPluginState({currentDeviceId:s,audioReady:!0})}).catch(r=>{this.setPluginState({audioReady:!1,cameraError:r}),this.uppy.info(r.message,"error")})))},"#start");#c=o(()=>{this.#s=new MediaRecorder(this.#t),this.#i=[];let e=!1;this.#s.addEventListener("dataavailable",t=>{this.#i.push(t.data);let{restrictions:r}=this.uppy.opts;if(this.#i.length>1&&r.maxFileSize!=null&&!e){let s=this.#i.reduce((c,p)=>c+p.size,0),a=(s-this.#i[0].size)/(this.#i.length-1)*3,u=Math.max(0,r.maxFileSize-a);s>u&&(e=!0,this.uppy.info(this.i18n("recordingStoppedMaxSize"),"warning",4e3),this.#d())}}),this.#s.start(500),this.#e=setInterval(()=>{let t=this.getPluginState().recordingLengthSeconds;this.setPluginState({recordingLengthSeconds:t+1})},1e3),this.setPluginState({isRecording:!0})},"#startRecording");#d=o(()=>new Promise(t=>{this.#s.addEventListener("stop",()=>{t()}),this.#s.stop(),clearInterval(this.#e),this.setPluginState({recordingLengthSeconds:0})}).then(()=>(this.setPluginState({isRecording:!1}),this.#m())).then(t=>{try{this.#a=t,this.setPluginState({recordedAudio:URL.createObjectURL(t.data)})}catch(r){r.isRestriction||this.uppy.log(r)}}).then(()=>{this.#i=null,this.#s=null},t=>{throw this.#i=null,this.#s=null,t}),"#stopRecording");#u=o(()=>{this.setPluginState({recordedAudio:null}),this.#a=null},"#discardRecordedAudio");#h=o(()=>{try{this.#a&&this.uppy.addFile(this.#a)}catch(e){e.isRestriction||this.uppy.log(e,"warning")}},"#submit");#f=o(async()=>{this.#t&&this.#t.getAudioTracks().forEach(t=>t.stop()),this.#s&&await new Promise(e=>{this.#s.addEventListener("stop",e,{once:!0}),this.#s.stop(),clearInterval(this.#e)}),this.#i=null,this.#s=null,this.#r=!1,this.#t=null,this.setPluginState({recordedAudio:null,isRecording:!1,recordingLengthSeconds:0})},"#stop");#m(){let e=this.#i.find(a=>a.type?.length>0).type,t=Et(e);if(!t)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type "${e}"`));let r=`audio-${Date.now()}.${t}`,s=new Blob(this.#i,{type:e}),n={source:this.id,name:r,data:new Blob([s],{type:e}),type:e};return Promise.resolve(n)}#y=o(e=>{this.#f(),this.#p({deviceId:e})},"#changeSource");#g=o(()=>{this.#o.enumerateDevices().then(e=>{this.setPluginState({audioSources:e.filter(t=>t.kind==="audioinput")})})},"#updateSources");render(){this.#r||this.#p();let e=this.getPluginState();return!e.audioReady||!e.hasAudio?l(Kp,{icon:this.icon,i18n:this.i18n,hasAudio:e.hasAudio}):l(da,{...e,onChangeSource:this.#y,onStartRecording:this.#c,onStopRecording:this.#d,onDiscardRecordedAudio:this.#u,onSubmit:this.#h,onStop:this.#f,i18n:this.i18n,showAudioSourceDropdown:this.opts.showAudioSourceDropdown,supportsRecording:ha(),recording:e.isRecording,stream:this.#t})}install(){this.setPluginState({audioReady:!1,recordingLengthSeconds:0});let{target:e}=this.opts;e&&this.mount(e,this),this.#o&&(this.#g(),this.#o.ondevicechange=()=>{if(this.#g(),this.#t){let t=!0,{audioSources:r,currentDeviceId:s}=this.getPluginState();r.forEach(n=>{s===n.deviceId&&(t=!1)}),t&&(this.#f(),this.#p())}})}uninstall(){this.#t&&this.#f(),this.unmount()}};var Ht=class{static{o(this,"EventManager")}#e;#t=[];constructor(e){this.#e=e}on(e,t){return this.#t.push([e,t]),this.#e.on(e,t)}remove(){for(let[e,t]of this.#t.splice(0))this.#e.off(e,t)}onFilePause(e,t){this.on("upload-pause",(r,s)=>{e===r?.id&&t(s)})}onFileRemove(e,t){this.on("file-removed",r=>{e===r.id&&t(r.id)})}onPause(e,t){this.on("upload-pause",(r,s)=>{e===r?.id&&t(s)})}onRetry(e,t){this.on("upload-retry",r=>{e===r?.id&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{this.#e.getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{this.#e.getFile(e)&&t()})}onCancelAll(e,t){this.on("cancel-all",(...r)=>{this.#e.getFile(e)&&t(...r)})}onResumeAll(e,t){this.on("resume-all",()=>{this.#e.getFile(e)&&t()})}};var{AbortController:So}=globalThis,{AbortSignal:Zk}=globalThis,xo=o((i="Aborted",e)=>{let t=new DOMException(i,"AbortError");return e!=null&&ft(e,"cause")&&Object.defineProperty(t,"cause",{__proto__:null,configurable:!0,writable:!0,value:e.cause}),t},"createAbortError");function Ji(i){let e=o(t=>"error"in t&&!!t.error,"hasError");return i.filter(t=>!e(t))}o(Ji,"filterNonFailedFiles");function Qi(i){return i.filter(e=>!e.progress?.uploadStarted||!e.isRestored)}o(Qi,"filterFilesToEmitUploadStarted");function qt(i,e){return i===!0?Object.keys(e):Array.isArray(i)?i:[]}o(qt,"getAllowedMetaFields");function d0(i){return new Error("Cancelled",{cause:i})}o(d0,"createCancelError");function Zp(i){if(i!=null){let e=o(()=>this.abort(i.reason),"abortPromise");i.addEventListener("abort",e,{once:!0});let t=o(()=>{i.removeEventListener("abort",e)},"removeAbortListener");this.then?.(t,t)}return this}o(Zp,"abortOn");var xt=class{static{o(this,"RateLimitedQueue")}#e=0;#t=[];#r=!1;#i;#s=1;#a;#o;limit;constructor(e){typeof e!="number"||e===0?this.limit=1/0:this.limit=e}#l(e){this.#e+=1;let t=!1,r;try{r=e()}catch(s){throw this.#e-=1,s}return{abort:o(s=>{t||(t=!0,this.#e-=1,r?.(s),this.#n())},"abort"),done:o(()=>{t||(t=!0,this.#e-=1,this.#n())},"done")}}#n(){queueMicrotask(()=>this.#p())}#p(){if(this.#r||this.#e>=this.limit||this.#t.length===0)return;let e=this.#t.shift();if(e==null)throw new Error("Invariant violation: next is null");let t=this.#l(e.fn);e.abort=t.abort,e.done=t.done}#c(e,t){let r={fn:e,priority:t?.priority||0,abort:o(()=>{this.#d(r)},"abort"),done:o(()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")},"done")},s=this.#t.findIndex(n=>r.priority>n.priority);return s===-1?this.#t.push(r):this.#t.splice(s,0,r),r}#d(e){let t=this.#t.indexOf(e);t!==-1&&this.#t.splice(t,1)}run(e,t){return!this.#r&&this.#e<this.limit?this.#l(e):this.#c(e,t)}wrapSyncFunction(e,t){return(...r)=>{let s=this.run(()=>(e(...r),queueMicrotask(()=>s.done()),()=>{}),t);return{abortOn:Zp,abort(){s.abort()}}}}wrapPromiseFunction(e,t){return(...r)=>{let s,n=new Promise((a,u)=>{s=this.run(()=>{let c,p;try{p=Promise.resolve(e(...r))}catch(g){p=Promise.reject(g)}return p.then(g=>{c?u(c):(s.done(),a(g))},g=>{c?u(c):(s.done(),u(g))}),g=>{c=d0(g)}},t)});return n.abort=a=>{s.abort(a)},n.abortOn=Zp,n}}resume(){this.#r=!1,clearTimeout(this.#i);for(let e=0;e<this.limit;e++)this.#n()}#u=o(()=>this.resume(),"#resume");pause(e=null){this.#r=!0,clearTimeout(this.#i),e!=null&&(this.#i=setTimeout(this.#u,e))}rateLimit(e){clearTimeout(this.#o),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(this.#a=this.limit-1,this.limit=this.#s,this.#o=setTimeout(this.#h,e))}#h=o(()=>{if(this.#r){this.#o=setTimeout(this.#h,0);return}this.#s=this.limit,this.limit=Math.ceil((this.#a+this.#s)/2);for(let e=this.#s;e<=this.limit;e++)this.#n();this.#a-this.#s>3?this.#o=setTimeout(this.#h,2e3):this.#s=Math.floor(this.#s/2)},"#increaseLimit");get isPaused(){return this.#r}},_o=Symbol("__queue");var ed={name:"@uppy/aws-s3",description:"Upload to Amazon S3 with Uppy",version:"4.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","aws s3","amazon s3","s3","uppy","uppy-plugin","multipart"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/utils":"workspace:^"},devDependencies:{"@aws-sdk/client-s3":"^3.362.0","@aws-sdk/s3-request-presigner":"^3.362.0","@uppy/core":"workspace:^",jsdom:"^26.1.0",nock:"^13.1.0",typescript:"^5.8.3",vitest:"^3.2.4","whatwg-fetch":"3.6.2"},peerDependencies:{"@uppy/core":"workspace:^"}};function f0({method:i="PUT",CanonicalUri:e="/",CanonicalQueryString:t="",SignedHeaders:r,HashedPayload:s}){let n=Object.keys(r).map(a=>a.toLowerCase()).sort();return[i,e,t,...n.map(a=>`${a}:${r[a]}`),"",n.join(";"),s].join(`
`)}o(f0,"createCanonicalRequest");var fa=new TextEncoder,ma={name:"HMAC",hash:"SHA-256"};async function m0(i){let{subtle:e}=globalThis.crypto;return e.digest(ma.hash,fa.encode(i))}o(m0,"digest");async function g0(i){let{subtle:e}=globalThis.crypto;return e.importKey("raw",typeof i=="string"?fa.encode(i):i,ma,!1,["sign"])}o(g0,"generateHmacKey");function td(i){let e=new Uint8Array(i),t="";for(let r=0;r<e.length;r++)t+=e[r].toString(16).padStart(2,"0");return t}o(td,"arrayBufferToHexString");async function es(i,e){let{subtle:t}=globalThis.crypto;return t.sign(ma,await g0(i),fa.encode(e))}o(es,"hash");async function ga({accountKey:i,accountSecret:e,sessionToken:t,bucketName:r,Key:s,Region:n,expires:a,uploadId:u,partNumber:c}){let p="s3",g=`${p}.${n}.amazonaws.com`,h=`/${r}/${encodeURI(s).replace(/[;?:@&=+$,#!'()*]/g,Q=>`%${Q.charCodeAt(0).toString(16).toUpperCase()}`)}`,b="UNSIGNED-PAYLOAD",P=new Date().toISOString().replace(/[-:]|\.\d+/g,""),F=P.slice(0,8),M=`${F}/${n}/${p}/aws4_request`,C=new URL(`https://${g}${h}`);C.searchParams.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),C.searchParams.set("X-Amz-Content-Sha256",b),C.searchParams.set("X-Amz-Credential",`${i}/${M}`),C.searchParams.set("X-Amz-Date",P),C.searchParams.set("X-Amz-Expires",a),C.searchParams.set("X-Amz-Security-Token",t),C.searchParams.set("X-Amz-SignedHeaders","host"),c&&C.searchParams.set("partNumber",c),u&&C.searchParams.set("uploadId",u),C.searchParams.set("x-id",c&&u?"UploadPart":"PutObject");let O=f0({CanonicalUri:h,CanonicalQueryString:C.search.slice(1),SignedHeaders:{host:g},HashedPayload:b}),U=td(await m0(O)),A=["AWS4-HMAC-SHA256",P,M,U].join(`
`),J=await es(`AWS4${e}`,F),G=await es(J,n),W=await es(G,p),K=await es(W,"aws4_request"),te=td(await es(K,A));return C.searchParams.set("X-Amz-Signature",te),C}o(ga,"createSignedURL");var y0=1024*1024,id={getChunkSize(i){return Math.ceil(i.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(i){throw i}};function v0(i){if(typeof i=="string")return parseInt(i,10);if(typeof i=="number")return i;throw new TypeError("Expected a number")}o(v0,"ensureInt");var ts=Symbol("pausing upload, not an actual error"),ya=class{static{o(this,"MultipartUploader")}options;#e=new So;#t=[];#r=[];#i;#s;#a=!1;#o;#l;#n;#p;#c=o(e=>e?.cause===ts?null:this.#o(e),"#onReject");#d=1e4;#u=5*y0;constructor(e,t){this.options={...id,...t},this.options.getChunkSize??=id.getChunkSize,this.#i=e,this.#s=t.file,this.#l=this.options.onSuccess,this.#o=this.options.onError,this.#n=this.options.shouldUseMultipart,this.#p=t.uploadId&&t.key,this.#h()}#h(){let e=this.#i.size,t=typeof this.#n=="function"?this.#n(this.#s):!!this.#n;if(t&&e>this.#u){let r=Math.max(this.options.getChunkSize(this.#i),this.#u),s=Math.floor(e/r);s>this.#d&&(s=this.#d,r=e/this.#d),this.#t=Array(s);for(let n=0,a=0;n<e;n+=r,a++){let u=Math.min(e,n+r),c=o(()=>{let p=n;return this.#i.slice(p,u)},"getData");if(this.#t[a]={getData:c,onProgress:this.#y(a),onComplete:this.#g(a),shouldUseMultipart:t},this.#p){let p=n+r>e?e-n:r;this.#t[a].setAsUploaded=()=>{this.#t[a]=null,this.#r[a].uploaded=p}}}}else this.#t=[{getData:o(()=>this.#i,"getData"),onProgress:this.#y(0),onComplete:this.#g(0),shouldUseMultipart:t}];this.#r=this.#t.map(()=>({uploaded:0}))}#f(){this.options.companionComm.uploadFile(this.#s,this.#t,this.#e.signal).then(this.#l,this.#c),this.#a=!0}#m(){this.options.companionComm.resumeUploadFile(this.#s,this.#t,this.#e.signal).then(this.#l,this.#c)}#y=o(e=>t=>{if(!t.lengthComputable)return;this.#r[e].uploaded=v0(t.loaded);let r=this.#r.reduce((s,n)=>s+n.uploaded,0);this.options.onProgress(r,this.#i.size)},"#onPartProgress");#g=o(e=>t=>{this.#t[e]=null,this.#r[e].etag=t,this.#r[e].done=!0;let r={PartNumber:e+1,ETag:t};this.options.onPartComplete(r)},"#onPartComplete");#v(){this.#e.abort(),this.options.companionComm.abortFileUpload(this.#s).catch(e=>this.options.log(e))}start(){this.#a?(this.#e.signal.aborted||this.#e.abort(ts),this.#e=new So,this.#m()):this.#p?(this.options.companionComm.restoreUploadFile(this.#s,{uploadId:this.options.uploadId,key:this.options.key}),this.#m()):this.#f()}pause(){this.#e.abort(ts),this.#e=new So}abort(e){e?.really?this.#v():this.pause()}[Symbol.for("uppy test: getChunkState")](){return this.#r}},rd=ya;function Ge(i){if(i?.aborted)throw xo("The operation was aborted",{cause:i.reason})}o(Ge,"throwIfAborted");function b0(i){let e=new URL(i);return e.search="",e.hash="",e.href}o(b0,"removeMetadataFromURL");var Po=class{static{o(this,"HTTPCommunicationQueue")}#e;#t=new WeakMap;#r;#i;#s;#a;#o;#l;#n;#p;#c;#d;#u;constructor(e,t,r,s){this.#l=e,this.#c=r,this.#u=s,this.setOptions(t)}setOptions(e){let t=this.#l;"abortMultipartUpload"in e&&(this.#e=t.wrapPromiseFunction(e.abortMultipartUpload,{priority:1})),"createMultipartUpload"in e&&(this.#r=t.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),"signPart"in e&&(this.#i=t.wrapPromiseFunction(e.signPart)),"listParts"in e&&(this.#a=t.wrapPromiseFunction(e.listParts)),"completeMultipartUpload"in e&&(this.#p=t.wrapPromiseFunction(e.completeMultipartUpload,{priority:1})),"retryDelays"in e&&(this.#n=e.retryDelays??[]),"uploadPartBytes"in e&&(this.#d=t.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0})),"getUploadParameters"in e&&(this.#s=t.wrapPromiseFunction(e.getUploadParameters))}async#h(e,t){let r=this.#l,s=e?.source?.status;if(s==null)return!1;if(s===403&&e.message==="Request has expired"){if(!r.isPaused){if(r.limit===1||this.#o==null){let n=t.next();if(n==null||n.done)return!1;this.#o=n.value}r.rateLimit(0),await new Promise(n=>setTimeout(n,this.#o))}}else if(s===429){if(!r.isPaused){let n=t.next();if(n==null||n.done)return!1;r.rateLimit(n.value)}}else{if(s>400&&s<500&&s!==409)return!1;if(typeof navigator<"u"&&navigator.onLine===!1)r.isPaused||(r.pause(),window.addEventListener("online",()=>{r.resume()},{once:!0}));else{let n=t.next();if(n==null||n.done)return!1;await new Promise(a=>setTimeout(a,n.value))}}return!0}async getUploadId(e,t){let r;for(;r=this.#t.get(e.data),r!=null;)try{return await r}catch{}let s=this.#r(this.#u(e),t),n=o(()=>{s.abort(t.reason),this.#t.delete(e.data)},"abortPromise");return t.addEventListener("abort",n,{once:!0}),this.#t.set(e.data,s),s.then(async a=>{t.removeEventListener("abort",n),this.#c(e,a),this.#t.set(e.data,a)},()=>{t.removeEventListener("abort",n),this.#t.delete(e.data)}),s}async abortFileUpload(e){let t=this.#t.get(e.data);if(t==null)return;this.#t.delete(e.data),this.#c(e,Object.create(null));let r;try{r=await t}catch{return}await this.#e(this.#u(e),r)}async#f(e,t,r){let{method:s="POST",url:n,fields:a,headers:u}=await this.#s(this.#u(e),{signal:r}).abortOn(r),c,p=t.getData();if(s.toUpperCase()==="POST"){let F=new FormData;Object.entries(a).forEach(([M,C])=>F.set(M,C)),F.set("file",p),c=F}else c=p;let{onProgress:g,onComplete:h}=t,b=await this.#d({signature:{url:n,headers:u,method:s},body:c,size:p.size,onProgress:g,onComplete:h,signal:r}).abortOn(r),P=a?.key;return this.#c(e,{key:P}),{...b,location:b.location??b0(n),bucket:a?.bucket,key:P}}async uploadFile(e,t,r){if(Ge(r),t.length===1&&!t[0].shouldUseMultipart)return this.#f(e,t[0],r);let{uploadId:s,key:n}=await this.getUploadId(e,r);Ge(r);try{let a=await Promise.all(t.map((u,c)=>this.uploadChunk(e,c+1,u,r)));return Ge(r),await this.#p(this.#u(e),{key:n,uploadId:s,parts:a,signal:r},r).abortOn(r)}catch(a){throw a?.cause!==ts&&a?.name!=="AbortError"&&this.abortFileUpload(e),a}}restoreUploadFile(e,t){this.#t.set(e.data,t)}async resumeUploadFile(e,t,r){if(Ge(r),t.length===1&&t[0]!=null&&!t[0].shouldUseMultipart)return this.#f(e,t[0],r);let{uploadId:s,key:n}=await this.getUploadId(e,r);Ge(r);let a=await this.#a(this.#u(e),{uploadId:s,key:n,signal:r},r).abortOn(r);Ge(r);let u=await Promise.all(t.map((c,p)=>{let g=p+1,h=a.find(({PartNumber:b})=>b===g);return h==null?this.uploadChunk(e,g,c,r):(c?.setAsUploaded?.(),{PartNumber:g,ETag:h.ETag})}));return Ge(r),this.#p(this.#u(e),{key:n,uploadId:s,parts:u,signal:r},r).abortOn(r)}async uploadChunk(e,t,r,s){Ge(s);let{uploadId:n,key:a}=await this.getUploadId(e,s),u=this.#n.values(),c=this.#n.values(),p=o(()=>{let g=u.next();return g==null||g.done?null:g.value},"shouldRetrySignature");for(;;){Ge(s);let g=r.getData(),{onProgress:h,onComplete:b}=r,P;try{P=await this.#i(this.#u(e),{uploadId:n,key:a,partNumber:t,body:g,signal:s}).abortOn(s)}catch(F){let M=p();if(M==null||s.aborted)throw F;await new Promise(C=>setTimeout(C,M));continue}Ge(s);try{return{PartNumber:t,...await this.#d({signature:P,body:g,size:g.size,onProgress:h,onComplete:b,signal:s}).abortOn(s)}}catch(F){if(!await this.#h(F,c))throw F}}}};function Zi(i){if(i?.error){let e=new Error(i.message);throw Object.assign(e,i.error),e}return i}o(Zi,"assertServerError");function sd(i){let e=i.Expiration;if(e){let t=Math.floor((new Date(e)-Date.now())/1e3);if(t>9)return t}}o(sd,"getExpiry");function od({meta:i,allowedMetaFields:e,querify:t=!1}){let r=e??Object.keys(i);return i?Object.fromEntries(r.filter(s=>i[s]!=null).map(s=>{let n=t?`metadata[${s}]`:s,a=String(i[s]);return[n,a]})):{}}o(od,"getAllowedMetadata");var w0={allowedMetaFields:!0,limit:6,getTemporarySecurityCredentials:!1,shouldUseMultipart:o(i=>(i.size||0)>100*1024*1024,"shouldUseMultipart"),retryDelays:[0,1e3,3e3,5e3]},is=class i extends we{static{o(this,"AwsS3Multipart")}static VERSION=ed.version;#e;#t;requests;uploaderEvents;uploaders;constructor(e,t){super(e,{...w0,uploadPartBytes:i.uploadPartBytes,createMultipartUpload:null,listParts:null,abortMultipartUpload:null,completeMultipartUpload:null,signPart:null,getUploadParameters:null,...t}),this.type="uploader",this.id=this.opts.id||"AwsS3Multipart",this.#r(t);let r={createMultipartUpload:this.createMultipartUpload,listParts:this.listParts,abortMultipartUpload:this.abortMultipartUpload,completeMultipartUpload:this.completeMultipartUpload,signPart:t?.getTemporarySecurityCredentials?this.createSignedURL:this.signPart,getUploadParameters:t?.getTemporarySecurityCredentials?this.createSignedURL:this.getUploadParameters};for(let s of Object.keys(r))this.opts[s]==null&&(this.opts[s]=r[s].bind(this));this.requests=this.opts.rateLimitedQueue??new xt(this.opts.limit),this.#e=new Po(this.requests,this.opts,this.#o,this.#l),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}[Symbol.for("uppy test: getClient")](){return this.#t}#r(e){e==null||!("endpoint"in e||"companionUrl"in e||"headers"in e||"companionHeaders"in e||"cookiesRule"in e||"companionCookiesRule"in e)||("companionUrl"in e&&!("endpoint"in e)&&this.uppy.log("`companionUrl` option has been removed in @uppy/aws-s3, use `endpoint` instead.","warning"),"companionHeaders"in e&&!("headers"in e)&&this.uppy.log("`companionHeaders` option has been removed in @uppy/aws-s3, use `headers` instead.","warning"),"companionCookiesRule"in e&&!("cookiesRule"in e)&&this.uppy.log("`companionCookiesRule` option has been removed in @uppy/aws-s3, use `cookiesRule` instead.","warning"),"endpoint"in e?this.#t=new Je(this.uppy,{pluginId:this.id,provider:"AWS",companionUrl:this.opts.endpoint,companionHeaders:this.opts.headers,companionCookiesRule:this.opts.cookiesRule}):("headers"in e&&this.#d(),"cookiesRule"in e&&(this.#t.opts.companionCookiesRule=e.cookiesRule)))}setOptions(e){this.#e.setOptions(e),super.setOptions(e),this.#r(e)}resetUploaderReferences(e,t){this.uploaders[e]&&(this.uploaders[e].abort({really:t?.abort||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}#i(e){if(!this.#t)throw new Error(`Expected a \`endpoint\` option containing a URL, or if you are not using Companion, a custom \`${e}\` implementation.`)}createMultipartUpload(e,t){this.#i("createMultipartUpload"),Ge(t);let r=qt(this.opts.allowedMetaFields,e.meta),s=od({meta:e.meta,allowedMetaFields:r});return this.#t.post("s3/multipart",{filename:e.name,type:e.type,metadata:s},{signal:t}).then(Zi)}listParts(e,{key:t,uploadId:r,signal:s},n){s??=n,this.#i("listParts"),Ge(s);let a=encodeURIComponent(t);return this.#t.get(`s3/multipart/${encodeURIComponent(r)}?key=${a}`,{signal:s}).then(Zi)}completeMultipartUpload(e,{key:t,uploadId:r,parts:s,signal:n},a){n??=a,this.#i("completeMultipartUpload"),Ge(n);let u=encodeURIComponent(t),c=encodeURIComponent(r);return this.#t.post(`s3/multipart/${c}/complete?key=${u}`,{parts:s.map(({ETag:p,PartNumber:g})=>({ETag:p,PartNumber:g}))},{signal:n}).then(Zi)}#s;async#a(e){if(Ge(e?.signal),this.#s==null){let{getTemporarySecurityCredentials:t}=this.opts;t===!0?(this.#i("getTemporarySecurityCredentials"),this.#s=this.#t.get("s3/sts",e).then(Zi)):this.#s=t(e),this.#s=await this.#s,setTimeout(()=>{this.#s=null},(sd(this.#s.credentials)||0)*500)}return this.#s}async createSignedURL(e,t){let r=await this.#a(t),s=sd(r.credentials)||604800,{uploadId:n,key:a,partNumber:u}=t;return{method:"PUT",expires:s,fields:{},url:`${await ga({accountKey:r.credentials.AccessKeyId,accountSecret:r.credentials.SecretAccessKey,sessionToken:r.credentials.SessionToken,expires:s,bucketName:r.bucket,Region:r.region,Key:a??`${crypto.randomUUID()}-${e.name}`,uploadId:n,partNumber:u})}`,headers:{"Content-Type":e.type}}}signPart(e,{uploadId:t,key:r,partNumber:s,signal:n}){if(this.#i("signPart"),Ge(n),t==null||r==null||s==null)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");let a=encodeURIComponent(r);return this.#t.get(`s3/multipart/${encodeURIComponent(t)}/${s}?key=${a}`,{signal:n}).then(Zi)}abortMultipartUpload(e,{key:t,uploadId:r,signal:s}){this.#i("abortMultipartUpload");let n=encodeURIComponent(t),a=encodeURIComponent(r);return this.#t.delete(`s3/multipart/${a}?key=${n}`,void 0,{signal:s}).then(Zi)}getUploadParameters(e,t){this.#i("getUploadParameters");let{meta:r}=e,{type:s,name:n}=r,a=qt(this.opts.allowedMetaFields,e.meta),u=od({meta:r,allowedMetaFields:a,querify:!0}),c=new URLSearchParams({filename:n,type:s,...u});return this.#t.get(`s3/params?${c}`,t)}static async uploadPartBytes({signature:{url:e,expires:t,headers:r,method:s="PUT"},body:n,size:a=n.size,onProgress:u,onComplete:c,signal:p}){if(Ge(p),e==null)throw new Error("Cannot upload to an undefined URL");return new Promise((g,h)=>{let b=new XMLHttpRequest;b.open(s,e,!0),r&&Object.keys(r).forEach(M=>{b.setRequestHeader(M,r[M])}),b.responseType="text",typeof t=="number"&&(b.timeout=t*1e3);function P(){b.abort()}o(P,"onabort");function F(){p?.removeEventListener("abort",P)}o(F,"cleanup"),p?.addEventListener("abort",P),b.upload.addEventListener("progress",M=>{u(M)}),b.addEventListener("abort",()=>{F(),h(xo())}),b.addEventListener("timeout",()=>{F();let M=new Error("Request has expired");M.source={status:403},h(M)}),b.addEventListener("load",()=>{if(F(),b.status===403&&b.responseText.includes("<Message>Request has expired</Message>")){let A=new Error("Request has expired");A.source=b,h(A);return}if(b.status<200||b.status>=300){let A=new Error("Non 2xx");A.source=b,h(A);return}u?.({loaded:a,lengthComputable:!0});let M=b.getAllResponseHeaders().trim().split(/[\r\n]+/),C={__proto__:null};for(let A of M){let J=A.split(": "),G=J.shift(),W=J.join(": ");C[G]=W}let{etag:O,location:U}=C;if(s.toUpperCase()==="POST"&&U==null&&console.error("@uppy/aws-s3: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket"),O==null){console.error("@uppy/aws-s3: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket");return}c?.(O),g({...C,ETag:O})}),b.addEventListener("error",M=>{F();let C=new Error("Unknown error");C.source=M.target,h(C)}),b.send(n)})}#o=o((e,{key:t,uploadId:r})=>{let s=this.uppy.getFile(e.id);s!=null&&this.uppy.setFileState(e.id,{s3Multipart:{...s.s3Multipart,key:t,uploadId:r}})},"#setS3MultipartState");#l=o(e=>this.uppy.getFile(e.id)||e,"#getFile");#n(e){return new Promise((t,r)=>{let s=o((p,g)=>{let h=this.uppy.getFile(e.id);this.uppy.emit("upload-progress",h,{uploadStarted:h.progress.uploadStarted??0,bytesUploaded:p,bytesTotal:g})},"onProgress"),n=o(p=>{this.uppy.log(p),this.uppy.emit("upload-error",e,p),this.resetUploaderReferences(e.id),r(p)},"onError"),a=o(p=>{let g={body:{...p},status:200,uploadURL:p.location};this.resetUploaderReferences(e.id),this.uppy.emit("upload-success",this.#l(e),g),p.location&&this.uppy.log(`Download ${e.name} from ${p.location}`),t(void 0)},"onSuccess"),u=new rd(e.data,{companionComm:this.#e,log:o((...p)=>this.uppy.log(...p),"log"),getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):void 0,onProgress:s,onError:n,onSuccess:a,onPartComplete:o(p=>{this.uppy.emit("s3-multipart:part-uploaded",this.#l(e),p)},"onPartComplete"),file:e,shouldUseMultipart:this.opts.shouldUseMultipart,...e.s3Multipart});this.uploaders[e.id]=u;let c=new Ht(this.uppy);this.uploaderEvents[e.id]=c,c.onFileRemove(e.id,p=>{u.abort(),this.resetUploaderReferences(e.id,{abort:!0}),t(`upload ${p} was removed`)}),c.onCancelAll(e.id,()=>{u.abort(),this.resetUploaderReferences(e.id,{abort:!0}),t(`upload ${e.id} was canceled`)}),c.onFilePause(e.id,p=>{p?u.pause():u.start()}),c.onPauseAll(e.id,()=>{u.pause()}),c.onResumeAll(e.id,()=>{u.start()}),u.start()})}#p(e){return{...e.remote?.body,protocol:"s3-multipart",size:e.data.size,metadata:e.meta}}#c=o(async e=>{if(e.length===0)return;let t=this.uppy.getFilesByIds(e),r=Ji(t),s=Qi(r);this.uppy.emit("upload-start",s);let n=r.map(u=>{if(u.isRemote){let c=o(()=>this.requests,"getQueue");this.#u(!1);let p=new AbortController,g=o(b=>{b.id===u.id&&p.abort()},"removedHandler");this.uppy.on("file-removed",g);let h=this.uppy.getRequestClientForFile(u).uploadRemoteFile(u,this.#p(u),{signal:p.signal,getQueue:c});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",g)},{priority:-1})(),h}return this.#n(u)}),a=await Promise.allSettled(n);return this.#u(!0),a},"#upload");#d=o(()=>{this.#t?.setCompanionHeaders(this.opts.headers)},"#setCompanionHeaders");#u=o(e=>{let{capabilities:t}=this.uppy.getState();this.uppy.setState({capabilities:{...t,resumableUploads:e}})},"#setResumableUploadsCapability");#h=o(()=>{this.#u(!0)},"#resetResumableCapability");install(){this.#u(!0),this.uppy.addPreProcessor(this.#d),this.uppy.addUploader(this.#c),this.uppy.on("cancel-all",this.#h)}uninstall(){this.uppy.removePreProcessor(this.#d),this.uppy.removeUploader(this.#c),this.uppy.off("cancel-all",this.#h)}};var nd={name:"@uppy/box",description:"Import files from Box, into Uppy.",version:"3.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","box"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},publishConfig:{access:"public"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var ad={strings:{pluginNameBox:"Box"}};var ei=class extends Z{static{o(this,"Box")}static VERSION=nd.version;icon;provider;view;storage;files;rootFolderId=null;constructor(e,t){super(e,t),this.id=this.opts.id||"Box",this.type="acquirer",this.storage=this.opts.storage||Ce,this.files=[],this.icon=()=>l("svg",{className:"uppy-DashboardTab-iconBox","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("g",{fill:"currentcolor",fillRule:"nonzero",children:[l("path",{d:"m16.4 13.5c-1.6 0-3 0.9-3.7 2.2-0.7-1.3-2.1-2.2-3.7-2.2-1 0-1.8 0.3-2.5 0.8v-3.6c-0.1-0.3-0.5-0.7-1-0.7s-0.8 0.4-0.8 0.8v7c0 2.3 1.9 4.2 4.2 4.2 1.6 0 3-0.9 3.7-2.2 0.7 1.3 2.1 2.2 3.7 2.2 2.3 0 4.2-1.9 4.2-4.2 0.1-2.4-1.8-4.3-4.1-4.3m-7.5 6.8c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5m7.5 0c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5"}),l("path",{d:"m27.2 20.6l-2.3-2.8 2.3-2.8c0.3-0.4 0.2-0.9-0.2-1.2s-1-0.2-1.3 0.2l-2 2.4-2-2.4c-0.3-0.4-0.9-0.4-1.3-0.2-0.4 0.3-0.5 0.8-0.2 1.2l2.3 2.8-2.3 2.8c-0.3 0.4-0.2 0.9 0.2 1.2s1 0.2 1.3-0.2l2-2.4 2 2.4c0.3 0.4 0.9 0.4 1.3 0.2 0.4-0.3 0.4-0.8 0.2-1.2"})]})}),this.opts.companionAllowedHosts=He(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new qe(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"box",pluginId:this.id,supportsRefreshToken:!1}),this.defaultLocale=ad,this.i18nInit(),this.title=this.i18n("pluginNameBox"),this.render=this.render.bind(this)}install(){this.view=new Me(this,{provider:this.provider,loadAllFiles:!0,virtualList:!0});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}render(e){return this.view.render(e)}};var wa=de(Hr(),1);var cd=de(ld(),1);var ud={strings:{compressingImages:"Compressing images...",compressedX:"Saved %{size} by compressing images"}};var x0={quality:.6,limit:10},rs=class extends we{static{o(this,"Compressor")}#e;constructor(e,t){super(e,{...x0,...t}),this.id=this.opts.id||"Compressor",this.type="modifier",this.defaultLocale=ud,this.#e=new xt(this.opts.limit),this.i18nInit(),this.prepareUpload=this.prepareUpload.bind(this),this.compress=this.compress.bind(this)}compress(e){return new Promise((t,r)=>{new cd.default(e,{...this.opts,success:t,error:r})})}async prepareUpload(e){let t=0,r=[],s=this.#e.wrapPromiseFunction(async a=>{try{let u=await this.compress(a.data),c=a.data.size-u.size;this.uppy.log(`[Image Compressor] Image ${a.id} compressed by ${(0,wa.default)(c)}`),t+=c;let{name:p,type:g,size:h}=u,b=Rt(p),F=`${Rt(a.meta.name).name}.${b.extension}`;this.uppy.setFileState(a.id,{...p&&{name:p},...b.extension&&{extension:b.extension},...g&&{type:g},...h&&{size:h},data:u,meta:{...a.meta,type:g,name:F}}),r.push(a)}catch(u){this.uppy.log(`[Image Compressor] Failed to compress ${a.id}:`,"warning"),this.uppy.log(u,"warning")}}),n=e.map(a=>{let u=this.uppy.getFile(a);return this.uppy.emit("preprocess-progress",u,{mode:"indeterminate",message:this.i18n("compressingImages")}),u.isRemote||(u.data.type||(u.data=u.data.slice(0,u.data.size,u.type)),!u.type?.startsWith("image/"))?Promise.resolve():s(u)});await Promise.all(n),this.uppy.emit("compressor:complete",r),t>1024&&this.uppy.info(this.i18n("compressedX",{size:(0,wa.default)(t)}),"info");for(let a of e){let u=this.uppy.getFile(a);this.uppy.emit("preprocess-complete",u)}}install(){this.uppy.addPreProcessor(this.prepareUpload)}uninstall(){this.uppy.removePreProcessor(this.prepareUpload)}};var pd={name:"@uppy/informer",description:"A notification and error pop-up bar for Uppy.",version:"4.3.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","notification","bar","ui"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"}};var dd=300,ss=class extends ge{static{o(this,"FadeIn")}ref=Qs();componentWillEnter(e){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(e,dd)}componentWillLeave(e){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(e,dd)}render(){let{children:e}=this.props;return l("div",{className:"uppy-Informer-animated",ref:this.ref,children:e})}};function P0(i,e){return Object.assign(i,e)}o(P0,"assign");function k0(i,e){return i?.key??e}o(k0,"getKey");function E0(i,e){let t=i._ptgLinkedRefs||(i._ptgLinkedRefs={});return t[e]||(t[e]=r=>{i.refs[e]=r})}o(E0,"linkRef");function os(i){let e={};for(let t=0;t<i.length;t++)if(i[t]!=null){let r=k0(i[t],t.toString(36));e[r]=i[t]}return e}o(os,"getChildMapping");function F0(i,e){i=i||{},e=e||{};let t=o(a=>Object.hasOwn(e,a)?e[a]:i[a],"getValueForKey"),r={},s=[];for(let a in i)Object.hasOwn(e,a)?s.length&&(r[a]=s,s=[]):s.push(a);let n={};for(let a in e){if(Object.hasOwn(r,a))for(let u=0;u<r[a].length;u++){let c=r[a][u];n[r[a][u]]=t(c)}n[a]=t(a)}for(let a=0;a<s.length;a++)n[s[a]]=t(s[a]);return n}o(F0,"mergeChildMappings");var C0=o(i=>i,"identity"),ko=class extends ge{static{o(this,"TransitionGroup")}constructor(e,t){super(e,t),this.refs={},this.state={children:os(ut(ut(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){let e=this.state.children;for(let t in e)e[t]&&this.performAppear(t)}componentWillReceiveProps(e){let t=os(ut(e.children)||[]),r=this.state.children;this.setState(n=>({children:F0(n.children,t)}));let s;for(s in t)if(Object.hasOwn(t,s)){let n=r&&Object.hasOwn(r,s);t[s]&&n&&this.currentlyTransitioningKeys[s]?(this.keysToEnter.push(s),this.keysToAbortLeave.push(s)):t[s]&&!n&&!this.currentlyTransitioningKeys[s]&&this.keysToEnter.push(s)}for(s in r)if(Object.hasOwn(r,s)){let n=t&&Object.hasOwn(t,s);r[s]&&!n&&!this.currentlyTransitioningKeys[s]&&this.keysToLeave.push(s)}}componentDidUpdate(){let{keysToEnter:e}=this;this.keysToEnter=[],e.forEach(this.performEnter);let{keysToLeave:t}=this;this.keysToLeave=[],t.forEach(this.performLeave)}_finishAbort(e){let t=this.keysToAbortLeave.indexOf(e);t!==-1&&this.keysToAbortLeave.splice(t,1)}performAppear(e){this.currentlyTransitioningKeys[e]=!0;let t=this.refs[e];t?.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)}_handleDoneAppearing(e){let t=this.refs[e];t?.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);let r=os(ut(this.props.children)||[]);(!r||!Object.hasOwn(r,e))&&this.performLeave(e)}performEnter(e){this.currentlyTransitioningKeys[e]=!0;let t=this.refs[e];t?.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)}_handleDoneEntering(e){let t=this.refs[e];t?.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);let r=os(ut(this.props.children)||[]);(!r||!Object.hasOwn(r,e))&&this.performLeave(e)}performLeave(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;this.currentlyTransitioningKeys[e]=!0;let r=this.refs[e];r?.componentWillLeave?r.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)}_handleDoneLeaving(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;let r=this.refs[e];r?.componentDidLeave&&r.componentDidLeave(),delete this.currentlyTransitioningKeys[e];let s=os(ut(this.props.children)||[]);if(s&&Object.hasOwn(s,e))this.performEnter(e);else{let n=P0({},this.state.children);delete n[e],this.setState({children:n})}}render({childFactory:e,transitionLeave:t,transitionName:r,transitionAppear:s,transitionEnter:n,transitionLeaveTimeout:a,transitionEnterTimeout:u,transitionAppearTimeout:c,component:p,...g},{children:h}){let b=Object.entries(h).map(([P,F])=>{if(!F)return;let M=E0(this,P);return Nr(e(F),{ref:M,key:P})}).filter(Boolean);return jt(p,g,b)}};ko.defaultProps={component:"span",childFactory:C0};var hd=ko;var ti=class extends Z{static{o(this,"Informer")}static VERSION=pd.version;constructor(e,t){super(e,t),this.type="progressindicator",this.id=this.opts.id||"Informer",this.title="Informer"}render=o(e=>l("div",{className:"uppy uppy-Informer",children:l(hd,{children:e.info.map(t=>l(ss,{children:l("p",{role:"alert",children:[t.message," ",t.details&&l("span",{"aria-label":t.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:o(()=>alert(`${t.message} 

 ${t.details}`),"onClick"),children:"?"})]})},t.message))})}),"render");install(){let{target:e}=this.opts;e&&this.mount(e,this)}};function Eo(i,e,t,r){return t===0||i===e?i:r===0?e:i+(e-i)*2**(-r/t)}o(Eo,"emaFilter");var fd={name:"@uppy/status-bar",description:"A progress bar for Uppy, with many bells and whistles.",version:"4.2.3",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","progress bar","status bar","progress","upload","eta","speed"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/utils":"workspace:^",classnames:"^2.2.6",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"}};var md={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};var mt={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var Fa=de(ot(),1);var _a=de(Hr(),1);function Sa(i){let e=Math.floor(i/3600)%24,t=Math.floor(i/60)%60,r=Math.floor(i%60);return{hours:e,minutes:t,seconds:r}}o(Sa,"secondsToTime");function xa(i){let e=Sa(i),t=e.hours===0?"":`${e.hours}h`,r=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,s=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${t}${r}${s}`}o(xa,"prettyETA");var Pa=de(ot(),1);var A0="\xB7",gd=o(()=>` ${A0} `,"renderDot");function yd(i){let{newFiles:e,isUploadStarted:t,recoveredState:r,i18n:s,uploadState:n,isSomeGhost:a,startUpload:u}=i,c=(0,Pa.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":n===mt.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":a}),p=e&&t&&!r?s("uploadXNewFiles",{smart_count:e}):s("uploadXFiles",{smart_count:e});return l("button",{type:"button",className:c,"aria-label":s("uploadXFiles",{smart_count:e}),onClick:u,disabled:a,"data-uppy-super-focusable":!0,children:p})}o(yd,"UploadBtn");function vd(i){let{i18n:e,uppy:t}=i;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:o(()=>t.retryAll().catch(()=>{}),"onClick"),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:l("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),e("retry")]})}o(vd,"RetryBtn");function bd(i){let{i18n:e,uppy:t}=i;return l("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:o(()=>t.cancelAll(),"onClick"),"data-cy":"cancel","data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:l("g",{fill:"none",fillRule:"evenodd",children:[l("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),l("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}o(bd,"CancelBtn");function wd(i){let{isAllPaused:e,i18n:t,isAllComplete:r,resumableUploads:s,uppy:n}=i,a=t(e?"resume":"pause");function u(){if(!r){if(!s){n.cancelAll();return}if(e){n.resumeAll();return}n.pauseAll()}}return o(u,"togglePauseResume"),l("button",{title:a,"aria-label":a,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:u,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:l("g",{fill:"none",fillRule:"evenodd",children:[l("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),l("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}o(wd,"PauseResumeButton");function Sd(i){let{i18n:e,doneButtonHandler:t}=i;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:t,"data-uppy-super-focusable":!0,children:e("done")})}o(Sd,"DoneBtn");function xd(){return l("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:l("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}o(xd,"LoadingSpinner");function _d(i){let{progress:e}=i,{value:t,mode:r,message:s}=e;return l("div",{className:"uppy-StatusBar-content",children:[l(xd,{}),r==="determinate"?`${Math.round(t*100)}% \xB7 `:"",s]})}o(_d,"ProgressBarProcessing");function R0(i){let{numUploads:e,complete:t,totalUploadedSize:r,totalSize:s,totalETA:n,i18n:a}=i,u=e>1,c=(0,_a.default)(r);return l("div",{className:"uppy-StatusBar-statusSecondary",children:[u&&a("filesUploadedOfTotal",{complete:t,smart_count:e}),l("span",{className:"uppy-StatusBar-additionalInfo",children:[u&&gd(),s!=null?a("dataUploadedOfTotal",{complete:c,total:(0,_a.default)(s)}):a("dataUploadedOfUnknown",{complete:c}),gd(),n!=null&&a("xTimeLeft",{time:xa(n)})]})]})}o(R0,"ProgressDetails");function Pd(i){let{i18n:e,complete:t,numUploads:r}=i;return l("div",{className:"uppy-StatusBar-statusSecondary",children:e("filesUploadedOfTotal",{complete:t,smart_count:r})})}o(Pd,"FileUploadCount");function O0(i){let{i18n:e,newFiles:t,startUpload:r}=i,s=(0,Pa.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return l("div",{className:"uppy-StatusBar-statusSecondary",children:[l("div",{className:"uppy-StatusBar-statusSecondaryHint",children:e("xMoreFilesAdded",{smart_count:t})}),l("button",{type:"button",className:s,"aria-label":e("uploadXFiles",{smart_count:t}),onClick:r,children:e("upload")})]})}o(O0,"UploadNewlyAddedFiles");function kd(i){let{i18n:e,supportsUploadProgress:t,totalProgress:r,showProgressDetails:s,isUploadStarted:n,isAllComplete:a,isAllPaused:u,newFiles:c,numUploads:p,complete:g,totalUploadedSize:h,totalSize:b,totalETA:P,startUpload:F}=i,M=c&&n;if(!n||a)return null;let C=e(u?"paused":"uploading");function O(){return!u&&!M&&s?t?l(R0,{numUploads:p,complete:g,totalUploadedSize:h,totalSize:b,totalETA:P,i18n:e}):l(Pd,{i18n:e,complete:g,numUploads:p}):null}return o(O,"renderProgressDetails"),l("div",{className:"uppy-StatusBar-content",title:C,children:[u?null:l(xd,{}),l("div",{className:"uppy-StatusBar-status",children:[l("div",{className:"uppy-StatusBar-statusPrimary",children:t&&r!==0?`${C}: ${r}%`:C}),O(),M?l(O0,{i18n:e,newFiles:c,startUpload:F}):null]})]})}o(kd,"ProgressBarUploading");function Ed(i){let{i18n:e}=i;return l("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete"),children:l("div",{className:"uppy-StatusBar-status",children:l("div",{className:"uppy-StatusBar-statusPrimary",children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:l("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),e("complete")]})})})}o(Ed,"ProgressBarComplete");function Fd(i){let{error:e,i18n:t,complete:r,numUploads:s}=i;function n(){let a=`${t("uploadFailed")} 

 ${e}`;alert(a)}return o(n,"displayErrorAlert"),l("div",{className:"uppy-StatusBar-content",title:t("uploadFailed"),children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:l("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),l("div",{className:"uppy-StatusBar-status",children:[l("div",{className:"uppy-StatusBar-statusPrimary",children:[t("uploadFailed"),l("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":t("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:n,type:"button",children:"?"})]}),l(Pd,{i18n:t,complete:r,numUploads:s})]})]})}o(Fd,"ProgressBarError");function ns(i){let e=[],t="indeterminate",r;for(let{progress:n}of Object.values(i)){let{preprocess:a,postprocess:u}=n;r==null&&(a||u)&&({mode:t,message:r}=a||u),a?.mode==="determinate"&&e.push(a.value),u?.mode==="determinate"&&e.push(u.value)}let s=e.reduce((n,a)=>n+a/e.length,0);return{mode:t,message:r,value:s}}o(ns,"calculateProcessingProgress");var{STATE_ERROR:Cd,STATE_WAITING:U0,STATE_PREPROCESSING:ka,STATE_UPLOADING:Fo,STATE_POSTPROCESSING:Ea,STATE_COMPLETE:Co}=mt;function Ca({newFiles:i,allowNewUpload:e,isUploadInProgress:t,isAllPaused:r,resumableUploads:s,error:n,hideUploadButton:a=void 0,hidePauseResumeButton:u=!1,hideCancelButton:c=!1,hideRetryButton:p=!1,recoveredState:g,uploadState:h,totalProgress:b,files:P,supportsUploadProgress:F,hideAfterFinish:M=!1,isSomeGhost:C,doneButtonHandler:O=void 0,isUploadStarted:U,i18n:A,startUpload:J,uppy:G,isAllComplete:W,showProgressDetails:K=void 0,numUploads:te,complete:Q,totalSize:be,totalETA:ne,totalUploadedSize:Pe}){function ye(){switch(h){case Ea:case ka:{let ce=ns(P);return ce.mode==="determinate"?ce.value*100:b}case Cd:return null;case Fo:return F?b:null;default:return b}}o(ye,"getProgressValue");function Te(){switch(h){case Ea:case ka:{let{mode:ce}=ns(P);return ce==="indeterminate"}case Fo:return!F;default:return!1}}o(Te,"getIsIndeterminate");let Se=ye(),k=Se??100,w=!n&&i&&(!t&&!r||g)&&e&&!a,S=!c&&h!==U0&&h!==Co,B=s&&!u&&h===Fo,q=n&&!W&&!p,z=O&&h===Co,D=(0,Fa.default)("uppy-StatusBar-progress",{"is-indeterminate":Te()}),E=(0,Fa.default)("uppy-StatusBar",`is-${h}`,{"has-ghosts":C}),T=(()=>{switch(h){case ka:case Ea:return l(_d,{progress:ns(P)});case Co:return l(Ed,{i18n:A});case Cd:return l(Fd,{error:n,i18n:A,numUploads:te,complete:Q});case Fo:return l(kd,{i18n:A,supportsUploadProgress:F,totalProgress:b,showProgressDetails:K,isUploadStarted:U,isAllComplete:W,isAllPaused:r,newFiles:i,numUploads:te,complete:Q,totalUploadedSize:Pe,totalSize:be,totalETA:ne,startUpload:J});default:return null}})();return!(w||q||B||S||z)&&!T||h===Co&&M?null:l("div",{className:E,children:[l("div",{className:D,style:{width:`${k}%`},role:"progressbar","aria-label":`${k}%`,"aria-valuetext":`${k}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Se}),T,l("div",{className:"uppy-StatusBar-actions",children:[w?l(yd,{newFiles:i,isUploadStarted:U,recoveredState:g,i18n:A,isSomeGhost:C,startUpload:J,uploadState:h}):null,q?l(vd,{i18n:A,uppy:G}):null,B?l(wd,{isAllPaused:r,i18n:A,isAllComplete:W,resumableUploads:s,uppy:G}):null,S?l(bd,{i18n:A,uppy:G}):null,z?l(Sd,{i18n:A,doneButtonHandler:O}):null]})]})}o(Ca,"StatusBarUI");var D0=2e3,I0=2e3;function N0(i,e,t,r){if(i)return mt.STATE_ERROR;if(e)return mt.STATE_COMPLETE;if(t)return mt.STATE_WAITING;let s=mt.STATE_WAITING,n=Object.keys(r);for(let a=0;a<n.length;a++){let{progress:u}=r[n[a]];if(u.uploadStarted&&!u.uploadComplete)return mt.STATE_UPLOADING;u.preprocess&&(s=mt.STATE_PREPROCESSING),u.postprocess&&s!==mt.STATE_PREPROCESSING&&(s=mt.STATE_POSTPROCESSING)}return s}o(N0,"getUploadingState");var M0={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null},ii=class extends Z{static{o(this,"StatusBar")}static VERSION=fd.version;#e;#t;#r;#i;constructor(e,t){super(e,{...M0,...t}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=md,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}#s(e){if(e.total==null||e.total===0)return null;let t=e.total-e.uploaded;if(t<=0)return null;this.#e??=performance.now();let r=performance.now()-this.#e;if(r===0)return Math.round((this.#i??0)/100)/10;let s=e.uploaded-this.#t;if(this.#t=e.uploaded,s<=0)return Math.round((this.#i??0)/100)/10;let n=s/r,a=this.#r==null?n:Eo(n,this.#r,D0,r);this.#r=a;let u=t/a,c=Math.max(this.#i-r,0),p=this.#i==null?u:Eo(u,c,I0,r);return this.#i=p,this.#e=performance.now(),Math.round(p/100)/10}startUpload=o(()=>this.uppy.upload().catch(()=>{}),"startUpload");render(e){let{capabilities:t,files:r,allowNewUpload:s,totalProgress:n,error:a,recoveredState:u}=e,{newFiles:c,startedFiles:p,completeFiles:g,isUploadStarted:h,isAllComplete:b,isAllPaused:P,isUploadInProgress:F,isSomeGhost:M}=this.uppy.getObjectOfFilesPerState(),C=u?Object.values(r):c,O=!!t.resumableUploads,U=t.uploadProgress!==!1,A=null,J=0;p.every(W=>W.progress.bytesTotal!=null&&W.progress.bytesTotal!==0)?(A=0,p.forEach(W=>{A+=W.progress.bytesTotal||0,J+=W.progress.bytesUploaded||0})):p.forEach(W=>{J+=W.progress.bytesUploaded||0});let G=this.#s({uploaded:J,total:A});return Ca({error:a,uploadState:N0(a,b,u,e.files||{}),allowNewUpload:s,totalProgress:n,totalSize:A,totalUploadedSize:J,isAllComplete:!1,isAllPaused:P,isUploadStarted:h,isUploadInProgress:F,isSomeGhost:M,recoveredState:u,complete:g.length,newFiles:C.length,numUploads:p.length,totalETA:G,files:r,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:O,supportsUploadProgress:U,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){let e=this.el;Xs(e)||(e.dir="ltr")}#a=o(()=>{let{recoveredState:e}=this.uppy.getState();if(this.#r=null,this.#i=null,e){this.#t=Object.values(e.files).reduce((t,{progress:r})=>t+r.bytesUploaded,0),this.uppy.emit("restore-confirmed");return}this.#e=performance.now(),this.#t=0},"#onUploadStart");install(){let{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",this.#a),this.#e=performance.now(),this.#t=this.uppy.getFiles().reduce((t,r)=>t+r.progress.bytesUploaded,0)}uninstall(){this.unmount(),this.uppy.off("upload",this.#a)}};var L0=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function B0(i,e,t){let r=L0.exec(i),s=e.mimeType??r?.[1]??"plain/text",n;if(r?.[2]!=null){let a=atob(decodeURIComponent(r[3])),u=new Uint8Array(a.length);for(let c=0;c<a.length;c++)u[c]=a.charCodeAt(c);n=[u]}else r?.[3]!=null&&(n=[decodeURIComponent(r[3])]);return t?new File(n,e.name||"",{type:s}):new Blob(n,{type:s})}o(B0,"dataURItoBlob");var Td=B0;function To(i){return i.startsWith("blob:")}o(To,"isObjectURL");function Ao(i){return i?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(i):!1}o(Ao,"isPreviewSupported");function me(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}o(me,"e");var Ld=typeof self<"u"?self:global,cs=typeof navigator<"u",j0=cs&&typeof HTMLImageElement>"u",Ad=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Bd=Ld.Buffer,jd=!!Bd,z0=o(i=>i!==void 0,"h");function zd(i){return i===void 0||(i instanceof Map?i.size===0:Object.values(i).filter(z0).length===0)}o(zd,"f");function Ke(i){let e=new Error(i);throw delete e.stack,e}o(Ke,"l");function Rd(i){let e=function(t){let r=0;return t.ifd0.enabled&&(r+=1024),t.exif.enabled&&(r+=2048),t.makerNote&&(r+=2048),t.userComment&&(r+=1024),t.gps.enabled&&(r+=512),t.interop.enabled&&(r+=100),t.ifd1.enabled&&(r+=1024),r+2048}(i);return i.jfif.enabled&&(e+=50),i.xmp.enabled&&(e+=2e4),i.iptc.enabled&&(e+=14e3),i.icc.enabled&&(e+=6e3),e}o(Rd,"o");var Ta=o(i=>String.fromCharCode.apply(null,i),"u"),Od=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0,Ai=class i{static{o(this,"c")}static from(e,t){return e instanceof this&&e.le===t?e:new i(e,void 0,void 0,t)}constructor(e,t=0,r,s){if(typeof s=="boolean"&&(this.le=s),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){r===void 0&&(r=e.byteLength-t);let n=new DataView(e,t,r);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof i){r===void 0&&(r=e.byteLength-t),(t+=e.byteOffset)+r>e.byteOffset+e.byteLength&&Ke("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,t,r);this._swapDataView(n)}else if(typeof e=="number"){let n=new DataView(new ArrayBuffer(e));this._swapDataView(n)}else Ke("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,r=i){return e instanceof DataView||e instanceof i?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||Ke("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new r(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new i(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return s=this.getUint8Array(e,t),Od?Od.decode(s):jd?Buffer.from(s).toString("utf8"):decodeURIComponent(escape(Ta(s)));var s}getLatin1String(e=0,t=this.byteLength){let r=this.getUint8Array(e,t);return Ta(r)}getUnicodeString(e=0,t=this.byteLength){let r=[];for(let s=0;s<t&&e+s<this.byteLength;s+=2)r.push(this.getUint16(e+s));return Ta(r)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,r){switch(t){case 1:return this.getUint8(e,r);case 2:return this.getUint16(e,r);case 4:return this.getUint32(e,r);case 8:return this.getUint64&&this.getUint64(e,r)}}getUint(e,t,r){switch(t){case 8:return this.getUint8(e,r);case 16:return this.getUint16(e,r);case 32:return this.getUint32(e,r);case 64:return this.getUint64&&this.getUint64(e,r)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}};function Ra(i,e){Ke(`${i} '${e}' was not loaded, try using full build of exifr.`)}o(Ra,"p");var ps=class extends Map{static{o(this,"g")}constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||Ra(this.kind,e),t&&(e in t||function(r,s){Ke(`Unknown ${r} '${s}'.`)}(this.kind,e),t[e].enabled||Ra(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}},Io=new ps("file parser"),gt=new ps("segment parser"),fs=new ps("file reader"),H0=Ld.fetch;function Ud(i,e){return(t=i).startsWith("data:")||t.length>1e4?Ua(i,e,"base64"):Ad&&i.includes("://")?Oa(i,e,"url",Ro):Ad?Ua(i,e,"fs"):cs?Oa(i,e,"url",Ro):void Ke("Invalid input argument");var t}o(Ud,"k");async function Oa(i,e,t,r){return fs.has(t)?Ua(i,e,t):r?async function(s,n){let a=await n(s);return new Ai(a)}(i,r):void Ke(`Parser ${t} is not loaded`)}o(Oa,"O");async function Ua(i,e,t){let r=new(fs.get(t))(i,e);return await r.read(),r}o(Ua,"v");var Ro=o(i=>H0(i).then(e=>e.arrayBuffer()),"S"),ds=o(i=>new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>e(r.result||new ArrayBuffer),r.onerror=t,r.readAsArrayBuffer(i)}),"A"),Da=class extends Map{static{o(this,"U")}get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}};function Hd(i,e,t){let r=new Da;for(let[s,n]of t)r.set(s,n);if(Array.isArray(e))for(let s of e)i.set(s,r);else i.set(e,r);return r}o(Hd,"x");function qd(i,e,t){let r,s=i.get(e);for(r of t)s.set(r[0],r[1])}o(qd,"C");var ms=new Map,Ba=new Map,ja=new Map,er=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],No=["jfif","xmp","icc","iptc","ihdr"],hs=["tiff",...No],Le=["ifd0","ifd1","exif","gps","interop"],tr=[...hs,...Le],ir=["makerNote","userComment"],Mo=["translateKeys","translateValues","reviveValues","multiSegment"],rr=[...Mo,"sanitize","mergeOutput","silentErrors"],Oo=class{static{o(this,"_")}get translate(){return this.translateKeys||this.translateValues||this.reviveValues}},Ti=class extends Oo{static{o(this,"D")}get needed(){return this.enabled||this.deps.size>0}constructor(e,t,r,s){if(super(),me(this,"enabled",!1),me(this,"skip",new Set),me(this,"pick",new Set),me(this,"deps",new Set),me(this,"translateKeys",!1),me(this,"translateValues",!1),me(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(s),this.canBeFiltered=Le.includes(e),this.canBeFiltered&&(this.dict=ms.get(e)),r!==void 0)if(Array.isArray(r))this.parse=this.enabled=!0,this.canBeFiltered&&r.length>0&&this.translateTagSet(r,this.pick);else if(typeof r=="object"){if(this.enabled=!0,this.parse=r.parse!==!1,this.canBeFiltered){let{pick:n,skip:a}=r;n&&n.length>0&&this.translateTagSet(n,this.pick),a&&a.length>0&&this.translateTagSet(a,this.skip)}this.applyInheritables(r)}else r===!0||r===!1?this.parse=this.enabled=r:Ke(`Invalid options argument: ${r}`)}applyInheritables(e){let t,r;for(t of Mo)r=e[t],r!==void 0&&(this[t]=r)}translateTagSet(e,t){if(this.dict){let r,s,{tagKeys:n,tagValues:a}=this.dict;for(r of e)typeof r=="string"?(s=a.indexOf(r),s===-1&&(s=n.indexOf(Number(r))),s!==-1&&t.add(Number(n[s]))):t.add(r)}else for(let r of e)t.add(r)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Uo(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Uo(this.pick,this.deps)}},at={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Dd=new Map,Ri=class extends Oo{static{o(this,"R")}static useCached(e){let t=Dd.get(e);return t!==void 0||(t=new this(e),Dd.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):Ke(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=cs?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of er)this[e]=at[e];for(e of rr)this[e]=at[e];for(e of ir)this[e]=at[e];for(e of tr)this[e]=new Ti(e,at[e],void 0,this)}setupFromTrue(){let e;for(e of er)this[e]=at[e];for(e of rr)this[e]=at[e];for(e of ir)this[e]=!0;for(e of tr)this[e]=new Ti(e,!0,void 0,this)}setupFromArray(e){let t;for(t of er)this[t]=at[t];for(t of rr)this[t]=at[t];for(t of ir)this[t]=at[t];for(t of tr)this[t]=new Ti(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Le)}setupFromObject(e){let t;for(t of(Le.ifd0=Le.ifd0||Le.image,Le.ifd1=Le.ifd1||Le.thumbnail,Object.assign(this,e),er))this[t]=Aa(e[t],at[t]);for(t of rr)this[t]=Aa(e[t],at[t]);for(t of ir)this[t]=Aa(e[t],at[t]);for(t of hs)this[t]=new Ti(t,at[t],e[t],this);for(t of Le)this[t]=new Ti(t,at[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Le,tr),e.tiff===!0?this.batchEnableWithBool(Le,!0):e.tiff===!1?this.batchEnableWithUserValue(Le,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Le):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Le)}batchEnableWithBool(e,t){for(let r of e)this[r].enabled=t}batchEnableWithUserValue(e,t){for(let r of e){let s=t[r];this[r].enabled=s!==!1&&s!==void 0}}setupGlobalFilters(e,t,r,s=r){if(e&&e.length){for(let a of s)this[a].enabled=!1;let n=Id(e,r);for(let[a,u]of n)Uo(this[a].pick,u),this[a].enabled=!0}else if(t&&t.length){let n=Id(t,r);for(let[a,u]of n)Uo(this[a].skip,u)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:r,iptc:s,icc:n}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),r.enabled||e.skip.add(700),s.enabled||e.skip.add(33723),n.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:r,interop:s}=this;s.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),r.needed&&e.deps.add(34853),this.tiff.enabled=Le.some(n=>this[n].enabled===!0)||this.makerNote||this.userComment;for(let n of Le)this[n].finalizeFilters()}get onlyTiff(){return!No.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of hs)this[e].enabled&&!gt.has(e)&&Ra("segment parser",e)}};function Id(i,e){let t,r,s,n,a=[];for(s of e){for(n of(t=ms.get(s),r=[],t))(i.includes(n[0])||i.includes(n[1]))&&r.push(n[0]);r.length&&a.push([s,r])}return a}o(Id,"K");function Aa(i,e){return i!==void 0?i:e!==void 0?e:void 0}o(Aa,"W");function Uo(i,e){for(let t of e)i.add(t)}o(Uo,"X");me(Ri,"default",at);var sr=class{static{o(this,"H")}constructor(e){me(this,"parsers",{}),me(this,"output",{}),me(this,"errors",[]),me(this,"pushToErrors",t=>this.errors.push(t)),this.options=Ri.useCached(e)}async read(e){this.file=await function(t,r){return typeof t=="string"?Ud(t,r):cs&&!j0&&t instanceof HTMLImageElement?Ud(t.src,r):t instanceof Uint8Array||t instanceof ArrayBuffer||t instanceof DataView?new Ai(t):cs&&t instanceof Blob?Oa(t,r,"blob",ds):void Ke("Invalid input argument")}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[r,s]of Io)if(s.canHandle(e,t))return this.fileParser=new s(this.options,this.file,this.parsers),e[r]=!0;this.file.close&&this.file.close(),Ke("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),zd(r=e)?void 0:r;var r}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async r=>{let s=await r.parse();r.assignToOutput(e,s)});this.options.silentErrors&&(t=t.map(r=>r.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,r=gt.get("tiff",e);var s;if(t.tiff?s={start:0,type:"tiff"}:t.jpeg&&(s=await this.fileParser.getOrFindSegment("tiff")),s===void 0)return;let n=await this.fileParser.ensureSegmentChunk(s),a=this.parsers.tiff=new r(n,e,t),u=await a.extractThumbnail();return t.close&&t.close(),u}};async function Vd(i,e){let t=new sr(e);return await t.read(i),t.parse()}o(Vd,"Y");var q0=Object.freeze({__proto__:null,parse:Vd,Exifr:sr,fileParsers:Io,segmentParsers:gt,fileReaders:fs,tagKeys:ms,tagValues:Ba,tagRevivers:ja,createDictionary:Hd,extendDictionary:qd,fetchUrlAsArrayBuffer:Ro,readBlobAsArrayBuffer:ds,chunkedProps:er,otherSegments:No,segments:hs,tiffBlocks:Le,segmentsAndBlocks:tr,tiffExtractables:ir,inheritables:Mo,allFormatters:rr,Options:Ri}),ri=class{static{o(this,"J")}static findPosition(e,t){let r=e.getUint16(t+2)+2,s=typeof this.headerLength=="function"?this.headerLength(e,t,r):this.headerLength,n=t+s,a=r-s;return{offset:t,length:r,headerLength:s,start:n,size:a,end:n+a}}static parse(e,t={}){return new this(e,new Ri({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof Ai?e:new Ai(e)}constructor(e,t={},r){me(this,"errors",[]),me(this,"raw",new Map),me(this,"handleError",s=>{if(!this.options.silentErrors)throw s;this.errors.push(s.message)}),this.chunk=this.normalizeInput(e),this.file=r,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let r=ja.get(t),s=Ba.get(t),n=ms.get(t),a=this.options[t],u=a.reviveValues&&!!r,c=a.translateValues&&!!s,p=a.translateKeys&&!!n,g={};for(let[h,b]of e)u&&r.has(h)?b=r.get(h)(b):c&&s.has(h)&&(b=this.translateValue(b,s.get(h))),p&&n.has(h)&&(h=n.get(h)||h),g[h]=b;return g}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,r){if(this.globalOptions.mergeOutput)return Object.assign(e,r);e[t]?Object.assign(e[t],r):e[t]=r}};me(ri,"headerLength",4),me(ri,"type",void 0),me(ri,"multiSegment",!1),me(ri,"canHandle",()=>!1);function V0(i){return i===192||i===194||i===196||i===219||i===221||i===218||i===254}o(V0,"q");function $0(i){return i>=224&&i<=239}o($0,"Q");function W0(i,e,t){for(let[r,s]of gt)if(s.canHandle(i,e,t))return r}o(W0,"Z");var Do=class extends class{constructor(e,t,r){me(this,"errors",[]),me(this,"ensureSegmentChunk",async s=>{let n=s.start,a=s.size||65536;if(this.file.chunked)if(this.file.available(n,a))s.chunk=this.file.subarray(n,a);else try{s.chunk=await this.file.readChunk(n,a)}catch(u){Ke(`Couldn't read segment: ${JSON.stringify(s)}. ${u.message}`)}else this.file.byteLength>n+a?s.chunk=this.file.subarray(n,a):s.size===void 0?s.chunk=this.file.subarray(n):Ke("Segment unreachable: "+JSON.stringify(s));return s.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=r}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let r=new(gt.get(e))(t,this.options,this.file);return this.parsers[e]=r}createParsers(e){for(let t of e){let{type:r,chunk:s}=t,n=this.options[r];if(n&&n.enabled){let a=this.parsers[r];a&&a.append||a||this.createParser(r,s)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{static{o(this,"ee")}constructor(...e){super(...e),me(this,"appSegments",[]),me(this,"jpegSegments",[]),me(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(gt.keyList())):(e=e===void 0?gt.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&gt.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:r,findAll:s,wanted:n,remaining:a}=this;if(!s&&this.file.chunked&&(s=Array.from(n).some(u=>{let c=gt.get(u),p=this.options[u];return c.multiSegment&&p.multiSegment}),s&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,r.byteLength),!this.options.onlyTiff&&r.chunked){let u=!1;for(;a.size>0&&!u&&(r.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:c}=r,p=this.appSegments.some(g=>!this.file.available(g.offset||g.start,g.length||g.size));if(u=e>c&&!p?!await r.readNextChunk(e):!await r.readNextChunk(c),(e=this.findAppSegmentsInRange(e,r.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let r,s,n,a,u,c,{file:p,findAll:g,wanted:h,remaining:b,options:P}=this;for(;e<t;e++)if(p.getUint8(e)===255){if(r=p.getUint8(e+1),$0(r)){if(s=p.getUint16(e+2),n=W0(p,e,s),n&&h.has(n)&&(a=gt.get(n),u=a.findPosition(p,e),c=P[n],u.type=n,this.appSegments.push(u),!g&&(a.multiSegment&&c.multiSegment?(this.unfinishedMultiSegment=u.chunkNumber<u.chunkCount,this.unfinishedMultiSegment||b.delete(n)):b.delete(n),b.size===0)))break;P.recordUnknownSegments&&(u=ri.findPosition(p,e),u.marker=r,this.unknownSegments.push(u)),e+=s+1}else if(V0(r)){if(s=p.getUint16(e+2),r===218&&P.stopAfterSos!==!1)return;P.recordJpegSegments&&this.jpegSegments.push({offset:e,length:s,marker:r}),e+=s+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,r){let s,n,a,u=new Map;for(let c=0;c<t.length;c++)s=t[c],n=s[r],u.has(n)?a=u.get(n):u.set(n,a=[]),a.push(s);return Array.from(u)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,r])=>{let s=gt.get(t,this.options);return s.handleMultiSegments?{type:t,chunk:s.handleMultiSegments(r)}:r[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}};me(Do,"type","jpeg"),Io.set("jpeg",Do);var G0=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],Ia=class extends ri{static{o(this,"se")}parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,r=new Map){let{pick:s,skip:n}=this.options[t];s=new Set(s);let a=s.size>0,u=n.size===0,c=this.chunk.getUint16(e);e+=2;for(let p=0;p<c;p++){let g=this.chunk.getUint16(e);if(a){if(s.has(g)&&(r.set(g,this.parseTag(e,g,t)),s.delete(g),s.size===0))break}else!u&&n.has(g)||r.set(g,this.parseTag(e,g,t));e+=12}return r}parseTag(e,t,r){let{chunk:s}=this,n=s.getUint16(e+2),a=s.getUint32(e+4),u=G0[n];if(u*a<=4?e+=8:e=s.getUint32(e+8),(n<1||n>13)&&Ke(`Invalid TIFF value type. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${n}, offset ${e}`),e>s.byteLength&&Ke(`Invalid TIFF value offset. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${n}, offset ${e} is outside of chunk size ${s.byteLength}`),n===1)return s.getUint8Array(e,a);if(n===2)return(c=function(p){for(;p.endsWith("\0");)p=p.slice(0,-1);return p}(c=s.getString(e,a)).trim())===""?void 0:c;var c;if(n===7)return s.getUint8Array(e,a);if(a===1)return this.parseTagValue(n,e);{let p=new(function(h){switch(h){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(n))(a),g=u;for(let h=0;h<a;h++)p[h]=this.parseTagValue(n,e),e+=g;return p}}parseTagValue(e,t){let{chunk:r}=this;switch(e){case 1:return r.getUint8(t);case 3:return r.getUint16(t);case 4:return r.getUint32(t);case 5:return r.getUint32(t)/r.getUint32(t+4);case 6:return r.getInt8(t);case 8:return r.getInt16(t);case 9:return r.getInt32(t);case 10:return r.getInt32(t)/r.getInt32(t+4);case 11:return r.getFloat(t);case 12:return r.getDouble(t);case 13:return r.getUint32(t);default:Ke(`Invalid tiff type ${e}`)}}},us=class extends Ia{static{o(this,"ie")}static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let r=new Map;return this[t]=r,this.parseTags(e,t,r),r}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&Ke("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&Ke(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,Rd(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,Rd(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let r=e.get(t);r&&r.length===1&&e.set(t,r[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",Nd(...e.get(2),e.get(1))),e.set("longitude",Nd(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,r,s={};for(t of Le)if(e=this[t],!zd(e))if(r=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(s,r)}else s[t]=r;return this.makerNote&&(s.makerNote=this.makerNote),this.userComment&&(s.userComment=this.userComment),s}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[r,s]of Object.entries(t))this.assignObjectToOutput(e,r,s)}};function Nd(i,e,t,r){var s=i+e/60+t/3600;return r!=="S"&&r!=="W"||(s*=-1),s}o(Nd,"ne");me(us,"type","tiff"),me(us,"headerLength",10),gt.set("tiff",us);var nF=Object.freeze({__proto__:null,default:q0,Exifr:sr,fileParsers:Io,segmentParsers:gt,fileReaders:fs,tagKeys:ms,tagValues:Ba,tagRevivers:ja,createDictionary:Hd,extendDictionary:qd,fetchUrlAsArrayBuffer:Ro,readBlobAsArrayBuffer:ds,chunkedProps:er,otherSegments:No,segments:hs,tiffBlocks:Le,segmentsAndBlocks:tr,tiffExtractables:ir,inheritables:Mo,allFormatters:rr,Options:Ri,parse:Vd}),za={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},aF=Object.assign({},za,{firstChunkSize:4e4,gps:[1,2,3,4]});var lF=Object.assign({},za,{tiff:!1,ifd1:!0,mergeOutput:!1});var K0=Object.assign({},za,{firstChunkSize:4e4,ifd0:[274]});async function X0(i){let e=new sr(K0);await e.read(i);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}o(X0,"ce");var Y0=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}}),as=!0,ls=!0;if(typeof navigator=="object"){let i=navigator.userAgent;if(i.includes("iPad")||i.includes("iPhone")){let e=i.match(/OS (\d+)_(\d+)/);if(e){let[,t,r]=e;as=Number(t)+.1*Number(r)<13.4,ls=!1}}else if(i.includes("OS X 10")){let[,e]=i.match(/OS X 10[_.](\d+)/);as=ls=Number(e)<15}if(i.includes("Chrome/")){let[,e]=i.match(/Chrome\/(\d+)/);as=ls=Number(e)<81}else if(i.includes("Firefox/")){let[,e]=i.match(/Firefox\/(\d+)/);as=ls=Number(e)<77}}async function $d(i){let e=await X0(i);return Object.assign({canvas:as,css:ls},Y0[e])}o($d,"ye");var Na=class extends Ai{static{o(this,"be")}constructor(...e){super(...e),me(this,"ranges",new Ma),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,r){if(e===0&&this.byteLength===0&&r){let s=new DataView(r.buffer||r,r.byteOffset,r.byteLength);this._swapDataView(s)}else{let s=e+t;if(s>this.byteLength){let{dataView:n}=this._extend(s);this._swapDataView(n)}}}_extend(e){let t;t=jd?Bd.allocUnsafe(e):new Uint8Array(e);let r=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:r}}subarray(e,t,r=!1){return t=t||this._lengthToEnd(e),r&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,r=!1){r&&this._tryExtend(t,e.byteLength,e);let s=super.set(e,t);return this.ranges.add(t,s.byteLength),s}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}},Ma=class{static{o(this,"we")}constructor(){me(this,"list",[])}get length(){return this.list.length}add(e,t,r=0){let s=e+t,n=this.list.filter(a=>Md(e,a.offset,s)||Md(e,a.end,s));if(n.length>0){e=Math.min(e,...n.map(u=>u.offset)),s=Math.max(s,...n.map(u=>u.end)),t=s-e;let a=n.shift();a.offset=e,a.length=t,a.end=s,this.list=this.list.filter(u=>!n.includes(u))}else this.list.push({offset:e,length:t,end:s})}available(e,t){let r=e+t;return this.list.some(s=>s.offset<=e&&r<=s.end)}};function Md(i,e,t){return i<=e&&e<=t}o(Md,"ke");var La=class extends Na{static{o(this,"Oe")}constructor(e,t){super(0),me(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,r=await this.readChunk(e,t);return!!r&&r.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}};fs.set("blob",class extends La{async readWhole(){this.chunked=!1;let i=await ds(this.input);this._swapArrayBuffer(i)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(i,e){let t=e?i+e:void 0,r=this.input.slice(i,t),s=await ds(r);return this.set(s,i,!0)}});var Wd={name:"@uppy/thumbnail-generator",description:"Uppy plugin that generates small previews of images to show on your upload UI.",version:"4.2.3",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","thumbnail","preview","resize"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",exifr:"^7.0.0"},devDependencies:{jsdom:"^26.1.0","namespace-emitter":"2.0.1",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"workspace:^"}};var Gd={strings:{generatingThumbnails:"Generating thumbnails..."}};function Q0(i,e,t){try{i.getContext("2d").getImageData(0,0,1,1)}catch(r){if(r.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return i.toBlob?new Promise(r=>{i.toBlob(r,e,t)}).then(r=>{if(r===null)throw new Error("cannot read image, probably an svg with external resources");return r}):Promise.resolve().then(()=>Td(i.toDataURL(e,t),{})).then(r=>{if(r===null)throw new Error("could not extract blob, probably an old browser");return r})}o(Q0,"canvasToBlob");function Z0(i,e){let t=i.width,r=i.height;(e.deg===90||e.deg===270)&&(t=i.height,r=i.width);let s=document.createElement("canvas");s.width=t,s.height=r;let n=s.getContext("2d");return n.translate(t/2,r/2),e.canvas&&(n.rotate(e.rad),n.scale(e.scaleX,e.scaleY)),n.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),s}o(Z0,"rotateImage");function eb(i){let e=i.width/i.height,t=5e6,r=4096,s=Math.floor(Math.sqrt(t*e)),n=Math.floor(t/Math.sqrt(t*e));if(s>r&&(s=r,n=Math.round(s/e)),n>r&&(n=r,s=Math.round(e*n)),i.width>s){let a=document.createElement("canvas");return a.width=s,a.height=n,a.getContext("2d").drawImage(i,0,0,s,n),a}return i}o(eb,"protect");var tb={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1},Oi=class extends Z{static{o(this,"ThumbnailGenerator")}static VERSION=Wd.version;queue;queueProcessing;defaultThumbnailDimension;thumbnailType;constructor(e,t){if(super(e,{...tb,...t}),this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=Gd,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,r){let s=URL.createObjectURL(e.data),n=new Promise((u,c)=>{let p=new Image;p.src=s,p.addEventListener("load",()=>{URL.revokeObjectURL(s),u(p)}),p.addEventListener("error",g=>{URL.revokeObjectURL(s),c(g.error||new Error("Could not create thumbnail"))})}),a=$d(e.data).catch(()=>1);return Promise.all([n,a]).then(([u,c])=>{let p=this.getProportionalDimensions(u,t,r,c.deg),g=Z0(u,c),h=this.resizeImage(g,p.width,p.height);return Q0(h,this.thumbnailType,80)}).then(u=>URL.createObjectURL(u))}getProportionalDimensions(e,t,r,s){let n=e.width/e.height;if((s===90||s===270)&&(n=e.height/e.width),t!=null){let a=t;return e.width<t&&(a=e.width),{width:a,height:Math.round(a/n)}}if(r!=null){let a=r;return e.height<r&&(a=e.height),{width:Math.round(a*n),height:a}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/n)}}resizeImage(e,t,r){let s=eb(e),n=Math.ceil(Math.log2(s.width/t));n<1&&(n=1);let a=t*2**(n-1),u=r*2**(n-1),c=2;for(;n--;){let p=document.createElement("canvas");p.width=a,p.height=u,p.getContext("2d").drawImage(s,0,0,a,u),s=p,a=Math.round(a/c),u=Math.round(u/c)}return s}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){let e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return Ao(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)}).catch(t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)}):Promise.resolve()}onFileAdded=o(e=>{!e.preview&&e.data&&Ao(e.type)&&!e.isRemote&&this.addToQueue(e.id)},"onFileAdded");onCancelRequest=o(e=>{let t=this.queue.indexOf(e.id);t!==-1&&this.queue.splice(t,1)},"onCancelRequest");onFileRemoved=o(e=>{let t=this.queue.indexOf(e.id);t!==-1&&this.queue.splice(t,1),e.preview&&To(e.preview)&&URL.revokeObjectURL(e.preview)},"onFileRemoved");onRestored=o(()=>{this.uppy.getFiles().filter(t=>t.isRestored).forEach(t=>{(!t.preview||To(t.preview))&&this.addToQueue(t.id)})},"onRestored");onAllFilesRemoved=o(()=>{this.queue=[]},"onAllFilesRemoved");waitUntilAllProcessed=o(e=>{e.forEach(r=>{let s=this.uppy.getFile(r);this.uppy.emit("preprocess-progress",s,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});let t=o(()=>{e.forEach(r=>{let s=this.uppy.getFile(r);this.uppy.emit("preprocess-complete",s)})},"emitPreprocessCompleteForAll");return new Promise(r=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{t(),r()}):(t(),r())})},"waitUntilAllProcessed");install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}};function ib(i){if(typeof i=="string"){let e=document.querySelectorAll(i);return e.length===0?null:Array.from(e)}return typeof i=="object"&&Rr(i)?[i]:null}o(ib,"findAllDOMElements");var Ha=ib;var Be=Array.from;function qa(i){let e=Be(i.files);return Promise.resolve(e)}o(qa,"fallbackApi");function Lo(i,e,t,{onSuccess:r}){i.readEntries(s=>{let n=[...e,...s];s.length?queueMicrotask(()=>{Lo(i,n,t,{onSuccess:r})}):r(n)},s=>{t(s),r(e)})}o(Lo,"getFilesAndDirectoriesFromDirectory");function Kd(i,e){return i==null?i:{kind:i.isFile?"file":i.isDirectory?"directory":void 0,name:i.name,getFile(){return new Promise((t,r)=>i.file(t,r))},async*values(){let t=i.createReader();yield*await new Promise(s=>{Lo(t,[],e,{onSuccess:o(n=>s(n.map(a=>Kd(a,e))),"onSuccess")})})},isSameEntry:void 0}}o(Kd,"getAsFileSystemHandleFromEntry");async function*Xd(i,e,t=void 0){let r=o(()=>`${e}/${i.name}`,"getNextRelativePath");if(i.kind==="file"){let s=await i.getFile();s!=null?(s.relativePath=e?r():null,yield s):t!=null&&(yield t)}else if(i.kind==="directory")for await(let s of i.values())yield*Xd(s,e?r():i.name);else t!=null&&(yield t)}o(Xd,"createPromiseToAddFileOrParseDirectory");async function*Va(i,e){let t=await Promise.all(Array.from(i.items,async r=>{let s;return s??=Kd(o(()=>typeof r.getAsEntry=="function"?r.getAsEntry():r.webkitGetAsEntry(),"getAsEntry")(),e),{fileSystemHandle:s,lastResortFile:r.getAsFile()}}));for(let{lastResortFile:r,fileSystemHandle:s}of t)if(s!=null)try{yield*Xd(s,"",r)}catch(n){r!=null?yield r:e(n)}else r!=null&&(yield r)}o(Va,"getFilesFromDataTransfer");async function Ui(i,e){let t=e?.logDropError??Function.prototype;try{let r=[];for await(let s of Va(i,t))r.push(s);return r}catch{return qa(i)}}o(Ui,"getDroppedFiles");var Yd={name:"@uppy/dashboard",description:"Universal UI plugin for Uppy.",version:"4.4.3",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --silent='passed-only'","test:e2e":"vitest watch --project browser --browser.headless false"},keywords:["file uploader","uppy","uppy-plugin","dashboard","ui"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@transloadit/prettier-bytes":"^0.3.4","@uppy/informer":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/status-bar":"workspace:^","@uppy/thumbnail-generator":"workspace:^","@uppy/utils":"workspace:^",classnames:"^2.2.6",lodash:"^4.17.21",nanoid:"^5.0.9",preact:"^10.5.13","shallow-equal":"^3.0.0"},devDependencies:{"@uppy/core":"workspace:^","@uppy/google-drive":"workspace:^","@uppy/status-bar":"workspace:^","@uppy/url":"workspace:^","@uppy/webcam":"workspace:^","@vitest/browser":"^3.2.4",cssnano:"^7.0.7",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1","resize-observer-polyfill":"^1.5.0",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"workspace:^"}};function gs(){let i=document.body;return!(!("draggable"in i)||!("ondragstart"in i&&"ondrop"in i)||!("FormData"in window)||!("FileReader"in window))}o(gs,"isDragDropSupported");var fh=de(ot(),1);var $a=class extends ge{static{o(this,"AddFiles")}fileInput=null;folderInput=null;mobilePhotoFileInput=null;mobileVideoFileInput=null;triggerFileInputClick=o(()=>{this.fileInput?.click()},"triggerFileInputClick");triggerFolderInputClick=o(()=>{this.folderInput?.click()},"triggerFolderInputClick");triggerVideoCameraInputClick=o(()=>{this.mobileVideoFileInput?.click()},"triggerVideoCameraInputClick");triggerPhotoCameraInputClick=o(()=>{this.mobilePhotoFileInput?.click()},"triggerPhotoCameraInputClick");onFileInputChange=o(e=>{this.props.handleInputChange(e),e.currentTarget.value=""},"onFileInputChange");renderHiddenInput=o((e,t)=>l("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes?.join(", "),ref:t}),"renderHiddenInput");renderHiddenCameraInput=o((e,t,r)=>{let n={photo:"image/*",video:"video/*"}[e];return l("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${e}`,onChange:this.onFileInputChange,capture:t===""?"environment":t,accept:n,ref:r})},"renderHiddenCameraInput");renderMyDeviceAcquirer=o(()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})}),"renderMyDeviceAcquirer");renderPhotoCamera=o(()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})}),"renderPhotoCamera");renderVideoCamera=o(()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})}),"renderVideoCamera");renderBrowseButton=o((e,t)=>{let r=this.props.acquirers.length;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:t,"data-uppy-super-focusable":r===0,children:e})},"renderBrowseButton");renderDropPasteBrowseTagline=o(e=>{let t=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),r=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),s=this.props.fileManagerSelectionType,n=s.charAt(0).toUpperCase()+s.slice(1);return l("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):e>0?this.props.i18nArray(`dropPasteImport${n}`,{browseFiles:t,browseFolders:r,browse:t}):this.props.i18nArray(`dropPaste${n}`,{browseFiles:t,browseFolders:r,browse:t})})},"renderDropPasteBrowseTagline");[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderAcquirer=o(e=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id,children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":e.id,"aria-controls":`uppy-DashboardContent-panel--${e.id}`,"aria-selected":this.props.activePickerPanel?.id===e.id,"data-uppy-super-focusable":!0,onClick:o(()=>this.props.showPanel(e.id),"onClick"),children:[l("div",{className:"uppy-DashboardTab-inner",children:e.icon()}),l("div",{className:"uppy-DashboardTab-name",children:e.name})]})}),"renderAcquirer");renderAcquirers=o(e=>{let t=[...e],r=t.splice(e.length-2,e.length);return l(_e,{children:[t.map(s=>this.renderAcquirer(s)),l("span",{role:"presentation",style:{"white-space":"nowrap"},children:r.map(s=>this.renderAcquirer(s))})]})},"renderAcquirers");renderSourcesList=o((e,t)=>{let{showNativePhotoCameraButton:r,showNativeVideoCameraButton:s}=this.props,n=[],a="myDevice";t||n.push({key:a,elements:this.renderMyDeviceAcquirer()}),r&&n.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),s&&n.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),n.push(...e.map(g=>({key:g.id,elements:this.renderAcquirer(g)}))),n.length===1&&n[0].key===a&&(n=[]);let c=[...n],p=c.splice(n.length-2,n.length);return l(_e,{children:[this.renderDropPasteBrowseTagline(n.length),l("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[c.map(({key:g,elements:h})=>l(_e,{children:h},g)),l("span",{role:"presentation",style:{"white-space":"nowrap"},children:p.map(({key:g,elements:h})=>l(_e,{children:h},g))})]})]})},"renderSourcesList");renderPoweredByUppy(){let{i18nArray:e}=this.props,t=l("span",{children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:l("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),l("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),r=e("poweredBy",{uppy:t});return l("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:r})}render(){let{showNativePhotoCameraButton:e,showNativeVideoCameraButton:t,nativeCameraFacingMode:r}=this.props;return l("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,s=>{this.fileInput=s}),this.renderHiddenInput(!0,s=>{this.folderInput=s}),e&&this.renderHiddenCameraInput("photo",r,s=>{this.mobilePhotoFileInput=s}),t&&this.renderHiddenCameraInput("video",r,s=>{this.mobileVideoFileInput=s}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),l("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&l("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}},Bo=$a;var Jd=de(ot(),1);var sb=o(i=>l("div",{className:(0,Jd.default)("uppy-Dashboard-AddFilesPanel",i.className),"data-uppy-panelType":"AddFiles","aria-hidden":!i.showAddFilesPanel,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i.i18n("addingMoreFiles")}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:o(()=>i.toggleAddFilesPanel(!1),"onClick"),children:i.i18n("back")})]}),l(Bo,{...i})]}),"AddFilesPanel"),Qd=sb;var Zd=de(ot(),1);function ob(i){let e=i.files[i.fileCardFor],t=o(()=>{i.uppy.emit("file-editor:cancel",e),i.closeFileEditor()},"handleCancel");return l("div",{className:(0,Zd.default)("uppy-DashboardContent-panel",i.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i.i18nArray("editing",{file:l("span",{className:"uppy-DashboardContent-titleFile",children:e.meta?e.meta.name:e.name})})}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:i.i18n("cancel")}),l("button",{className:"uppy-DashboardContent-save",type:"button",onClick:i.saveFileEditor,children:i.i18n("save")})]}),l("div",{className:"uppy-DashboardContent-panelBody",children:i.editors.map(r=>i.uppy.getPlugin(r.id).render(i.state))})]})}o(ob,"EditorPanel");var eh=ob;var th=de(ot(),1);function nb(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:l("g",{fill:"#686DE0",fillRule:"evenodd",children:[l("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),l("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),l("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}o(nb,"iconImage");function ab(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}o(ab,"iconAudio");function lb(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}o(lb,"iconVideo");function ub(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}o(ub,"iconPDF");function cb(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}o(cb,"iconArchive");function pb(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[l("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),l("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}o(pb,"iconFile");function db(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}o(db,"iconText");function Di(i){let e={color:"#838999",icon:pb()};if(!i)return e;let t=i.split("/")[0],r=i.split("/")[1];return t==="text"?{color:"#5a5e69",icon:db()}:t==="image"?{color:"#686de0",icon:nb()}:t==="audio"?{color:"#068dbb",icon:ab()}:t==="video"?{color:"#19af67",icon:lb()}:t==="application"&&r==="pdf"?{color:"#e25149",icon:ub()}:t==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(r)!==-1?{color:"#00C469",icon:cb()}:e}o(Di,"getIconByMime");function hb(i){let{tagName:e}=i.target;if(e==="INPUT"||e==="TEXTAREA"){i.stopPropagation();return}i.preventDefault(),i.stopPropagation()}o(hb,"ignoreEvent");var Ot=hb;function ys(i){let{file:e}=i;if(e.preview)return l("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:e.name,src:e.preview});let{color:t,icon:r}=Di(e.type);return l("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[l("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:t},children:r}),l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:l("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}o(ys,"FilePreview");function Wa(i){let{computedMetaFields:e,requiredMetaFields:t,updateMeta:r,form:s,formState:n}=i,a={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map(u=>{let c=`uppy-Dashboard-FileCard-input-${u.id}`,p=t.includes(u.id);return l("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[l("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:c,children:u.name}),u.render!==void 0?u.render({value:n[u.id],onChange:o(g=>r(g,u.id),"onChange"),fieldCSSClasses:a,required:p,form:s.id},jt):l("input",{className:a.text,id:c,form:s.id,type:u.type||"text",required:p,value:n[u.id],placeholder:u.placeholder,onInput:o(g=>r(g.target.value,u.id),"onInput"),"data-uppy-super-focusable":!0})]},u.id)})}o(Wa,"RenderMetaFields");function Ga(i){let{files:e,fileCardFor:t,toggleFileCard:r,saveFileCard:s,metaFields:n,requiredMetaFields:a,openFileEditor:u,i18n:c,i18nArray:p,className:g,canEditFile:h}=i,b=o(()=>typeof n=="function"?n(e[t]):n,"getMetaFields"),P=e[t],F=b()??[],M=h(P),C={};F.forEach(K=>{C[K.id]=P.meta[K.id]??""});let[O,U]=Xe(C),A=Ye(K=>{K.preventDefault(),s(O,t)},[s,O,t]),J=o((K,te)=>{U({...O,[te]:K})},"updateMeta"),G=o(()=>{r(!1)},"handleCancel"),[W]=Xe(()=>{let K=document.createElement("form");return K.setAttribute("tabindex","-1"),K.id=wt(),K});return Ne(()=>(document.body.appendChild(W),W.addEventListener("submit",A),()=>{W.removeEventListener("submit",A),document.body.removeChild(W)}),[W,A]),l("div",{className:(0,th.default)("uppy-Dashboard-FileCard",g),"data-uppy-panelType":"FileCard",onDragOver:Ot,onDragLeave:Ot,onDrop:Ot,onPaste:Ot,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:p("editing",{file:l("span",{className:"uppy-DashboardContent-titleFile",children:P.meta?P.meta.name:P.name})})}),l("button",{className:"uppy-DashboardContent-back",type:"button",form:W.id,title:c("finishEditingFile"),onClick:G,children:c("cancel")})]}),l("div",{className:"uppy-Dashboard-FileCard-inner",children:[l("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:Di(P.type).color},children:[l(ys,{file:P}),M&&l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:o(K=>{A(K),u(P)},"onClick"),children:c("editImage")})]}),l("div",{className:"uppy-Dashboard-FileCard-info",children:l(Wa,{computedMetaFields:F,requiredMetaFields:a,updateMeta:J,form:W,formState:O})}),l("div",{className:"uppy-Dashboard-FileCard-actions",children:[l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:W.id,children:c("saveChanges")}),l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:G,form:W.id,children:c("cancel")})]})]})]})}o(Ga,"FileCard");var oh=de(ot(),1);function ih(i,e){if(i===e)return!0;if(!i||!e)return!1;let t=Object.keys(i),r=Object.keys(e),s=t.length;if(r.length!==s)return!1;for(let n=0;n<s;n++){let a=t[n];if(i[a]!==e[a]||!Object.prototype.hasOwnProperty.call(e,a))return!1}return!0}o(ih,"shallowEqualObjects");function Ka(i,e="Copy the URL below"){return new Promise(t=>{let r=document.createElement("textarea");r.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),r.value=i,document.body.appendChild(r),r.select();let s=o(()=>{document.body.removeChild(r),window.prompt(e,i),t()},"magicCopyFailed");try{return document.execCommand("copy")?(document.body.removeChild(r),t()):s()}catch{return document.body.removeChild(r),s()}})}o(Ka,"copyToClipboard");function fb({file:i,uploadInProgressOrComplete:e,metaFields:t,canEditFile:r,i18n:s,onClick:n}){return!e&&t&&t.length>0||!e&&r(i)?l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":s("editFileWithFilename",{file:i.meta.name}),title:s("editFileWithFilename",{file:i.meta.name}),onClick:o(()=>n(),"onClick"),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:l("g",{fillRule:"evenodd",children:[l("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),l("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),l("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}o(fb,"EditButton");function mb({i18n:i,onClick:e,file:t}){return l("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":i("removeFile",{file:t.meta.name}),title:i("removeFile",{file:t.meta.name}),onClick:o(()=>e(),"onClick"),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[l("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),l("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}o(mb,"RemoveButton");function gb({file:i,uppy:e,i18n:t}){let r=o(s=>{Ka(i.uploadURL,t("copyLinkToClipboardFallback")).then(()=>{e.log("Link copied to clipboard."),e.info(t("copyLinkToClipboardSuccess"),"info",3e3)}).catch(e.log).then(()=>s.target.focus({preventScroll:!0}))},"copyLinkToClipboard");return l("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":t("copyLink"),title:t("copyLink"),onClick:o(s=>r(s),"onClick"),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:l("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}o(gb,"CopyLinkButton");function Xa(i){let{uppy:e,file:t,uploadInProgressOrComplete:r,canEditFile:s,metaFields:n,showLinkToFileUploadResult:a,showRemoveButton:u,i18n:c,toggleFileCard:p,openFileEditor:g}=i;return l("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[l(fb,{i18n:c,file:t,uploadInProgressOrComplete:r,canEditFile:s,metaFields:n,onClick:o(()=>{n&&n.length>0?p(!0,t.id):g(t)},"editAction")}),a&&t.uploadURL?l(gb,{file:t,uppy:e,i18n:c}):null,u?l(mb,{i18n:c,file:t,onClick:o(()=>e.removeFile(t.id),"onClick")}):null]})}o(Xa,"Buttons");var rh=de(Hr(),1);var Ya="...";function jo(i,e){if(e===0)return"";if(i.length<=e)return i;if(e<=Ya.length+1)return`${i.slice(0,e-1)}\u2026`;let t=e-Ya.length,r=Math.ceil(t/2),s=Math.floor(t/2);return i.slice(0,r)+Ya+i.slice(-s)}o(jo,"truncateString");var yb=o((i,e)=>(typeof e=="function"?e():e).filter(s=>s.id===i)[0].name,"metaFieldIdToName");function vs(i){let{file:e,toggleFileCard:t,i18n:r,metaFields:s}=i,{missingRequiredMetaFields:n}=e;if(!n?.length)return null;let a=n.map(u=>yb(u,s)).join(", ");return l("div",{className:"uppy-Dashboard-Item-errorMessage",children:[r("missingRequiredMetaFields",{smart_count:n.length,fields:a})," ",l("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:o(()=>t(!0,e.id),"onClick"),children:r("editFile")})]})}o(vs,"MetaErrorMessage");var vb=o(i=>{let{author:e,name:t}=i.file.meta;function r(){return i.isSingleFile&&i.containerHeight>=350?90:i.containerWidth<=352?35:i.containerWidth<=576?60:e?20:30}return o(r,"getMaxNameLength"),l("div",{className:"uppy-Dashboard-Item-name",title:t,children:jo(t,r())})},"renderFileName"),bb=o(i=>{let{author:e}=i.file.meta,t=i.file.remote?.providerName,r="\xB7";return e?l("div",{className:"uppy-Dashboard-Item-author",children:[l("a",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:jo(e.name,13)}),t?l(_e,{children:[` ${r} `,t,` ${r} `]}):null]}):null},"renderAuthor"),wb=o(i=>i.file.size&&l("div",{className:"uppy-Dashboard-Item-statusSize",children:(0,rh.default)(i.file.size)}),"renderFileSize"),Sb=o(i=>i.file.isGhost&&l("span",{children:[" \u2022 ",l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:o(()=>i.toggleAddFilesPanel(!0),"onClick"),children:i.i18n("reSelect")})]}),"ReSelectButton"),xb=o(({file:i,onClick:e})=>i.error?l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":i.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:e,type:"button",children:"?"}):null,"ErrorButton");function Ja(i){let{file:e,i18n:t,toggleFileCard:r,metaFields:s,toggleAddFilesPanel:n,isSingleFile:a,containerHeight:u,containerWidth:c}=i;return l("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.source,children:[l("div",{className:"uppy-Dashboard-Item-fileName",children:[vb({file:e,isSingleFile:a,containerHeight:u,containerWidth:c}),l(xb,{file:e,onClick:o(()=>alert(e.error),"onClick")})]}),l("div",{className:"uppy-Dashboard-Item-status",children:[bb({file:e}),wb({file:e}),Sb({file:e,toggleAddFilesPanel:n,i18n:t})]}),l(vs,{file:e,i18n:t,toggleFileCard:r,metaFields:s})]})}o(Ja,"FileInfo");function Qa(i){let{file:e,i18n:t,toggleFileCard:r,metaFields:s,showLinkToFileUploadResult:n}=i,u=e.preview?"rgba(255, 255, 255, 0.5)":Di(e.type).color;return l("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:u},children:[n&&e.uploadURL&&l("a",{className:"uppy-Dashboard-Item-previewLink",href:e.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.meta.name,children:l("span",{hidden:!0,children:e.meta.name})}),l(ys,{file:e}),l(vs,{file:e,i18n:t,toggleFileCard:r,metaFields:s})]})}o(Qa,"FilePreviewAndLink");function _b(i){if(!i.isUploaded){if(i.error&&!i.hideRetryButton){i.uppy.retryUpload(i.file.id);return}i.resumableUploads&&!i.hidePauseResumeButton?i.uppy.pauseResume(i.file.id):i.individualCancellation&&!i.hideCancelButton&&i.uppy.removeFile(i.file.id)}}o(_b,"onPauseResumeCancelRetry");function sh(i){return i.isUploaded?i.i18n("uploadComplete"):i.error?i.i18n("retryUpload"):i.resumableUploads?i.file.isPaused?i.i18n("resumeUpload"):i.i18n("pauseUpload"):i.individualCancellation?i.i18n("cancelUpload"):""}o(sh,"progressIndicatorTitle");function Za(i){return l("div",{className:"uppy-Dashboard-Item-progress",children:l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":sh(i),title:sh(i),onClick:o(()=>_b(i),"onClick"),children:i.children})})}o(Za,"ProgressIndicatorButton");function zo({children:i}){return l("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:i})}o(zo,"ProgressCircleContainer");function el({progress:i}){let e=2*Math.PI*15;return l("g",{children:[l("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),l("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":e,"stroke-dashoffset":e-e/100*i})]})}o(el,"ProgressCircle");function tl(i){return!i.file.progress.uploadStarted||i.file.progress.percentage===void 0?null:i.isUploaded?l("div",{className:"uppy-Dashboard-Item-progress",children:l("div",{className:"uppy-Dashboard-Item-progressIndicator",children:l(zo,{children:[l("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),l("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):i.recoveredState?null:i.error&&!i.hideRetryButton?l(Za,{...i,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[l("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),l("path",{d:"M7.9 3H10v2H7.9z"}),l("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),l("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})}):i.resumableUploads&&!i.hidePauseResumeButton?l(Za,{...i,children:l(zo,{children:[l(el,{progress:i.file.progress.percentage}),i.file.isPaused?l("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):l("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[l("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),l("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})}):!i.resumableUploads&&i.individualCancellation&&!i.hideCancelButton?l(Za,{...i,children:l(zo,{children:[l(el,{progress:i.file.progress.percentage}),l("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})}):l("div",{className:"uppy-Dashboard-Item-progress",children:l("div",{className:"uppy-Dashboard-Item-progressIndicator",children:l(zo,{children:l(el,{progress:i.file.progress.percentage})})})})}o(tl,"FileProgress");var bs=class extends ge{static{o(this,"FileItem")}componentDidMount(){let{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!ih(this.props,e)}componentDidUpdate(){let{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){let{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){let{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,r=!!e.progress.uploadComplete&&!t&&!e.error,s=!!e.progress.uploadStarted||!!t,n=e.progress.uploadStarted&&!e.progress.uploadComplete||t,a=e.error||!1,{isGhost:u}=e,c=(this.props.individualCancellation||!n)&&!r;r&&this.props.showRemoveButtonAfterComplete&&(c=!0);let p=(0,oh.default)({"uppy-Dashboard-Item":!0,"is-inprogress":n&&!this.props.recoveredState,"is-processing":t,"is-complete":r,"is-error":!!a,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":u});return l("div",{className:p,id:`uppy_${e.id}`,role:this.props.role,children:[l("div",{className:"uppy-Dashboard-Item-preview",children:[l(Qa,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),l(tl,{uppy:this.props.uppy,file:e,error:a,isUploaded:r,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),l("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[l(Ja,{file:e,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),l(Xa,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:c,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:s,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}};function Pb(i,e){let t=[],r=[];return i.forEach(s=>{r.length<e?r.push(s):(t.push(r),r=[s])}),r.length&&t.push(r),t}o(Pb,"chunks");function il({id:i,i18n:e,uppy:t,files:r,resumableUploads:s,hideRetryButton:n,hidePauseResumeButton:a,hideCancelButton:u,showLinkToFileUploadResult:c,showRemoveButtonAfterComplete:p,metaFields:g,isSingleFile:h,toggleFileCard:b,handleRequestThumbnail:P,handleCancelThumbnail:F,recoveredState:M,individualCancellation:C,itemsPerRow:O,openFileEditor:U,canEditFile:A,toggleAddFilesPanel:J,containerWidth:G,containerHeight:W}){let K=O===1?71:200,te=Qt(()=>{let be=o((Pe,ye)=>Number(r[ye].isGhost)-Number(r[Pe].isGhost),"sortByGhostComesFirst"),ne=Object.keys(r);return M&&ne.sort(be),Pb(ne,O)},[r,O,M]),Q=o(be=>l("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:be.map(ne=>l(bs,{uppy:t,id:i,i18n:e,resumableUploads:s,individualCancellation:C,hideRetryButton:n,hidePauseResumeButton:a,hideCancelButton:u,showLinkToFileUploadResult:c,showRemoveButtonAfterComplete:p,metaFields:g,recoveredState:M,isSingleFile:h,containerWidth:G,containerHeight:W,toggleFileCard:b,handleRequestThumbnail:P,handleCancelThumbnail:F,role:"listitem",openFileEditor:U,canEditFile:A,toggleAddFilesPanel:J,file:r[ne]},ne))},be[0]),"renderRow");return h?l("div",{class:"uppy-Dashboard-files",children:Q(te[0])}):l(Wr,{class:"uppy-Dashboard-files",role:"list",data:te,renderRow:Q,rowHeight:K})}o(il,"FileList");var nh=de(ot(),1);function kb({activePickerPanel:i,className:e,hideAllPanels:t,i18n:r,state:s,uppy:n}){let a=it(null);return l("div",{className:(0,nh.default)("uppy-DashboardContent-panel",e),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${i.id}`,onDragOver:Ot,onDragLeave:Ot,onDrop:Ot,onPaste:Ot,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:r("importFrom",{name:i.name})}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:r("cancel")})]}),l("div",{ref:a,className:"uppy-DashboardContent-panelBody",children:n.getPlugin(i.id).render(s,a.current)})]})}o(kb,"PickerPanelContent");var ah=kb;var Ut={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function Eb(i,e,t,r={}){if(i)return Ut.STATE_ERROR;if(e)return Ut.STATE_COMPLETE;if(t)return Ut.STATE_PAUSED;let s=Ut.STATE_WAITING,n=Object.keys(r);for(let a=0;a<n.length;a++){let{progress:u}=r[n[a]];if(u.uploadStarted&&!u.uploadComplete)return Ut.STATE_UPLOADING;u.preprocess&&s!==Ut.STATE_UPLOADING&&(s=Ut.STATE_PREPROCESSING),u.postprocess&&s!==Ut.STATE_UPLOADING&&s!==Ut.STATE_PREPROCESSING&&(s=Ut.STATE_POSTPROCESSING)}return s}o(Eb,"getUploadingState");function Fb({files:i,i18n:e,isAllComplete:t,isAllErrored:r,isAllPaused:s,inProgressNotPausedFiles:n,newFiles:a,processingFiles:u}){switch(Eb(r,t,s,i)){case"uploading":return e("uploadingXFiles",{smart_count:n.length});case"preprocessing":case"postprocessing":return e("processingXFiles",{smart_count:u.length});case"paused":return e("uploadPaused");case"waiting":return e("xFilesSelected",{smart_count:a.length});case"complete":return e("uploadComplete");case"error":return e("error");default:}}o(Fb,"UploadStatus");function Cb(i){let{i18n:e,isAllComplete:t,hideCancelButton:r,maxNumberOfFiles:s,toggleAddFilesPanel:n,uppy:a}=i,{allowNewUpload:u}=i;return u&&s&&(u=i.totalFileCount<i.maxNumberOfFiles),l("div",{className:"uppy-DashboardContent-bar",children:[!t&&!r?l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:o(()=>a.cancelAll(),"onClick"),children:e("cancel")}):l("div",{}),l("div",{className:"uppy-DashboardContent-title",children:l(Fb,{...i})}),u?l("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":e("addMoreFiles"),title:e("addMoreFiles"),onClick:o(()=>n(!0),"onClick"),children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:l("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),l("span",{className:"uppy-DashboardContent-addMoreCaption",children:e("addMore")})]}):l("div",{})]})}o(Cb,"PanelTopBar");var lh=Cb;var ch=de(ot(),1);var or="uppy-transition-slideDownUp",uh=250;function Tb({children:i}){let[e,t]=Xe(null),[r,s]=Xe(""),n=it(),a=it(),u=it(),c=Ye(()=>{s(`${or}-enter`),cancelAnimationFrame(u.current),clearTimeout(a.current),a.current=void 0,u.current=requestAnimationFrame(()=>{s(`${or}-enter ${or}-enter-active`),n.current=setTimeout(()=>{s("")},uh)})},[]),p=Ye(()=>{s(`${or}-leave`),cancelAnimationFrame(u.current),clearTimeout(n.current),n.current=void 0,u.current=requestAnimationFrame(()=>{s(`${or}-leave ${or}-leave-active`),a.current=setTimeout(()=>{t(null),s("")},uh)})},[]);return Ne(()=>{let g=ut(i)[0];e!==g&&(g&&!e?c():e&&!g&&!a.current&&p(),t(g))},[i,e,c,p]),Ne(()=>()=>{clearTimeout(n.current),clearTimeout(a.current),cancelAnimationFrame(u.current)},[]),e?Nr(e,{className:(0,ch.default)(r,e.props.className)}):null}o(Tb,"Slide");var ws=Tb;var ph=900,dh=700,rl=576,hh=330;function sl(i){let e=i.totalFileCount===0,t=i.totalFileCount===1,r=i.containerWidth>rl,s=i.containerHeight>hh,n=(0,fh.default)({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":i.disabled,"uppy-Dashboard--animateOpenClose":i.animateOpenClose,"uppy-Dashboard--isClosing":i.isClosing,"uppy-Dashboard--isDraggingOver":i.isDraggingOver,"uppy-Dashboard--modal":!i.inline,"uppy-size--md":i.containerWidth>rl,"uppy-size--lg":i.containerWidth>dh,"uppy-size--xl":i.containerWidth>ph,"uppy-size--height-md":i.containerHeight>hh,"uppy-Dashboard--isAddFilesPanelVisible":i.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":i.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":i.singleFileFullScreen&&t&&s}),a=1;i.containerWidth>ph?a=5:i.containerWidth>dh?a=4:i.containerWidth>rl&&(a=3);let u=i.showSelectedFiles&&!e,c=i.recoveredState?Object.keys(i.recoveredState.files).length:null,p=i.files?Object.keys(i.files).filter(b=>i.files[b].isGhost).length:0,g=o(()=>p>0?i.i18n("recoveredXFiles",{smart_count:p}):i.i18n("recoveredAllFiles"),"renderRestoredText");return l("div",{className:n,"data-uppy-theme":i.theme,"data-uppy-num-acquirers":i.acquirers.length,"data-uppy-drag-drop-supported":!i.disableLocalFiles&&gs(),"aria-hidden":i.inline?"false":i.isHidden,"aria-disabled":i.disabled,"aria-label":i.inline?i.i18n("dashboardTitle"):i.i18n("dashboardWindowTitle"),onPaste:i.handlePaste,onDragOver:i.handleDragOver,onDragLeave:i.handleDragLeave,onDrop:i.handleDrop,children:[l("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:i.handleClickOutside}),l("div",{className:"uppy-Dashboard-inner",role:i.inline?void 0:"dialog",style:{width:i.inline&&i.width?i.width:"",height:i.inline&&i.height?i.height:""},children:[i.inline?null:l("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":i.i18n("closeModal"),title:i.i18n("closeModal"),onClick:i.closeModal,children:l("span",{"aria-hidden":"true",children:"\xD7"})}),l("div",{className:"uppy-Dashboard-innerWrap",children:[l("div",{className:"uppy-Dashboard-dropFilesHereHint",children:i.i18n("dropHint")}),u&&l(lh,{...i}),c&&l("div",{className:"uppy-Dashboard-serviceMsg",children:[l("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:l("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[l("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),l("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),l("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),l("strong",{className:"uppy-Dashboard-serviceMsg-title",children:i.i18n("sessionRestored")}),l("div",{className:"uppy-Dashboard-serviceMsg-text",children:g()})]}),u?l(il,{id:i.id,i18n:i.i18n,uppy:i.uppy,files:i.files,resumableUploads:i.resumableUploads,hideRetryButton:i.hideRetryButton,hidePauseResumeButton:i.hidePauseResumeButton,hideCancelButton:i.hideCancelButton,showLinkToFileUploadResult:i.showLinkToFileUploadResult,showRemoveButtonAfterComplete:i.showRemoveButtonAfterComplete,metaFields:i.metaFields,toggleFileCard:i.toggleFileCard,handleRequestThumbnail:i.handleRequestThumbnail,handleCancelThumbnail:i.handleCancelThumbnail,recoveredState:i.recoveredState,individualCancellation:i.individualCancellation,openFileEditor:i.openFileEditor,canEditFile:i.canEditFile,toggleAddFilesPanel:i.toggleAddFilesPanel,isSingleFile:t,itemsPerRow:a,containerWidth:i.containerWidth,containerHeight:i.containerHeight}):l(Bo,{i18n:i.i18n,i18nArray:i.i18nArray,acquirers:i.acquirers,handleInputChange:i.handleInputChange,maxNumberOfFiles:i.maxNumberOfFiles,allowedFileTypes:i.allowedFileTypes,showNativePhotoCameraButton:i.showNativePhotoCameraButton,showNativeVideoCameraButton:i.showNativeVideoCameraButton,nativeCameraFacingMode:i.nativeCameraFacingMode,showPanel:i.showPanel,activePickerPanel:i.activePickerPanel,disableLocalFiles:i.disableLocalFiles,fileManagerSelectionType:i.fileManagerSelectionType,note:i.note,proudlyDisplayPoweredByUppy:i.proudlyDisplayPoweredByUppy}),l(ws,{children:i.showAddFilesPanel?l(Qd,{...i,isSizeMD:r},"AddFiles"):null}),l(ws,{children:i.fileCardFor?l(Ga,{...i},"FileCard"):null}),l(ws,{children:i.activePickerPanel?l(ah,{...i},"Picker"):null}),l(ws,{children:i.showFileEditor?l(eh,{...i},"Editor"):null}),l("div",{className:"uppy-Dashboard-progressindicators",children:i.progressindicators.map(b=>i.uppy.getPlugin(b.id).render(i.state))})]})]})]})}o(sl,"Dashboard");var mh={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video"}};var Ho=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];var gh=de(On(),1);function Ss(i,e){if(e){let t=i.querySelector(`[data-uppy-paneltype="${e}"]`);if(t)return t}return i}o(Ss,"getActiveOverlayEl");function ol(){let i=!1;return(0,gh.default)(o((t,r)=>{let s=Ss(t,r),n=s.contains(document.activeElement);if(n&&i)return;let a=s.querySelector("[data-uppy-super-focusable]");n&&!a||(a?(a.focus({preventScroll:!0}),i=!0):(s.querySelector(Ho)?.focus({preventScroll:!0}),i=!1))},"superFocus"),260)}o(ol,"createSuperFocus");function yh(i,e){let t=e[0];t&&(t.focus(),i.preventDefault())}o(yh,"focusOnFirstNode");function Ab(i,e){let t=e[e.length-1];t&&(t.focus(),i.preventDefault())}o(Ab,"focusOnLastNode");function Rb(i){return i.contains(document.activeElement)}o(Rb,"isFocusInOverlay");function nl(i,e,t){let r=Ss(t,e),s=Be(r.querySelectorAll(Ho)),n=s.indexOf(document.activeElement);Rb(r)?i.shiftKey&&n===0?Ab(i,s):!i.shiftKey&&n===s.length-1&&yh(i,s):yh(i,s)}o(nl,"trapFocus");function vh(i,e,t){e===null||nl(i,e,t)}o(vh,"forInline");var bh=9,Ub=27;function wh(){let i={};return i.promise=new Promise((e,t)=>{i.resolve=e,i.reject=t}),i}o(wh,"createPromise");var Db={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:Xi,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:o(()=>{},"onDragLeave"),onDragOver:o(()=>{},"onDragOver"),onDrop:o(()=>{},"onDrop"),plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550},nr=class extends Z{static{o(this,"Dashboard")}static VERSION=Yd.version;#e;modalName=`uppy-Dashboard-${wt()}`;superFocus=ol();ifFocusedOnUppyRecently=!1;dashboardIsDisabled;savedScrollPosition;savedActiveElement;resizeObserver;darkModeMediaQuery;makeDashboardInsidesVisibleAnywayTimeout;constructor(e,t){let r=t?.autoOpen??null;super(e,{...Db,...t,autoOpen:r}),this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=mh,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),this.opts.onRequestCloseModal??=()=>this.closeModal(),this.i18nInit()}removeTarget=o(e=>{let r=this.getPluginState().targets.filter(s=>s.id!==e.id);this.setPluginState({targets:r})},"removeTarget");addTarget=o(e=>{let t=e.id||e.constructor.name,r=e.title||t,s=e.type;if(s!=="acquirer"&&s!=="progressindicator"&&s!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;let n={id:t,name:r,type:s},u=this.getPluginState().targets.slice();return u.push(n),this.setPluginState({targets:u}),this.el},"addTarget");hideAllPanels=o(()=>{let e=this.getPluginState(),t={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};e.activePickerPanel===t.activePickerPanel&&e.showAddFilesPanel===t.showAddFilesPanel&&e.showFileEditor===t.showFileEditor&&e.activeOverlayType===t.activeOverlayType||(this.setPluginState(t),this.uppy.emit("dashboard:close-panel",e.activePickerPanel?.id))},"hideAllPanels");showPanel=o(e=>{let{targets:t}=this.getPluginState(),r=t.find(s=>s.type==="acquirer"&&s.id===e);this.setPluginState({activePickerPanel:r,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",e)},"showPanel");canEditFile=o(e=>{let{targets:t}=this.getPluginState();return this.#l(t).some(s=>this.uppy.getPlugin(s.id).canEditFile(e))},"canEditFile");openFileEditor=o(e=>{let{targets:t}=this.getPluginState(),r=this.#l(t);this.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),r.forEach(s=>{this.uppy.getPlugin(s.id).selectFile(e)})},"openFileEditor");closeFileEditor=o(()=>{let{metaFields:e}=this.getPluginState();e&&e.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})},"closeFileEditor");saveFileEditor=o(()=>{let{targets:e}=this.getPluginState();this.#l(e).forEach(r=>{this.uppy.getPlugin(r.id).save()}),this.closeFileEditor()},"saveFileEditor");openModal=o(()=>{let{promise:e,resolve:t}=wh();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){let r=o(()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",r,!1),t()},"handler");this.el.addEventListener("animationend",r,!1)}else this.setPluginState({isHidden:!1}),t();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),e},"openModal");closeModal=o(e=>{let t=e?.manualClose??!0,{isHidden:r,isClosing:s}=this.getPluginState();if(r||s)return;let{promise:n,resolve:a}=wh();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});let u=o(()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",u,!1),a()},"handler");this.el.addEventListener("animationend",u,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),a();return document.removeEventListener("keydown",this.handleKeyDownInModal),t&&this.opts.browserBackButtonClose&&history.state?.[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),n},"closeModal");isModalOpen=o(()=>!this.getPluginState().isHidden||!1,"isModalOpen");requestCloseModal=o(()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal(),"requestCloseModal");setDarkModeCapability=o(e=>{let{capabilities:t}=this.uppy.getState();this.uppy.setState({capabilities:{...t,darkMode:e}})},"setDarkModeCapability");handleSystemDarkModeChange=o(e=>{let t=e.matches;this.uppy.log(`[Dashboard] Dark mode is ${t?"on":"off"}`),this.setDarkModeCapability(t)},"handleSystemDarkModeChange");toggleFileCard=o((e,t)=>{let r=this.uppy.getFile(t);e?this.uppy.emit("dashboard:file-edit-start",r):this.uppy.emit("dashboard:file-edit-complete",r),this.setPluginState({fileCardFor:e?t:null,activeOverlayType:e?"FileCard":null})},"toggleFileCard");toggleAddFilesPanel=o(e=>{this.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})},"toggleAddFilesPanel");addFiles=o(e=>{let t=e.map(r=>({source:this.id,name:r.name,type:r.type,data:r,meta:{relativePath:r.relativePath||r.webkitRelativePath||null}}));try{this.uppy.addFiles(t)}catch(r){this.uppy.log(r)}},"addFiles");startListeningToResize=o(()=>{this.resizeObserver=new ResizeObserver(e=>{let t=e[0],{width:r,height:s}=t.contentRect;this.setPluginState({containerWidth:r,containerHeight:s,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{let e=this.getPluginState(),t=!this.opts.inline&&e.isHidden;!e.areInsidesReadyToBeVisible&&!t&&(this.uppy.log("[Dashboard] resize event didn\u2019t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)},"startListeningToResize");stopListeningToResize=o(()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)},"stopListeningToResize");recordIfFocusedOnUppyRecently=o(e=>{this.el.contains(e.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())},"recordIfFocusedOnUppyRecently");disableInteractiveElements=o(e=>{let t=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],r=this.#e??Be(this.el.querySelectorAll(t)).filter(s=>!s.classList.contains("uppy-Dashboard-close"));for(let s of r)s.tagName==="A"?s.setAttribute("aria-disabled",e):s.disabled=e;e?this.#e=r:this.#e=null,this.dashboardIsDisabled=e},"disableInteractiveElements");updateBrowserHistory=o(()=>{history.state?.[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},""),window.addEventListener("popstate",this.handlePopState,!1)},"updateBrowserHistory");handlePopState=o(e=>{this.isModalOpen()&&(!e.state||!e.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&e.state?.[this.modalName]&&history.back()},"handlePopState");handleKeyDownInModal=o(e=>{e.keyCode===Ub&&this.requestCloseModal(),e.keyCode===bh&&nl(e,this.getPluginState().activeOverlayType,this.el)},"handleKeyDownInModal");handleClickOutside=o(()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()},"handleClickOutside");handlePaste=o(e=>{this.uppy.iteratePlugins(r=>{r.type==="acquirer"&&r.handleRootPaste?.(e)});let t=Be(e.clipboardData.files);t.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(t))},"handlePaste");handleInputChange=o(e=>{e.preventDefault();let t=Be(e.currentTarget.files||[]);t.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(t))},"handleInputChange");handleDragOver=o(e=>{e.preventDefault(),e.stopPropagation();let t=o(()=>{let a=!0;return this.uppy.iteratePlugins(u=>{u.canHandleRootDrop?.(e)&&(a=!0)}),a},"canSomePluginHandleRootDrop"),r=o(()=>{let{types:a}=e.dataTransfer;return a.some(u=>u==="Files")},"doesEventHaveFiles"),s=t(),n=r();if(!s&&!n||this.opts.disabled||this.opts.disableLocalFiles&&(n||!s)||!this.uppy.getState().allowNewUpload){e.dataTransfer.dropEffect="none";return}e.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(e)},"handleDragOver");handleDragLeave=o(e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(e)},"handleDragLeave");handleDrop=o(async e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(n=>{n.type==="acquirer"&&n.handleRootDrop?.(e)});let t=!1,r=o(n=>{this.uppy.log(n,"error"),t||(this.uppy.info(n.message,"error"),t=!0)},"logDropError");this.uppy.log("[Dashboard] Processing dropped files");let s=await Ui(e.dataTransfer,{logDropError:r});s.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(s)),this.opts.onDrop(e)},"handleDrop");handleRequestThumbnail=o(e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",e)},"handleRequestThumbnail");handleCancelThumbnail=o(e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",e)},"handleCancelThumbnail");handleKeyDownInInline=o(e=>{e.keyCode===bh&&vh(e,this.getPluginState().activeOverlayType,this.el)},"handleKeyDownInInline");handlePasteOnBody=o(e=>{this.el.contains(document.activeElement)&&this.handlePaste(e)},"handlePasteOnBody");handleComplete=o(({failed:e})=>{this.opts.closeAfterFinish&&!e?.length&&this.requestCloseModal()},"handleComplete");handleCancelRestore=o(()=>{this.uppy.emit("restore-canceled")},"handleCancelRestore");#t=o(()=>{if(this.opts.disableThumbnailGenerator)return;let e=600,t=this.uppy.getFiles();if(t.length===1){let r=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);r?.setOptions({thumbnailWidth:e});let s={...t[0],preview:void 0};r?.requestThumbnail(s).then(()=>{r?.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}},"#generateLargeThumbnailIfSingleFile");#r=o(e=>{let t=e[0],{metaFields:r}=this.getPluginState(),s=r&&r.length>0,n=this.canEditFile(t);s&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,t.id):n&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(t)},"#openFileEditorWhenFilesAdded");initEvents=o(()=>{if(this.opts.trigger&&!this.opts.inline){let e=Ha(this.opts.trigger);e?e.forEach(t=>t.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",this.#c),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",this.#t),this.uppy.on("file-removed",this.#t),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",this.#r)},"initEvents");removeEvents=o(()=>{let e=Ha(this.opts.trigger);!this.opts.inline&&e&&e.forEach(t=>t.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",this.#c),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",this.#t),this.uppy.off("file-removed",this.#t),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",this.#r)},"removeEvents");superFocusOnEachUpdate=o(()=>{let e=this.el.contains(document.activeElement),t=document.activeElement===document.body||document.activeElement===null,r=this.uppy.getState().info.length===0,s=!this.opts.inline;r&&(s||e||t&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()},"superFocusOnEachUpdate");afterUpdate=o(()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()},"afterUpdate");saveFileCard=o((e,t)=>{this.uppy.setFileMeta(t,e),this.toggleFileCard(!1,t)},"saveFileCard");#i=o(e=>{let t=this.uppy.getPlugin(e.id);return{...e,icon:t.icon||this.opts.defaultPickerIcon,render:t.render}},"#attachRenderFunctionToTarget");#s=o(e=>{let t=this.uppy.getPlugin(e.id);return typeof t.isSupported!="function"?!0:t.isSupported()},"#isTargetSupported");#a=o(e=>e.filter(t=>t.type==="acquirer"&&this.#s(t)).map(this.#i),"#getAcquirers");#o=o(e=>e.filter(t=>t.type==="progressindicator").map(this.#i),"#getProgressIndicators");#l=o(e=>e.filter(t=>t.type==="editor").map(this.#i),"#getEditors");render=o(e=>{let t=this.getPluginState(),{files:r,capabilities:s,allowNewUpload:n}=e,{newFiles:a,uploadStartedFiles:u,completeFiles:c,erroredFiles:p,inProgressFiles:g,inProgressNotPausedFiles:h,processingFiles:b,isUploadStarted:P,isAllComplete:F,isAllPaused:M}=this.uppy.getObjectOfFilesPerState(),C=this.#a(t.targets),O=this.#o(t.targets),U=this.#l(t.targets),A;return this.opts.theme==="auto"?A=s.darkMode?"dark":"light":A=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),sl({state:e,isHidden:t.isHidden,files:r,newFiles:a,uploadStartedFiles:u,completeFiles:c,erroredFiles:p,inProgressFiles:g,inProgressNotPausedFiles:h,processingFiles:b,isUploadStarted:P,isAllComplete:F,isAllPaused:M,totalFileCount:Object.keys(r).length,totalProgress:e.totalProgress,allowNewUpload:n,acquirers:C,theme:A,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:t.activePickerPanel,showFileEditor:t.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:t.isClosing,progressindicators:O,editors:U,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:e.recoveredState,metaFields:t.metaFields,resumableUploads:s.resumableUploads||!1,individualCancellation:s.individualCancellation,isMobileDevice:s.isMobileDevice,fileCardFor:t.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:t.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:t.containerWidth,containerHeight:t.containerHeight,areInsidesReadyToBeVisible:t.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:t.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})},"render");#n=o(()=>{let{plugins:e}=this.opts;e.forEach(t=>{let r=this.uppy.getPlugin(t);r?r.mount(this,r):this.uppy.log(`[Uppy] Dashboard could not find plugin '${t}', make sure to uppy.use() the plugins you are specifying`,"warning")})},"#addSpecifiedPluginsFromOptions");#p=o(()=>{this.uppy.iteratePlugins(this.#c)},"#autoDiscoverPlugins");#c=o(e=>{let t=["acquirer","editor"];e&&!e.opts?.target&&t.includes(e.type)&&(this.getPluginState().targets.some(s=>e.id===s.id)||e.mount(this,e))},"#addSupportedPluginIfNoTarget");#d(){let{hideUploadButton:e,hideRetryButton:t,hidePauseResumeButton:r,hideCancelButton:s,showProgressDetails:n,hideProgressAfterFinish:a,locale:u,doneButtonHandler:c}=this.opts;return{hideUploadButton:e,hideRetryButton:t,hidePauseResumeButton:r,hideCancelButton:s,showProgressDetails:n,hideAfterFinish:a,locale:u,doneButtonHandler:c}}#u(){let{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:r,waitForThumbnailsBeforeUpload:s}=this.opts;return{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:r,waitForThumbnailsBeforeUpload:s,lazy:!s}}#h(){return{}}setOptions(e){super.setOptions(e),this.uppy.getPlugin(this.#f())?.setOptions(this.#d()),this.uppy.getPlugin(this.#m())?.setOptions(this.#u())}#f(){return`${this.id}:StatusBar`}#m(){return`${this.id}:ThumbnailGenerator`}#y(){return`${this.id}:Informer`}install=o(()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});let{inline:e,closeAfterFinish:t}=this.opts;if(e&&t)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");let{allowMultipleUploads:r,allowMultipleUploadBatches:s}=this.uppy.opts;(r||s)&&t&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");let{target:n}=this.opts;n&&this.mount(n,this),this.opts.disableStatusBar||this.uppy.use(ii,{id:this.#f(),target:this,...this.#d()}),this.opts.disableInformer||this.uppy.use(ti,{id:this.#y(),target:this,...this.#h()}),this.opts.disableThumbnailGenerator||this.uppy.use(Oi,{id:this.#m(),...this.#u()}),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;let a=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${a?"on":"off"}`),this.setDarkModeCapability(a),this.opts.theme==="auto"&&this.darkModeMediaQuery?.addListener(this.handleSystemDarkModeChange),this.#n(),this.#p(),this.initEvents()},"install");uninstall=o(()=>{if(!this.opts.disableInformer){let t=this.uppy.getPlugin(`${this.id}:Informer`);t&&this.uppy.removePlugin(t)}if(!this.opts.disableStatusBar){let t=this.uppy.getPlugin(`${this.id}:StatusBar`);t&&this.uppy.removePlugin(t)}if(!this.opts.disableThumbnailGenerator){let t=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);t&&this.uppy.removePlugin(t)}let{plugins:e}=this.opts;e.forEach(t=>{let r=this.uppy.getPlugin(t);r&&r.unmount()}),this.opts.theme==="auto"&&this.darkModeMediaQuery?.removeListener(this.handleSystemDarkModeChange),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()},"uninstall")};var Sh={name:"@uppy/drag-drop",description:"Droppable zone UI for Uppy. Drag and drop files into it to upload.",version:"4.2.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","drag-drop","drag","drop","dropzone","upload"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"}};var xh={strings:{dropHereOr:"Drop here or %{browse}",browse:"browse"}};var Nb={inputName:"files[]",width:"100%",height:"100%"},ar=class i extends Z{static{o(this,"DragDrop")}static VERSION=Sh.version;isDragDropSupported=gs();fileInputRef;constructor(e,t){super(e,{...Nb,...t}),this.type="acquirer",this.id=this.opts.id||"DragDrop",this.title="Drag & Drop",this.defaultLocale=xh,this.i18nInit()}addFiles=o(e=>{let t=e.map(r=>({source:this.id,name:r.name,type:r.type,data:r,meta:{relativePath:r.relativePath||null}}));try{this.uppy.addFiles(t)}catch(r){this.uppy.log(r)}},"addFiles");onInputChange=o(e=>{let t=Be(e.currentTarget.files||[]);t.length>0&&(this.uppy.log("[DragDrop] Files selected through input"),this.addFiles(t)),e.currentTarget.value=""},"onInputChange");handleDragOver=o(e=>{e.preventDefault(),e.stopPropagation();let{types:t}=e.dataTransfer,r=t.some(n=>n==="Files"),{allowNewUpload:s}=this.uppy.getState();if(!r||!s){e.dataTransfer.dropEffect="none";return}e.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver?.(e)},"handleDragOver");handleDragLeave=o(e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave?.(e)},"handleDragLeave");handleDrop=o(async e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1});let t=o(s=>{this.uppy.log(s,"error")},"logDropError"),r=await Ui(e.dataTransfer,{logDropError:t});r.length>0&&(this.uppy.log("[DragDrop] Files dropped"),this.addFiles(r)),this.opts.onDrop?.(e)},"handleDrop");renderHiddenFileInput(){let{restrictions:e}=this.uppy.opts;return l("input",{className:"uppy-DragDrop-input",type:"file",hidden:!0,ref:o(t=>{this.fileInputRef=t},"ref"),name:this.opts.inputName,multiple:e.maxNumberOfFiles!==1,accept:e.allowedFileTypes?.join(", "),onChange:this.onInputChange})}static renderArrowSvg(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16",children:l("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0",fillRule:"evenodd"})})}renderLabel(){return l("div",{className:"uppy-DragDrop-label",children:this.i18nArray("dropHereOr",{browse:l("span",{className:"uppy-DragDrop-browse",children:this.i18n("browse")})})})}renderNote(){return l("span",{className:"uppy-DragDrop-note",children:this.opts.note})}render(){let e=`uppy-u-reset
      uppy-DragDrop-container
      ${this.isDragDropSupported?"uppy-DragDrop--isDragDropSupported":""}
      ${this.getPluginState().isDraggingOver?"uppy-DragDrop--isDraggingOver":""}
    `,t={width:this.opts.width,height:this.opts.height};return l("button",{type:"button",className:e,style:t,onClick:o(()=>this.fileInputRef.click(),"onClick"),onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop,children:[this.renderHiddenFileInput(),l("div",{className:"uppy-DragDrop-inner",children:[i.renderArrowSvg(),this.renderLabel(),this.renderNote()]})]})}install(){let{target:e}=this.opts;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)}uninstall(){this.unmount()}};var _h={name:"@uppy/drop-target",description:"Lets your users drag and drop files on a DOM element",version:"3.2.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","drag-drop","drag","drop","dropzone","upload"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^"},peerDependencies:{"@uppy/core":"workspace:^"},publishConfig:{access:"public"},devDependencies:{cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"}};var Lb={target:null};function al(i){return i.dataTransfer?.types?.some(e=>e==="Files")??!1}o(al,"isFileTransfer");var xs=class extends we{static{o(this,"DropTarget")}static VERSION=_h.version;nodes;constructor(e,t){super(e,{...Lb,...t}),this.type="acquirer",this.id=this.opts.id||"DropTarget"}addFiles=o(e=>{let t=e.map(r=>({source:this.id,name:r.name,type:r.type,data:r,meta:{relativePath:r.relativePath||null}}));try{this.uppy.addFiles(t)}catch(r){this.uppy.log(r)}},"addFiles");handleDrop=o(async e=>{if(!al(e))return;e.preventDefault(),e.stopPropagation(),e.currentTarget?.classList.remove("uppy-is-drag-over"),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(n=>{n.type==="acquirer"&&n.handleRootDrop?.(e)});let t=!1,r=o(n=>{this.uppy.log(n,"error"),t||(this.uppy.info(n.message,"error"),t=!0)},"logDropError"),s=await Ui(e.dataTransfer,{logDropError:r});s.length>0&&(this.uppy.log("[DropTarget] Files were dropped"),this.addFiles(s)),this.opts.onDrop?.(e)},"handleDrop");handleDragOver=o(e=>{al(e)&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy",e.currentTarget.classList.add("uppy-is-drag-over"),this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver?.(e))},"handleDragOver");handleDragLeave=o(e=>{al(e)&&(e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),e.currentTarget?.classList.remove("uppy-is-drag-over"),this.opts.onDragLeave?.(e))},"handleDragLeave");addListeners=o(()=>{let{target:e}=this.opts;if(e instanceof Element?this.nodes=[e]:typeof e=="string"&&(this.nodes=Be(document.querySelectorAll(e))),!this.nodes||this.nodes.length===0)throw new Error(`"${e}" does not match any HTML elements`);this.nodes.forEach(t=>{t.addEventListener("dragover",this.handleDragOver,!1),t.addEventListener("dragleave",this.handleDragLeave,!1),t.addEventListener("drop",this.handleDrop,!1)})},"addListeners");removeListeners=o(()=>{this.nodes&&this.nodes.forEach(e=>{e.removeEventListener("dragover",this.handleDragOver,!1),e.removeEventListener("dragleave",this.handleDragLeave,!1),e.removeEventListener("drop",this.handleDrop,!1)})},"removeListeners");install(){this.setPluginState({isDraggingOver:!1}),this.addListeners()}uninstall(){this.removeListeners()}};var Ph={name:"@uppy/dropbox",description:"Import files from Dropbox, into Uppy.",version:"4.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","dropbox"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var kh={strings:{pluginNameDropbox:"Dropbox"}};var si=class extends Z{static{o(this,"Dropbox")}static VERSION=Ph.version;icon;provider;view;storage;files;rootFolderId=null;constructor(e,t){super(e,t),this.id=this.opts.id||"Dropbox",this.type="acquirer",this.storage=this.opts.storage||Ce,this.files=[],this.icon=()=>l("svg",{className:"uppy-DashboardTab-iconDropbox","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M10.5 7.5L5 10.955l5.5 3.454 5.5-3.454 5.5 3.454 5.5-3.454L21.5 7.5 16 10.955zM10.5 21.319L5 17.864l5.5-3.455 5.5 3.455zM16 17.864l5.5-3.455 5.5 3.455-5.5 3.455zM16 25.925l-5.5-3.455 5.5-3.454 5.5 3.454z",fill:"currentcolor",fillRule:"nonzero"})}),this.opts.companionAllowedHosts=He(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new qe(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"dropbox",pluginId:this.id,supportsRefreshToken:!0}),this.defaultLocale=kh,this.i18nInit(),this.title=this.i18n("pluginNameDropbox"),this.render=this.render.bind(this)}install(){this.view=new Me(this,{provider:this.provider,loadAllFiles:!0,virtualList:!0});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}render(e){return this.view.render(e)}};var Eh={name:"@uppy/facebook",description:"Import files from Facebook, into Uppy.",version:"4.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","facebook"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var Fh={strings:{pluginNameFacebook:"Facebook"}};var oi=class extends Z{static{o(this,"Facebook")}static VERSION=Eh.version;icon;provider;view;storage;files;rootFolderId=null;constructor(e,t){super(e,t),this.id=this.opts.id||"Facebook",this.type="acquirer",this.storage=this.opts.storage||Ce,this.files=[],this.icon=()=>l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("g",{fill:"none",fillRule:"evenodd",children:[l("path",{d:"M27 16c0-6.075-4.925-11-11-11S5 9.925 5 16c0 5.49 4.023 10.041 9.281 10.866V19.18h-2.793V16h2.793v-2.423c0-2.757 1.642-4.28 4.155-4.28 1.204 0 2.462.215 2.462.215v2.707h-1.387c-1.366 0-1.792.848-1.792 1.718V16h3.05l-.487 3.18h-2.563v7.686C22.977 26.041 27 21.49 27 16",fill:"#1777F2"}),l("path",{d:"M20.282 19.18L20.77 16h-3.051v-2.063c0-.87.426-1.718 1.792-1.718h1.387V9.512s-1.258-.215-2.462-.215c-2.513 0-4.155 1.523-4.155 4.28V16h-2.793v3.18h2.793v7.686a11.082 11.082 0 003.438 0V19.18h2.563",fill:"#FFFFFE"})]})}),this.opts.companionAllowedHosts=He(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new qe(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"facebook",pluginId:this.id,supportsRefreshToken:!1}),this.defaultLocale=Fh,this.i18nInit(),this.title=this.i18n("pluginNameFacebook"),this.render=this.render.bind(this)}install(){this.view=new Me(this,{provider:this.provider});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}render(e){let{partialTree:t,currentFolderId:r}=this.getPluginState();return t.filter(n=>n.type==="folder"&&n.parentId===r).length===0?this.view.render(e,{viewType:"grid",showFilter:!1,showTitles:!1}):this.view.render(e)}};var Ch={name:"@uppy/file-input",description:"Simple UI of a file input button that works with Uppy right out of the box",version:"4.2.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},keywords:["file uploader","upload","uppy","uppy-plugin","file-input"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"}};var Th={strings:{chooseFiles:"Choose files"}};var Hb={pretty:!0,inputName:"files[]"},lr=class extends Z{static{o(this,"FileInput")}static VERSION=Ch.version;input=null;constructor(e,t){super(e,{...Hb,...t}),this.id=this.opts.id||"FileInput",this.title="File Input",this.type="acquirer",this.defaultLocale=Th,this.i18nInit(),this.render=this.render.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleClick=this.handleClick.bind(this)}addFiles(e){let t=e.map(r=>({source:this.id,name:r.name,type:r.type,data:r}));try{this.uppy.addFiles(t)}catch(r){this.uppy.log(r)}}handleInputChange(e){this.uppy.log("[FileInput] Something selected through input...");let t=Be(e.currentTarget.files||[]);this.addFiles(t),e.currentTarget.value=""}handleClick(){this.input.click()}render(){let e={width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},{restrictions:t}=this.uppy.opts;return l("div",{className:"uppy-FileInput-container",children:[l("input",{className:"uppy-FileInput-input",style:this.opts.pretty?e:void 0,type:"file",name:this.opts.inputName,onChange:this.handleInputChange,multiple:t.maxNumberOfFiles!==1,accept:t.allowedFileTypes?.join(", "),ref:o(r=>{this.input=r},"ref")}),this.opts.pretty&&l("button",{className:"uppy-FileInput-btn",type:"button",onClick:this.handleClick,children:this.i18n("chooseFiles")})]})}install(){let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}};function qo(){return qo=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},qo.apply(this,arguments)}o(qo,"_extends");var qb={"[object HTMLCollection]":!0,"[object NodeList]":!0,"[object RadioNodeList]":!0},Vb={button:!0,fieldset:!0,reset:!0,submit:!0},$b={checkbox:!0,radio:!0},Wb=/^\s+|\s+$/g,Gb=Array.prototype.slice,Ah=Object.prototype.toString;function Vo(i,e){if(!i)throw new Error("A form is required by getFormData, was given form="+i);e=qo({includeDisabled:!1,trim:!1},e);for(var t={},r,s=[],n={},a=0,u=i.elements.length;a<u;a++){var c=i.elements[a];Vb[c.type]||c.disabled&&!e.includeDisabled||(r=c.name||c.id,r&&!n[r]&&(s.push(r),n[r]=!0))}for(var p=0,g=s.length;p<g;p++){r=s[p];var h=Oh(i,r,e);h!=null&&(t[r]=h)}return t}o(Vo,"getFormData");function Oh(i,e,t){if(!i)throw new Error("A form is required by getFieldData, was given form="+i);if(!e&&Ah.call(e)!=="[object String]")throw new Error("A field name is required by getFieldData, was given fieldName="+e);t=qo({includeDisabled:!1,trim:!1},t);var r=i.elements[e];if(!r||r.disabled&&!t.includeDisabled)return null;if(!qb[Ah.call(r)])return Rh(r,t.trim);for(var s=[],n=!0,a=0,u=r.length;a<u;a++)if(!(r[a].disabled&&!t.includeDisabled)){n&&r[a].type!=="radio"&&(n=!1);var c=Rh(r[a],t.trim);c!=null&&(s=s.concat(c))}return n&&s.length===1?s[0]:s.length>0?s:null}o(Oh,"getFieldData");function Rh(i,e){var t=null,r=i.type;if(r==="select-one")return i.options.length&&(t=i.options[i.selectedIndex].value),t;if(r==="select-multiple"){t=[];for(var s=0,n=i.options.length;s<n;s++)i.options[s].selected&&t.push(i.options[s].value);return t.length===0&&(t=null),t}return r==="file"&&"files"in i?(i.multiple?(t=Gb.call(i.files),t.length===0&&(t=null)):t=i.files[0],t):($b[r]?i.checked&&(r==="checkbox"&&!i.hasAttribute("value")?t=!0:t=i.value):t=e?i.value.replace(Wb,""):i.value,t)}o(Rh,"getFormElementValue");Vo.getFieldData=Oh;var Uh={name:"@uppy/form",description:"Connect Uppy to an existing HTML <form>.",version:"4.2.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","form"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^","get-form-data":"^3.0.0"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{typescript:"^5.8.3"}};var Xb={resultName:"uppyResult",getMetaFromForm:!0,addResultToForm:!0,submitOnSuccess:!1,triggerUploadOnSubmit:!1};function Yb(i){if(i==null||i.nodeName!=="FORM")throw new Error("ASSERTION FAILED: the target is not a <form> element",{cause:i});return i}o(Yb,"assertHTMLFormElement");var _s=class extends we{static{o(this,"Form")}static VERSION=Uh.version;#e;constructor(e,t){super(e,{...Xb,...t}),this.type="acquirer",this.id=this.opts.id||"Form",this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleUploadStart=this.handleUploadStart.bind(this),this.handleSuccess=this.handleSuccess.bind(this),this.addResultToForm=this.addResultToForm.bind(this),this.getMetaFromForm=this.getMetaFromForm.bind(this)}handleUploadStart(){this.opts.getMetaFromForm&&this.getMetaFromForm()}handleSuccess(e){this.opts.addResultToForm&&this.addResultToForm(e),this.opts.submitOnSuccess&&this.#e.reportValidity()&&this.#e.submit()}handleFormSubmit(e){if(this.opts.triggerUploadOnSubmit){e.preventDefault();let t=Be(e.target.elements),r=[];t.forEach(s=>{(s.tagName==="BUTTON"||s.tagName==="INPUT"&&s.type==="submit")&&!s.disabled&&(s.disabled=!0,r.push(s))}),this.uppy.upload().then(()=>{r.forEach(s=>{s.disabled=!1})},s=>(r.forEach(n=>{n.disabled=!1}),Promise.reject(s))).catch(s=>{this.uppy.log(s.stack||s.message||s)})}}addResultToForm(e){this.uppy.log("[Form] Adding result to the original form:"),this.uppy.log(e);let t=this.#e.querySelector(`[name="${this.opts.resultName}"]`);if(t){let r;try{r=JSON.parse(t.value)}catch{}Array.isArray(r)||(r=[]),r.push(e),t.value=JSON.stringify(r);return}t=document.createElement("input"),t.name=this.opts.resultName,t.type="hidden",t.value=JSON.stringify([e]),this.#e.appendChild(t)}getMetaFromForm(){let e=Vo(this.#e);delete e[this.opts.resultName],this.uppy.setMeta(e)}install(){this.#e=Yb(Ks(this.opts.target)),this.#e.addEventListener("submit",this.handleFormSubmit),this.uppy.on("upload",this.handleUploadStart),this.uppy.on("complete",this.handleSuccess)}uninstall(){this.#e.removeEventListener("submit",this.handleFormSubmit),this.uppy.off("upload",this.handleUploadStart),this.uppy.off("complete",this.handleSuccess)}};var Wh=de(Un(),1);var Dh={name:"@uppy/golden-retriever",description:"The GoldenRetriever Uppy plugin saves selected files in browser cache to seamlessly resume uploding after browser crash or accidentally closed tab",version:"4.2.3",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","restore files","crash recovery","golden retriever","resumable uploads","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",lodash:"^4.17.21"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{typescript:"^5.8.3"}};var Bh=typeof window<"u"&&(window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB),Qb=!!Bh,Ih="uppy-blobs",pt="files",jh=24*60*60*1e3,Zb=3,Nh=1048576;function e1(i){let e=i.openCursor();e.onsuccess=t=>{let r=t.target.result;if(!r)return;let s=r.value;s.expires=Date.now()+jh,r.update(s)}}o(e1,"migrateExpiration");function Mh(i){let e=Bh.open(i,Zb);return new Promise((t,r)=>{e.onupgradeneeded=s=>{let n=s.target.result,a=s.currentTarget.transaction;if(s.oldVersion<2&&n.createObjectStore(pt,{keyPath:"id"}).createIndex("store","store",{unique:!1}),s.oldVersion<3){let u=a.objectStore(pt);u.createIndex("expires","expires",{unique:!1}),e1(u)}a.oncomplete=()=>{t(n)}},e.onsuccess=s=>{t(s.target.result)},e.onerror=r})}o(Mh,"connect");function $o(i){return new Promise((e,t)=>{i.onsuccess=r=>{e(r.target.result)},i.onerror=t})}o($o,"waitForRequest");var Lh=!1,Wo=class i{static{o(this,"IndexedDBStore")}#e;opts;name;static isSupported;constructor(e){this.opts={dbName:Ih,storeName:"default",expires:jh,maxFileSize:10*Nh,maxTotalSize:300*Nh,...e},this.name=this.opts.storeName;let t=o(async()=>{let r=await Mh(this.opts.dbName);return this.#e=r,r},"createConnection");Lh?this.#e=t():(Lh=!0,this.#e=i.cleanup().then(t,t))}get ready(){return Promise.resolve(this.#e)}key(e){return`${this.name}!${e}`}async list(){let s=(await this.#e).transaction([pt],"readonly").objectStore(pt).index("store").getAll(IDBKeyRange.only(this.name)),n=await $o(s);return Object.fromEntries(n.map(a=>[a.fileID,a.data]))}async get(e){let s=(await this.#e).transaction([pt],"readonly").objectStore(pt).get(this.key(e)),{data:n}=await $o(s);return{id:n.fileID,data:n.data}}async getSize(){let s=(await this.#e).transaction([pt],"readonly").objectStore(pt).index("store").openCursor(IDBKeyRange.only(this.name));return new Promise((n,a)=>{let u=0;s.onsuccess=c=>{let p=c.target.result;p?(u+=p.value.data.size,p.continue()):n(u)},s.onerror=()=>{a(new Error("Could not retrieve stored blobs size"))}})}async put(e){if(e.data.size>this.opts.maxFileSize)throw new Error("File is too big to store.");if(await this.getSize()>this.opts.maxTotalSize)throw new Error("No space left");let n=(await this.#e).transaction([pt],"readwrite").objectStore(pt).add({id:this.key(e.id),fileID:e.id,store:this.name,expires:Date.now()+this.opts.expires,data:e.data});return $o(n)}async delete(e){let s=(await this.#e).transaction([pt],"readwrite").objectStore(pt).delete(this.key(e));return $o(s)}static async cleanup(){let e=await Mh(Ih),s=e.transaction([pt],"readwrite").objectStore(pt).index("expires").openCursor(IDBKeyRange.upperBound(Date.now()));await new Promise((n,a)=>{s.onsuccess=u=>{let c=u.target.result;c?(c.delete(),c.continue()):n()},s.onerror=a}),e.close()}};Wo.isSupported=Qb;var zh=Wo;function t1(){let i=[];for(let e=0;e<localStorage.length;e++){let t=localStorage.key(e);t?.startsWith("uppyState:")&&i.push(t.slice(10))}return i}o(t1,"findUppyInstances");function Hh(i){try{return JSON.parse(i)}catch{return null}}o(Hh,"maybeParse");var qh=!1,ni=class i{static{o(this,"MetaDataStore")}opts;name;constructor(e){this.opts={expires:24*60*60*1e3,...e},this.name=`uppyState:${e.storeName}`,qh||(qh=!0,i.cleanup())}load(){let e=localStorage.getItem(this.name);if(!e)return null;let t=Hh(e);return t?t.metadata:null}save(e){let t=Date.now()+this.opts.expires,r=JSON.stringify({metadata:e,expires:t});localStorage.setItem(this.name,r)}static cleanup(e){if(e){localStorage.removeItem(`uppyState:${e}`);return}let t=t1(),r=Date.now();t.forEach(s=>{let n=localStorage.getItem(`uppyState:${s}`);if(!n)return;let a=Hh(n);a&&a.expires&&a.expires<r&&localStorage.removeItem(`uppyState:${s}`)})}};var Vh=typeof navigator<"u"&&"serviceWorker"in navigator;function i1(){return new Promise((i,e)=>{Vh?navigator.serviceWorker.controller?i():navigator.serviceWorker.addEventListener("controllerchange",()=>{i()}):e(new Error("Unsupported"))})}o(i1,"waitForServiceWorker");var Go=class{static{o(this,"ServiceWorkerStore")}#e;name;static isSupported;constructor(e){this.#e=i1().then(t=>{this.#e=t}),this.name=e.storeName}get ready(){return Promise.resolve(this.#e)}async list(){return await this.#e,new Promise((e,t)=>{let r=o(s=>{if(s.data.store===this.name)switch(s.data.type){case"uppy/ALL_FILES":e(s.data.files),navigator.serviceWorker.removeEventListener("message",r);break;default:t()}},"onMessage");navigator.serviceWorker.addEventListener("message",r),navigator.serviceWorker.controller.postMessage({type:"uppy/GET_FILES",store:this.name})})}async put(e){await this.#e,navigator.serviceWorker.controller.postMessage({type:"uppy/ADD_FILE",store:this.name,file:e})}async delete(e){await this.#e,navigator.serviceWorker.controller.postMessage({type:"uppy/REMOVE_FILE",store:this.name,fileID:e})}};Go.isSupported=Vh;var $h=Go;var r1={expires:24*60*60*1e3,serviceWorker:!1},Ps=class extends we{static{o(this,"GoldenRetriever")}static VERSION=Dh.version;MetaDataStore;ServiceWorkerStore;IndexedDBStore;savedPluginData;constructor(e,t){super(e,{...r1,...t}),this.type="debugger",this.id=this.opts.id||"GoldenRetriever",this.MetaDataStore=new ni({expires:this.opts.expires,storeName:e.getID()}),this.ServiceWorkerStore=null,this.opts.serviceWorker&&(this.ServiceWorkerStore=new $h({storeName:e.getID()})),this.IndexedDBStore=new zh({expires:this.opts.expires,...this.opts.indexedDB||{},storeName:e.getID()}),this.saveFilesStateToLocalStorage=(0,Wh.default)(this.saveFilesStateToLocalStorage.bind(this),500,{leading:!0,trailing:!0}),this.restoreState=this.restoreState.bind(this),this.loadFileBlobsFromServiceWorker=this.loadFileBlobsFromServiceWorker.bind(this),this.loadFileBlobsFromIndexedDB=this.loadFileBlobsFromIndexedDB.bind(this),this.onBlobsLoaded=this.onBlobsLoaded.bind(this)}restoreState(){let e=this.MetaDataStore.load();e&&(this.uppy.log("[GoldenRetriever] Recovered some state from Local Storage"),this.uppy.setState({currentUploads:e.currentUploads||{},files:e.files||{},recoveredState:e}),this.savedPluginData=e.pluginData)}saveFilesStateToLocalStorage(){let e=this.uppy.getFiles().filter(c=>!c.progress||!c.progress.uploadStarted),t=Object.values(this.uppy.getState().currentUploads).map(c=>c.fileIDs.map(p=>{let g=this.uppy.getFile(p);return g!=null?[g]:[]})).flat(2),r=[...e,...t],s=Object.values(Object.fromEntries(r.map(c=>[c.id,c])));if(s.length===0){this.uppy.getState().recoveredState!==null&&this.uppy.setState({recoveredState:null}),ni.cleanup(this.uppy.opts.id);return}let n=Object.fromEntries(s.map(c=>[c.id,c.isRemote?{...c,isRestored:!0}:{...c,isRestored:!0,data:null,preview:null}])),a={};this.uppy.emit("restore:get-data",c=>{Object.assign(a,c)});let{currentUploads:u}=this.uppy.getState();this.MetaDataStore.save({currentUploads:u,files:n,pluginData:a})}loadFileBlobsFromServiceWorker(){return this.ServiceWorkerStore?this.ServiceWorkerStore.list().then(e=>{let t=Object.keys(e).length;return t>0?(this.uppy.log(`[GoldenRetriever] Successfully recovered ${t} blobs from Service Worker!`),e):(this.uppy.log("[GoldenRetriever] No blobs found in Service Worker, trying IndexedDB now..."),{})}).catch(e=>(this.uppy.log("[GoldenRetriever] Failed to recover blobs from Service Worker","warning"),this.uppy.log(e),{})):Promise.resolve({})}loadFileBlobsFromIndexedDB(){return this.IndexedDBStore.list().then(e=>{let t=Object.keys(e).length;return t>0?(this.uppy.log(`[GoldenRetriever] Successfully recovered ${t} blobs from IndexedDB!`),e):(this.uppy.log("[GoldenRetriever] No blobs found in IndexedDB"),{})}).catch(e=>(this.uppy.log("[GoldenRetriever] Failed to recover blobs from IndexedDB","warning"),this.uppy.log(e),{}))}onBlobsLoaded(e){let t=[],r={...this.uppy.getState().files};Object.keys(e).forEach(s=>{let n=this.uppy.getFile(s);if(!n){t.push(s);return}let u={data:e[s],isRestored:!0,isGhost:!1};r[s]={...n,...u}}),Object.keys(r).forEach(s=>{r[s].data===null&&(r[s]={...r[s],isGhost:!0})}),this.uppy.setState({files:r}),this.uppy.emit("restored",this.savedPluginData),t.length&&this.deleteBlobs(t).then(()=>{this.uppy.log(`[GoldenRetriever] Cleaned up ${t.length} old files`)}).catch(s=>{this.uppy.log(`[GoldenRetriever] Could not clean up ${t.length} old files`,"warning"),this.uppy.log(s)})}async deleteBlobs(e){await Promise.all(e.map(t=>this.ServiceWorkerStore?.delete(t)??this.IndexedDBStore?.delete(t)))}addBlobToStores=o(e=>{e.isRemote||(this.ServiceWorkerStore&&this.ServiceWorkerStore.put(e).catch(t=>{this.uppy.log("[GoldenRetriever] Could not store file","warning"),this.uppy.log(t)}),this.IndexedDBStore.put(e).catch(t=>{this.uppy.log("[GoldenRetriever] Could not store file","warning"),this.uppy.log(t)}))},"addBlobToStores");removeBlobFromStores=o(e=>{this.ServiceWorkerStore&&this.ServiceWorkerStore.delete(e.id).catch(t=>{this.uppy.log("[GoldenRetriever] Failed to remove file","warning"),this.uppy.log(t)}),this.IndexedDBStore.delete(e.id).catch(t=>{this.uppy.log("[GoldenRetriever] Failed to remove file","warning"),this.uppy.log(t)})},"removeBlobFromStores");replaceBlobInStores=o(e=>{this.removeBlobFromStores(e),this.addBlobToStores(e)},"replaceBlobInStores");handleRestoreConfirmed=o(()=>{this.uppy.log("[GoldenRetriever] Restore confirmed, proceeding...");let{currentUploads:e}=this.uppy.getState();e&&(this.uppy.resumeAll(),Object.keys(e).forEach(t=>{this.uppy.restore(t)})),this.uppy.setState({recoveredState:null})},"handleRestoreConfirmed");abortRestore=o(()=>{this.uppy.log("[GoldenRetriever] Aborting restore...");let e=Object.keys(this.uppy.getState().files);this.deleteBlobs(e).then(()=>{this.uppy.log(`[GoldenRetriever] Removed ${e.length} files`)}).catch(t=>{this.uppy.log(`[GoldenRetriever] Could not remove ${e.length} files`,"warning"),this.uppy.log(t)}),this.uppy.cancelAll(),this.uppy.setState({recoveredState:null}),ni.cleanup(this.uppy.opts.id)},"abortRestore");handleComplete=o(({successful:e})=>{let t=e.map(r=>r.id);this.deleteBlobs(t).then(()=>{this.uppy.log(`[GoldenRetriever] Removed ${e.length} files that finished uploading`)}).catch(r=>{this.uppy.log(`[GoldenRetriever] Could not remove ${e.length} files that finished uploading`,"warning"),this.uppy.log(r)}),this.uppy.setState({recoveredState:null}),ni.cleanup(this.uppy.opts.id)},"handleComplete");restoreBlobs=o(()=>{this.uppy.getFiles().length>0?Promise.all([this.loadFileBlobsFromServiceWorker(),this.loadFileBlobsFromIndexedDB()]).then(e=>{let t={...e[0],...e[1]};this.onBlobsLoaded(t)}):this.uppy.log("[GoldenRetriever] No files need to be loaded, only restoring processing state...")},"restoreBlobs");install(){this.restoreState(),this.restoreBlobs(),this.uppy.on("file-added",this.addBlobToStores),this.uppy.on("file-editor:complete",this.replaceBlobInStores),this.uppy.on("file-removed",this.removeBlobFromStores),this.uppy.on("state-update",this.saveFilesStateToLocalStorage),this.uppy.on("restore-confirmed",this.handleRestoreConfirmed),this.uppy.on("restore-canceled",this.abortRestore),this.uppy.on("complete",this.handleComplete)}uninstall(){this.uppy.off("file-added",this.addBlobToStores),this.uppy.off("file-editor:complete",this.replaceBlobInStores),this.uppy.off("file-removed",this.removeBlobFromStores),this.uppy.off("state-update",this.saveFilesStateToLocalStorage),this.uppy.off("restore-confirmed",this.handleRestoreConfirmed),this.uppy.off("restore-canceled",this.abortRestore),this.uppy.off("complete",this.handleComplete)}};var Gh={name:"@uppy/google-drive",description:"The Google Drive plugin for Uppy lets users import files from their Google Drive account",version:"4.4.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","google drive","cloud storage","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var ks=class extends Me{static{o(this,"DriveProviderViews")}toggleCheckbox(e,t){e.data.custom?.isSharedDrive||super.toggleCheckbox(e,t)}};var Kh={strings:{pluginNameGoogleDrive:"Google Drive"}};var ai=class extends Z{static{o(this,"GoogleDrive")}static VERSION=Gh.version;icon;provider;view;storage;files;rootFolderId="root";constructor(e,t){super(e,t),this.type="acquirer",this.storage=this.opts.storage||Ce,this.files=[],this.id=this.opts.id||"GoogleDrive",this.icon=()=>l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("g",{fillRule:"nonzero",fill:"none",children:[l("path",{d:"M6.663 22.284l.97 1.62c.202.34.492.609.832.804l3.465-5.798H5c0 .378.1.755.302 1.096l1.361 2.278z",fill:"#0066DA"}),l("path",{d:"M16 12.09l-3.465-5.798c-.34.195-.63.463-.832.804l-6.4 10.718A2.15 2.15 0 005 18.91h6.93L16 12.09z",fill:"#00AC47"}),l("path",{d:"M23.535 24.708c.34-.195.63-.463.832-.804l.403-.67 1.928-3.228c.201-.34.302-.718.302-1.096h-6.93l1.474 2.802 1.991 2.996z",fill:"#EA4335"}),l("path",{d:"M16 12.09l3.465-5.798A2.274 2.274 0 0018.331 6h-4.662c-.403 0-.794.11-1.134.292L16 12.09z",fill:"#00832D"}),l("path",{d:"M20.07 18.91h-8.14l-3.465 5.798c.34.195.73.292 1.134.292h12.802c.403 0 .794-.11 1.134-.292L20.07 18.91z",fill:"#2684FC"}),l("path",{d:"M23.497 12.455l-3.2-5.359a2.252 2.252 0 00-.832-.804L16 12.09l4.07 6.82h6.917c0-.377-.1-.755-.302-1.096l-3.188-5.359z",fill:"#FFBA00"})]})}),this.opts.companionAllowedHosts=He(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new qe(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"drive",pluginId:this.id,supportsRefreshToken:!0}),this.defaultLocale=Kh,this.i18nInit(),this.title=this.i18n("pluginNameGoogleDrive"),this.render=this.render.bind(this)}install(){this.view=new ks(this,{provider:this.provider,loadAllFiles:!0,virtualList:!0});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}render(e){return this.view.render(e)}};var Xh={name:"@uppy/google-drive-picker",description:"The Google Drive Picker plugin for Uppy lets users import files from their Google Drive account",version:"0.4.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","google drive","google picker","cloud storage","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var ll={strings:{pluginNameGoogleDrivePicker:"Google Drive"}};var ur=class i extends Z{static{o(this,"GoogleDrivePicker")}static VERSION=Xh.version;static requestClientId=i.name;type="acquirer";icon=uo;storage;defaultLocale=ll;constructor(e,t){super(e,t),this.id=this.opts.id||"GoogleDrivePicker",this.storage=this.opts.storage||Ce,this.defaultLocale=ll,this.i18nInit(),this.title=this.i18n("pluginNameGoogleDrivePicker");let r=new Je(e,{pluginId:this.id,provider:"url",companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule});this.uppy.registerRequestClient(i.requestClientId,r)}install(){let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}handleFilesPicked=o(async(e,t)=>{this.uppy.addFiles(e.map(({id:r,mimeType:s,name:n,platform:a,...u})=>({source:this.id,name:n,type:s,data:{size:null},isRemote:!0,remote:{companionUrl:this.opts.companionUrl,url:`${this.opts.companionUrl}/google-picker/get`,body:{fileId:r,accessToken:t,platform:a,..."url"in u&&{url:u.url}},requestClientId:i.requestClientId},..."metadata"in u&&{meta:u.metadata}})))},"handleFilesPicked");render=o(()=>l(Ei,{storage:this.storage,pickerType:"drive",uppy:this.uppy,i18n:this.i18n,clientId:this.opts.clientId,apiKey:this.opts.apiKey,appId:this.opts.appId,onFilesPicked:this.handleFilesPicked}),"render")};var Yh={name:"@uppy/google-photos-picker",description:"The Google Photos Picker plugin for Uppy lets users import files from their Google Photos account",version:"0.4.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","google photos","google picker","cloud storage","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var ul={strings:{pluginNameGooglePhotosPicker:"Google Photos"}};var cr=class i extends Z{static{o(this,"GooglePhotosPicker")}static VERSION=Yh.version;static requestClientId=i.name;type="acquirer";icon=lo;storage;defaultLocale=ul;constructor(e,t){super(e,t),this.id=this.opts.id||"GooglePhotosPicker",this.storage=this.opts.storage||Ce,this.defaultLocale=ul,this.i18nInit(),this.title=this.i18n("pluginNameGooglePhotosPicker");let r=new Je(e,{pluginId:this.id,provider:"url",companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule});this.uppy.registerRequestClient(i.requestClientId,r)}install(){let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}handleFilesPicked=o(async(e,t)=>{this.uppy.addFiles(e.map(({id:r,mimeType:s,name:n,platform:a,...u})=>({source:this.id,name:n,type:s,data:{size:null},isRemote:!0,remote:{companionUrl:this.opts.companionUrl,url:`${this.opts.companionUrl}/google-picker/get`,body:{fileId:r,accessToken:t,platform:a,..."url"in u&&{url:u.url}},requestClientId:i.requestClientId},..."metadata"in u&&{meta:u.metadata}})))},"handleFilesPicked");render=o(()=>l(Ei,{storage:this.storage,pickerType:"photos",uppy:this.uppy,i18n:this.i18n,clientId:this.opts.clientId,onFilesPicked:this.handleFilesPicked}),"render")};var Jh={name:"@uppy/image-editor",description:"Image editor and cropping UI",version:"3.4.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},keywords:["file uploader","upload","uppy","uppy-plugin","image editor","cropper","crop","rotate","resize"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",cropperjs:"^1.6.2",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},publishConfig:{access:"public"},devDependencies:{cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"}};var sf=de(Qh(),1);function l1(i,e){let t=i.width/e.width,r=i.height/e.height,s=Math.min(t,r),n=e.width*s,a=e.height*s,u=(i.width-n)/2,c=(i.height-a)/2;return{width:n,height:a,left:u,top:c}}o(l1,"getCanvasDataThatFitsPerfectlyIntoContainer");var Zh=l1;function u1(i){return i*(Math.PI/180)}o(u1,"toRadians");function c1(i,e,t){let r=Math.abs(u1(t));return Math.max((Math.sin(r)*i+Math.cos(r)*e)/e,(Math.sin(r)*e+Math.cos(r)*i)/i)}o(c1,"getScaleFactorThatRemovesDarkCorners");var ef=c1;function p1(i,e,t){return e.left<i.left?{left:i.left,width:t.width}:e.top<i.top?{top:i.top,height:t.height}:e.left+e.width>i.left+i.width?{left:i.left+i.width-t.width,width:t.width}:e.top+e.height>i.top+i.height?{top:i.top+i.height-t.height,height:t.height}:null}o(p1,"limitCropboxMovementOnMove");var tf=p1;function d1(i,e,t){return e.left<i.left?{left:i.left,width:t.left+t.width-i.left}:e.top<i.top?{top:i.top,height:t.top+t.height-i.top}:e.left+e.width>i.left+i.width?{left:t.left,width:i.left+i.width-t.left}:e.top+e.height>i.top+i.height?{top:t.top,height:i.top+i.height-t.top}:null}o(d1,"limitCropboxMovementOnResize");var rf=d1;var Es=class extends ge{static{o(this,"Editor")}imgElement;cropper;constructor(e){super(e),this.state={angle90Deg:0,angleGranular:0,prevCropboxData:null},this.storePrevCropboxData=this.storePrevCropboxData.bind(this),this.limitCropboxMovement=this.limitCropboxMovement.bind(this)}componentDidMount(){let{opts:e,storeCropperInstance:t}=this.props;this.cropper=new sf.default(this.imgElement,e.cropperOptions),this.imgElement.addEventListener("cropstart",this.storePrevCropboxData),this.imgElement.addEventListener("cropend",this.limitCropboxMovement),t(this.cropper)}componentWillUnmount(){this.cropper.destroy(),this.imgElement.removeEventListener("cropstart",this.storePrevCropboxData),this.imgElement.removeEventListener("cropend",this.limitCropboxMovement)}storePrevCropboxData(){this.setState({prevCropboxData:this.cropper.getCropBoxData()})}limitCropboxMovement(e){let t=this.cropper.getCanvasData(),r=this.cropper.getCropBoxData(),{prevCropboxData:s}=this.state;if(e.detail.action==="all"){let n=tf(t,r,s);n&&this.cropper.setCropBoxData(n)}else{let n=rf(t,r,s);n&&this.cropper.setCropBoxData(n)}}onRotate90Deg=o(()=>{let{angle90Deg:e}=this.state,t=e-90;this.setState({angle90Deg:t,angleGranular:0}),this.cropper.scale(1),this.cropper.rotateTo(t);let r=this.cropper.getCanvasData(),s=this.cropper.getContainerData(),n=Zh(s,r);this.cropper.setCanvasData(n),this.cropper.setCropBoxData(n)},"onRotate90Deg");onRotateGranular=o(e=>{let t=Number(e.target.value);this.setState({angleGranular:t});let{angle90Deg:r}=this.state,s=r+t;this.cropper.rotateTo(s);let n=this.cropper.getImageData(),a=ef(n.naturalWidth,n.naturalHeight,t),u=this.cropper.getImageData().scaleX<0?-a:a;this.cropper.scale(u,a)},"onRotateGranular");renderGranularRotate(){let{i18n:e}=this.props,{angleGranular:t}=this.state;return l("label",{role:"tooltip","aria-label":`${t}\xBA`,"data-microtip-position":"top",className:"uppy-ImageCropper-rangeWrapper",children:l("input",{className:"uppy-ImageCropper-range uppy-u-reset",type:"range",onInput:this.onRotateGranular,onChange:this.onRotateGranular,value:t,min:"-45",max:"45","aria-label":e("rotate")})})}renderRevert(){let{i18n:e,opts:t}=this.props;return l("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("revert"),onClick:o(()=>{this.cropper.reset(),this.cropper.setAspectRatio(t.cropperOptions.initialAspectRatio),this.setState({angle90Deg:0,angleGranular:0})},"onClick"),children:l("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M0 0h24v24H0z",fill:"none"}),l("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"})]})})}renderRotate(){let{i18n:e}=this.props;return l("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("rotate"),onClick:this.onRotate90Deg,children:l("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M0 0h24v24H0V0zm0 0h24v24H0V0z",fill:"none"}),l("path",{d:"M14 10a2 2 0 012 2v7a2 2 0 01-2 2H6a2 2 0 01-2-2v-7a2 2 0 012-2h8zm0 1.75H6a.25.25 0 00-.243.193L5.75 12v7a.25.25 0 00.193.243L6 19.25h8a.25.25 0 00.243-.193L14.25 19v-7a.25.25 0 00-.193-.243L14 11.75zM12 .76V4c2.3 0 4.61.88 6.36 2.64a8.95 8.95 0 012.634 6.025L21 13a1 1 0 01-1.993.117L19 13h-.003a6.979 6.979 0 00-2.047-4.95 6.97 6.97 0 00-4.652-2.044L12 6v3.24L7.76 5 12 .76z"})]})})}renderFlip(){let{i18n:e}=this.props;return l("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("flipHorizontal"),onClick:o(()=>this.cropper.scaleX(-this.cropper.getData().scaleX||-1),"onClick"),children:l("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M0 0h24v24H0z",fill:"none"}),l("path",{d:"M15 21h2v-2h-2v2zm4-12h2V7h-2v2zM3 5v14c0 1.1.9 2 2 2h4v-2H5V5h4V3H5c-1.1 0-2 .9-2 2zm16-2v2h2c0-1.1-.9-2-2-2zm-8 20h2V1h-2v22zm8-6h2v-2h-2v2zM15 5h2V3h-2v2zm4 8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2z"})]})})}renderZoomIn(){let{i18n:e}=this.props;return l("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("zoomIn"),onClick:o(()=>this.cropper.zoom(.1),"onClick"),children:l("svg",{"aria-hidden":"true",className:"uppy-c-icon",height:"24",viewBox:"0 0 24 24",width:"24",children:[l("path",{d:"M0 0h24v24H0V0z",fill:"none"}),l("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),l("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})}renderZoomOut(){let{i18n:e}=this.props;return l("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("zoomOut"),onClick:o(()=>this.cropper.zoom(-.1),"onClick"),children:l("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M0 0h24v24H0V0z",fill:"none"}),l("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"})]})})}renderCropSquare(){let{i18n:e}=this.props;return l("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("aspectRatioSquare"),onClick:o(()=>this.cropper.setAspectRatio(1),"onClick"),children:l("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M0 0h24v24H0z",fill:"none"}),l("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})]})})}renderCropWidescreen(){let{i18n:e}=this.props;return l("button",{"data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("aspectRatioLandscape"),onClick:o(()=>this.cropper.setAspectRatio(16/9),"onClick"),children:l("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M 19,4.9999992 V 17.000001 H 4.9999998 V 6.9999992 H 19 m 0,-2 H 4.9999998 c -1.0999999,0 -1.9999999,0.9000001 -1.9999999,2 V 17.000001 c 0,1.1 0.9,2 1.9999999,2 H 19 c 1.1,0 2,-0.9 2,-2 V 6.9999992 c 0,-1.0999999 -0.9,-2 -2,-2 z"}),l("path",{fill:"none",d:"M0 0h24v24H0z"})]})})}renderCropWidescreenVertical(){let{i18n:e}=this.props;return l("button",{"data-microtip-position":"top",type:"button","aria-label":e("aspectRatioPortrait"),className:"uppy-u-reset uppy-c-btn",onClick:o(()=>this.cropper.setAspectRatio(9/16),"onClick"),children:l("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M 19.000001,19 H 6.999999 V 5 h 10.000002 v 14 m 2,0 V 5 c 0,-1.0999999 -0.9,-1.9999999 -2,-1.9999999 H 6.999999 c -1.1,0 -2,0.9 -2,1.9999999 v 14 c 0,1.1 0.9,2 2,2 h 10.000002 c 1.1,0 2,-0.9 2,-2 z"}),l("path",{d:"M0 0h24v24H0z",fill:"none"})]})})}render(){let{currentImage:e,opts:t}=this.props,{actions:r}=t,s=URL.createObjectURL(e.data);return l("div",{className:"uppy-ImageCropper",children:[l("div",{className:"uppy-ImageCropper-container",children:l("img",{className:"uppy-ImageCropper-image",alt:e.name,src:s,ref:o(n=>{this.imgElement=n},"ref")})}),l("div",{className:"uppy-ImageCropper-controls",children:[r.revert&&this.renderRevert(),r.rotate&&this.renderRotate(),r.granularRotate&&this.renderGranularRotate(),r.flip&&this.renderFlip(),r.zoomIn&&this.renderZoomIn(),r.zoomOut&&this.renderZoomOut(),r.cropSquare&&this.renderCropSquare(),r.cropWidescreen&&this.renderCropWidescreen(),r.cropWidescreenVertical&&this.renderCropWidescreenVertical()]})]})}};var of={strings:{revert:"Reset",rotate:"Rotate 90\xB0",zoomIn:"Zoom in",zoomOut:"Zoom out",flipHorizontal:"Flip horizontally",aspectRatioSquare:"Crop square",aspectRatioLandscape:"Crop landscape (16:9)",aspectRatioPortrait:"Crop portrait (9:16)"}};var nf={viewMode:0,background:!1,autoCropArea:1,responsive:!0,minCropBoxWidth:70,minCropBoxHeight:70,croppedCanvasOptions:{},initialAspectRatio:0},af={revert:!0,rotate:!0,granularRotate:!0,flip:!0,zoomIn:!0,zoomOut:!0,cropSquare:!0,cropWidescreen:!0,cropWidescreenVertical:!0},h1={quality:.8,actions:af,cropperOptions:nf},pr=class extends Z{static{o(this,"ImageEditor")}static VERSION=Jh.version;cropper;constructor(e,t){super(e,{...h1,...t,actions:{...af,...t?.actions},cropperOptions:{...nf,...t?.cropperOptions}}),this.id=this.opts.id||"ImageEditor",this.title="Image Editor",this.type="editor",this.defaultLocale=of,this.i18nInit()}canEditFile(e){if(!e.type||e.isRemote)return!1;let t=e.type.split("/")[1];return!!/^(jpe?g|gif|png|bmp|webp)$/.test(t)}save=o(()=>{let e=o(s=>{let{currentImage:n}=this.getPluginState();this.uppy.setFileState(n.id,{data:new File([s],n.name??this.i18n("unnamed"),{type:s.type}),size:s.size,preview:void 0});let a=this.uppy.getFile(n.id);this.uppy.emit("thumbnail:request",a),this.setPluginState({currentImage:a}),this.uppy.emit("file-editor:complete",a)},"saveBlobCallback"),{currentImage:t}=this.getPluginState(),r=this.cropper.getCroppedCanvas({});r.width%2!==0&&this.cropper.setData({width:r.width-1}),r.height%2!==0&&this.cropper.setData({height:r.height-1}),this.cropper.getCroppedCanvas(this.opts.cropperOptions.croppedCanvasOptions).toBlob(e,t.type,this.opts.quality)},"save");storeCropperInstance=o(e=>{this.cropper=e},"storeCropperInstance");selectFile=o(e=>{this.uppy.emit("file-editor:start",e),this.setPluginState({currentImage:e})},"selectFile");install(){this.setPluginState({currentImage:null});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){let{currentImage:e}=this.getPluginState();if(e){let t=this.uppy.getFile(e.id);this.uppy.emit("file-editor:cancel",t)}this.unmount()}render(){let{currentImage:e}=this.getPluginState();return e===null||e.isRemote?null:l(Es,{currentImage:e,storeCropperInstance:this.storeCropperInstance,save:this.save,opts:this.opts,i18n:this.i18n})}};var lf={name:"@uppy/instagram",description:"Import photos and videos from Instagram, into Uppy.",version:"4.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","instagram","provider","photos","videos"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var uf={strings:{pluginNameInstagram:"Instagram"}};var li=class extends Z{static{o(this,"Instagram")}static VERSION=lf.version;icon;provider;view;storage;files;rootFolderId="recent";constructor(e,t){super(e,t),this.type="acquirer",this.files=[],this.storage=this.opts.storage||Ce,this.id=this.opts.id||"Instagram",this.icon=()=>l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:[l("defs",{children:l("path",{d:"M16.825 5l.483-.001.799.002c1.168.005 1.598.021 2.407.057 1.17.05 1.97.235 2.67.506.725.28 1.34.655 1.951 1.265.613.61.99 1.223 1.273 1.946.273.7.46 1.498.516 2.67l.025.552.008.205c.029.748.037 1.51.042 3.777l.001.846v.703l-.001.398a50.82 50.82 0 01-.058 2.588c-.05 1.17-.235 1.97-.506 2.67a5.394 5.394 0 01-1.265 1.951c-.61.613-1.222.99-1.946 1.273-.699.273-1.498.46-2.668.516-.243.012-.451.022-.656.03l-.204.007c-.719.026-1.512.034-3.676.038l-.847.001h-1.1a50.279 50.279 0 01-2.587-.059c-1.171-.05-1.971-.235-2.671-.506a5.394 5.394 0 01-1.951-1.265 5.385 5.385 0 01-1.272-1.946c-.274-.699-.46-1.498-.517-2.668a88.15 88.15 0 01-.03-.656l-.007-.205c-.026-.718-.034-1.512-.038-3.674v-2.129c.006-1.168.022-1.597.058-2.406.051-1.171.235-1.971.506-2.672a5.39 5.39 0 011.265-1.95 5.381 5.381 0 011.946-1.272c.699-.274 1.498-.462 2.669-.517l.656-.03.204-.007c.718-.026 1.511-.034 3.674-.038zm.678 1.981h-1.226l-.295.001c-2.307.005-3.016.013-3.777.043l-.21.009-.457.02c-1.072.052-1.654.232-2.042.383-.513.2-.879.44-1.263.825a3.413 3.413 0 00-.82 1.267c-.15.388-.33.97-.375 2.043a48.89 48.89 0 00-.056 2.482v.398 1.565c.006 2.937.018 3.285.073 4.444.05 1.073.231 1.654.382 2.043.2.512.44.878.825 1.263.386.383.753.621 1.267.82.388.15.97.328 2.043.374.207.01.388.017.563.024l.208.007a63.28 63.28 0 002.109.026h1.564c2.938-.006 3.286-.019 4.446-.073 1.071-.051 1.654-.232 2.04-.383.514-.2.88-.44 1.264-.825.384-.386.622-.753.82-1.266.15-.389.328-.971.375-2.044.039-.88.054-1.292.057-2.723v-1.15-.572c-.006-2.936-.019-3.284-.074-4.445-.05-1.071-.23-1.654-.382-2.04-.2-.515-.44-.88-.825-1.264a3.405 3.405 0 00-1.267-.82c-.388-.15-.97-.328-2.042-.375a48.987 48.987 0 00-2.535-.056zm-1.515 3.37a5.65 5.65 0 11.021 11.299 5.65 5.65 0 01-.02-11.3zm.004 1.982a3.667 3.667 0 10.015 7.334 3.667 3.667 0 00-.015-7.334zm5.865-3.536a1.32 1.32 0 11.005 2.64 1.32 1.32 0 01-.005-2.64z",id:"a"})}),l("g",{fill:"none","fill-rule":"evenodd",children:[l("mask",{id:"b",fill:"#fff",children:l("use",{xlinkHref:"#a"})}),l("image",{mask:"url(#b)",x:"4",y:"4",width:"24",height:"24",xlinkHref:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAALKADAAQAAAABAAAALAAAAAD8buejAAALZklEQVRYCVWZC2LbNhAFCRKykvP0bD1506SxRKIzbwHJoU3jv5h9WICU3P7+6zlG2zZvr8s/rW1tN7U0rMll8aDYufdzbLfc1JHmpv3jpPy8tsO+3O2s/O6YMSjTl/qdCds4mIIG60m8vdq2Z+phm2V4vAb9+o7BbZeuoM0NyYazvTvbvlN1MGjHUAesZ/IWWOsCeF0BOwAK4ITR0WYd/QKHEPv2DEymmorZtiubjOHEMYEzXmC9GMxu+95Kz+kuwxjDBKb8iUoCAdqZoAeyALreW6ZNx9Y4Jz8cLwjTZOEoR+HU05k2RzgP2iafGgfZiEdZbEr94zpX/xkPtDtGAxF+LRcgTsp9CAZg0rnEnXmPqFshY5vLnVWxLXO/bah2sZQgBZppGSe8NbjNPN5kc/WbIYEn8U+jXCOezT4zfgS1eoVEhceVeK74Fe4N6CoYEoLWykzHsd+GMAUqdTTVvvqT1uWqB3lVCLb12/ORAe8/5Zu9mp7lqoEFUCAFDIxqz7i1bq2AY1U9jqq2QK/7DYl+1AeZlAFcEc+U/jkRUqsvCHQ/nyGvjrOl6EuZWRWVGCKUMCkntQ5o+u2AZ3OxakbTcoBZnY0xhgGCUM4Kp1xtBTnBnXM5ASRms/Fs7d9OpX8bXN45pibQY/ML1MmA5G9CINBuCpdftexr6i2c5qd9J441LNJm3zk1GVusJ7v6mPJ7HPxJR0Li/vg9O1XHTEgvsQoSgExU0NnlLF0paK+6d06aOMKE2nCKV0ofNw4WsWmLsWrv6lPLnhGpr9E137QkHOMB/jh/T8MOqOadXarR44zPBW5NvDccnBxVmdK81+7RQ5p6qnQoRDZPh9+xWj0N2XpqxX1HzMty9UlFnKya/h3gulziAsyxwkSmpTIPB8vagKLyktRdDuBEHNGZMm4oCFWgjq31WPHpaC93gGNqpOpP4Ez4spa+nMNvhTWcuPKAJ79fqIxVoUvdjEG9qSy2WhpQlz61yG/gnKEA25IrIOYK6DIsQs2EE9LR/sTKq38Nd1y/X//FXG0QDHkEqSz3EYVV2dhb00rgLPSDcqmrScs55NNOD2zVqKmYnYTFnkACp520dkW5vBxK99BVzr792/iZ+VVo92UkKU2oG5WFTb6mNiA1H2C8KC0E44qaQleR3EQvQNwLrECOVAiSwM5gpF7nvDND0lZvYuQ9JbZfqdTrqCgwMcVrRS0z9QkLu9NWmkgEHb8p2zDRylj9VWA3lXD2vObEdWpT3w5MiFqQ1W/lteG4eipastxv2w+TeTBP0ypK84HiOW9fUzLcjRDwCW2b2VxmnGSKTX6uRSwMnC9YX4l05Mh2uwI+QVWdWUOSTWd5Xjjf7/tPYk2stSh053XTGN5RJMCMSajMcS8Trn3j/E1ajthlxCkmJXVi47PSUsyyq+jyexsayQNuv5GVYJaszprNsQD3RkgYiy49kFl2JlJJxlf8Uu/lpkq7+aWqzEzjr5cTVpFaJvSVr8AKRtiTlVPFk5t1nO30W+o6jrbAk76kxFa/tX+dom4C1wDPk03gqCw8HTBSxx4FHxIA+mh2pM3rKu5SNqBAuOSZnHzsB9JwW7DV/ge8dlVsOh375PvH8YO8EALU1HuecIC6qQgXifNuSx9XAoLaoGIYDjkWFrawX1U1XrknuMFw7QBSPtg79XovmBvwqnDICrhClEO6wgKFj9vPqJWlthUvdgH1DOA8+wFMexzQc5BUS1d1IsdBSjEv4Fe1LgBO1CpFPTpV1JuPSFNt4y/trzbtaUfwBWwM3/6JsrL6MSQYwLKXAm9YJBxsM8992MblZ63Gami0+rnwOMyPykVpQsyl9eYNOfVC6kRBkwaop//LgcAKWivkHF791g0JK5kMmCgKPas2QRkUFQsuTvm6R1946Wg95k764ZRLW59yO5UVGsawwELupCfAbdCuAwvcz5Xk18rIVEdgSRBRgO77R206QdXHuA2goaGiCQ0GmUfN1JlmFayjv0IcKGkfYt4HAj0yuQBRGDjzuS/rTmAf29Gov1S+FF7QBayNcpoBOEsMt3vFcIUC7VxOnE+pxmkgqEzduzwsPykrjBszCusgdarsRIAL6CM/KqsqcAf1vj8P1TXFyN6e5G8ao48fjKfDQJYizIdIfb+Xwp6Z2fE2C7mUfUEzMKqSBp4VUV1A49Sz1M2LzVzahEfyHUAcQNltR0nADYkBvHXDZQo8H9dQvHF7qhjPtSolBJ0A/vaLwdRz5YFFGoWBy8E/4aKcjqimaUBXXnjBpzOZnMlIVXsTVEBBUa+dD0BR0xVopgAD70psY0KjMHpmHB2kApea9o23NS83mpsref5OZet4U/0CMhSEDpwnxB9lVKSfk5djllXRFPizQmKcqMpnyZ3ycPntf96Ym9ChzU8vCQnhgWZ2UuySArw+cVBG4gqNCS6YoSEEziRWVStKUpe4FfCd91V0XA/qgOJuF7FpGjjyQgsFoNDtibp8cm+cyXxbB6zh4pMUO4H06yzsv4E/A6rg/uRJRnMRmrhMDIhyOjABX9CMDFhBFxx19KujjqWeim5PwVFU6IBiewfyk7IPETcg52kjXN7nsbaoEykKf/cjUgVxpTZZVtnqFMgv4FHa8oSOisawinMLHfUBzJcK1j8BeqquedKDtgcgnA4bym4P6gBWYVM3W/pn41ku5L4RElFWtlk5SXHEThhOWDiIyVROlQNM+wyHimlgATI/PPIm4BB8qfqwHnhgL89gzs+Ww1xQb4821SZ/4IwOJiRqH/X9u7Hj08JLSZfawOQcpRzwgk1oBNzzcgLn1FBNHspMENik9OG4awIDaUjw9rKNT1KXPl9neua6sSbkgqfs/CNfBdNfDDhQuL4AKXEXeOgZID91eOiRUnEFOIA5rnTkBU0/IT05gByoq5KBJF4Hym4Pxh3UcxZ7HjdhEhKWURbhavNR9rjLBwk3ryDcrGzfvk9I69b1yhMGWQ4bqMwv/RMSplQkjjVKXzZX8wESVcuB7QG0YUCMjk/aOmWgc/vC4oMCVYfghIGP6MT1zpeUhM1rQzOnGxmFKwTCir1Xaj5vN7T7nDZvnbDGHbCKnwji2zofNsOvbold3zlUtKGosBun3PbJSrrReHEaCQVCIDEMaCCBs+P+AbybkbIhmbNecGwF+E5/L2ECuPKCWsUESQkKnyyJ93TGACk7OrAY9P8XG//fGCoM7DAEUGnj5Mw7aQfelySWOm9iPuFyvrL8rKQR6mM6qdCUDQsfNPVu4yv/HaPOT1e/yDaviMKmTkg/I/F7MUG9OlrmDrBLRVd3c8KBJlPEKoVRcIJuhoQAmZDUkPC00W5OI1dOpQ1F61kFNqr9SmFcaHdBheOaDHF6QZMOP6QyiZ804oj98wLiAMIgcWw4UDYkDAWfR+4d5s0zP2GgUZX04i+NeSgYGokvbDhIZYUWHgd9K8zZzir264NxZUFbsfM1jdqpV2naA48tx6hsvBSabE4IMtlcOGgq8PqCjoly2rw2soqy4RJWQtPZl6PUCU14ZUWENuZV2Honn3f+k6R6wrkqgTStyQ0bFY+XAaafMRFgUlVeXxXFUcpLEYfZz3FrVUzZrOOJK+4B/wnIZ8TGRvb9OB8EUM0w8uNYj/oa9iK9AMoy6gA72o02srMxpAPUD+EDnVEF7P5xw896VyAbFk8MgnpVpR3gfLnt/wECq3rYFvYLcKCpqvcI+/hVl8AumXDeApklDRRKJSS+KOaq1Rgg4igOYtiQK1hJy46TBtDjznDp3iqJff5j0/LfSZbYVdauqXccJ9W+czupp0sU9gMlqkQ52lU1E6tUwoDUukAD6YRpAwqDrAErzA8QCRvXm98KEep0xIdY1CN1ye27IP0IHvvYIW18qGz8S7VWUZuMkUOb3P8DHTl67ur/i1UAAAAASUVORK5CYII="})]})]}),this.defaultLocale=uf,this.i18nInit(),this.title=this.i18n("pluginNameInstagram"),this.opts.companionAllowedHosts=He(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new qe(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"instagram",pluginId:this.id,supportsRefreshToken:!1}),this.render=this.render.bind(this)}install(){this.view=new Me(this,{provider:this.provider,viewType:"grid",showTitles:!1,showFilter:!1,showBreadcrumbs:!1});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}render(e){return this.view.render(e)}};var cf={name:"@uppy/onedrive",description:"Import files from OneDrive, into Uppy.",version:"4.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","onedrive"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var pf={strings:{pluginNameOneDrive:"OneDrive"}};var ui=class extends Z{static{o(this,"OneDrive")}static VERSION=cf.version;icon;provider;view;storage;files;rootFolderId=null;constructor(e,t){super(e,t),this.type="acquirer",this.files=[],this.storage=this.opts.storage||Ce,this.id=this.opts.id||"OneDrive",this.icon=()=>l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("g",{fill:"none",fillRule:"nonzero",children:[l("path",{d:"M13.39 12.888l4.618 2.747 2.752-1.15a4.478 4.478 0 012.073-.352 6.858 6.858 0 00-5.527-5.04 6.895 6.895 0 00-6.876 2.982l.07-.002a5.5 5.5 0 012.89.815z",fill:"#0364B8"}),l("path",{d:"M13.39 12.887v.001a5.5 5.5 0 00-2.89-.815l-.07.002a5.502 5.502 0 00-4.822 2.964 5.43 5.43 0 00.38 5.62l4.073-1.702 1.81-.757 4.032-1.685 2.105-.88-4.619-2.748z",fill:"#0078D4"}),l("path",{d:"M22.833 14.133a4.479 4.479 0 00-2.073.352l-2.752 1.15.798.475 2.616 1.556 1.141.68 3.902 2.321a4.413 4.413 0 00-.022-4.25 4.471 4.471 0 00-3.61-2.284z",fill:"#1490DF"}),l("path",{d:"M22.563 18.346l-1.141-.68-2.616-1.556-.798-.475-2.105.88L11.87 18.2l-1.81.757-4.073 1.702A5.503 5.503 0 0010.5 23h12.031a4.472 4.472 0 003.934-2.333l-3.902-2.321z",fill:"#28A8EA"})]})}),this.opts.companionAllowedHosts=He(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new qe(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"onedrive",pluginId:this.id,supportsRefreshToken:!1}),this.defaultLocale=pf,this.i18nInit(),this.title=this.i18n("pluginNameOneDrive"),this.render=this.render.bind(this)}install(){this.view=new Me(this,{provider:this.provider,loadAllFiles:!0,virtualList:!0});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}render(e){return this.view.render(e)}};var df={name:"@uppy/progress-bar",description:"A progress bar UI for Uppy",version:"4.3.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","progress","progress bar","upload progress"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"}};var y1={fixed:!1,hideAfterFinish:!0},dr=class extends Z{static{o(this,"ProgressBar")}static VERSION=df.version;constructor(e,t){super(e,{...y1,...t}),this.id=this.opts.id||"ProgressBar",this.title="Progress Bar",this.type="progressindicator",this.render=this.render.bind(this)}render(e){let{totalProgress:t}=e,r=(t===0||t===100)&&this.opts.hideAfterFinish;return l("div",{className:"uppy uppy-ProgressBar",style:{position:this.opts.fixed?"fixed":"initial"},"aria-hidden":r,children:[l("div",{className:"uppy-ProgressBar-inner",style:{width:`${t}%`}}),l("div",{className:"uppy-ProgressBar-percentage",children:t})]})}install(){let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}};var hf={name:"@uppy/redux-dev-tools",description:"Redux developer tools plugin for Uppy that simply syncs Uppy\u2019s state with redux-devtools browser or JS extensions, and allows for basic time travel",version:"4.1.3",license:"MIT",main:"lib/index.js",type:"module",keywords:["file uploader","redux","redux-dev-tools","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],peerDependencies:{"@uppy/core":"workspace:^"},scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"}};var Fs=class extends Z{static{o(this,"ReduxDevTools")}static VERSION=hf.version;constructor(e,t){super(e,t),this.type="debugger",this.id=this.opts.id||"ReduxDevTools",this.title="Redux DevTools";let r={};this.opts={...r,...t},this.handleStateChange=this.handleStateChange.bind(this),this.initDevTools=this.initDevTools.bind(this)}handleStateChange(e,t){this.devTools.send("UPPY_STATE_UPDATE",t)}initDevTools(){this.devTools=window.devToolsExtension.connect(),this.devToolsUnsubscribe=this.devTools.subscribe(e=>{if(e.type==="DISPATCH")switch(e.payload.type){case"RESET":this.uppy.cancelAll();return;case"IMPORT_STATE":{let{computedStates:t}=e.payload.nextLiftedState;this.uppy.store.state={...this.uppy.getState(),...t[t.length-1].state},this.uppy.updateAll(this.uppy.getState());return}case"JUMP_TO_STATE":case"JUMP_TO_ACTION":this.uppy.store.state={...this.uppy.getState(),...JSON.parse(e.state)},this.uppy.updateAll(this.uppy.getState());break;default:}})}install(){this.withDevTools=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__,this.withDevTools&&(this.initDevTools(),this.uppy.on("state-update",this.handleStateChange))}uninstall(){this.withDevTools&&(this.devToolsUnsubscribe(),this.uppy.off("state-update",this.handleStateUpdate))}};var ff={name:"@uppy/unsplash",description:"Import files from Unsplash, the free stock photography resource, into Uppy",version:"4.4.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","unsplash"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},publishConfig:{access:"public"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var mf={strings:{pluginNameUnsplash:"Unsplash"}};var ci=class extends Z{static{o(this,"Unsplash")}static VERSION=ff.version;icon;provider;view;storage;files;hostname;constructor(e,t){if(super(e,t),this.type="acquirer",this.files=[],this.storage=this.opts.storage||Ce,this.id=this.opts.id||"Unsplash",this.defaultLocale=mf,this.i18nInit(),this.title=this.i18n("pluginNameUnsplash"),this.icon=()=>l("svg",{className:"uppy-DashboardTab-iconUnsplash",viewBox:"0 0 32 32",height:"32",width:"32","aria-hidden":"true",children:l("g",{fill:"currentcolor",children:[l("path",{d:"M46.575 10.883v-9h12v9zm12 5h10v18h-32v-18h10v9h12z"}),l("path",{d:"M13 12.5V8h6v4.5zm6 2.5h5v9H8v-9h5v4.5h6z"})]})}),!this.opts.companionUrl)throw new Error("Companion hostname is required, please consult https://uppy.io/docs/companion");this.hostname=this.opts.companionUrl,this.opts.companionAllowedHosts=He(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new ki(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule,provider:"unsplash",pluginId:this.id})}install(){this.view=new Zt(this,{provider:this.provider,viewType:"unsplash",showFilter:!0,utmSource:this.opts.utmSource});let{target:e}=this.opts;e&&this.mount(e,this)}render(e){return this.view.render(e)}uninstall(){this.unmount()}};var gf={name:"@uppy/url",description:"The Url plugin lets users import files from the Internet. Paste any URL and it\u2019ll be added!",version:"4.3.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --silent='passed-only'","test:e2e":"vitest watch --project browser --browser.headless false"},keywords:["file uploader","url","import from url","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/utils":"workspace:^",nanoid:"^5.0.9",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^","@vitest/browser":"^3.2.4",cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"}};var yf={strings:{pluginNameUrl:"Link",import:"Import",enterUrlToImport:"Enter URL to import a file",failedToFetch:"Companion failed to fetch this URL, please make sure it\u2019s correct",enterCorrectUrl:"Incorrect URL: Please make sure you are entering a direct link to a file"}};var dl=class extends ge{static{o(this,"UrlUI")}form=document.createElement("form");input;constructor(e){super(e),this.form.id=wt()}componentDidMount(){this.input.value="",this.form.addEventListener("submit",this.#e),document.body.appendChild(this.form)}componentWillUnmount(){this.form.removeEventListener("submit",this.#e),document.body.removeChild(this.form)}#e=o(e=>{e.preventDefault();let{addFile:t}=this.props,r=this.input.value.trim();t(r)},"#handleSubmit");render(){let{i18n:e}=this.props;return l("div",{className:"uppy-Url",children:[l("input",{className:"uppy-u-reset uppy-c-textInput uppy-Url-input",type:"text","aria-label":e("enterUrlToImport"),placeholder:e("enterUrlToImport"),ref:o(t=>{this.input=t},"ref"),"data-uppy-super-focusable":!0,form:this.form.id}),l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Url-importButton",type:"submit",form:this.form.id,children:e("import")})]})}},vf=dl;function Ko(i,e,t){let r=Be(i.items),s;switch(e){case"paste":{if(r.some(a=>a.kind==="file"))return;s=r.filter(a=>a.kind==="string"&&a.type==="text/plain");break}case"drop":{s=r.filter(n=>n.kind==="string"&&n.type==="text/uri-list");break}default:throw new Error(`isDropOrPaste must be either 'drop' or 'paste', but it's ${e}`)}s.forEach(n=>{n.getAsString(a=>t(a))})}o(Ko,"forEachDroppedOrPastedUrl");function S1(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M23.637 15.312l-2.474 2.464a3.582 3.582 0 01-.577.491c-.907.657-1.897.986-2.968.986a4.925 4.925 0 01-3.959-1.971c-.248-.329-.164-.902.165-1.149.33-.247.907-.164 1.155.164 1.072 1.478 3.133 1.724 4.618.656a.642.642 0 00.33-.328l2.473-2.463c1.238-1.313 1.238-3.366-.082-4.597a3.348 3.348 0 00-4.618 0l-1.402 1.395a.799.799 0 01-1.154 0 .79.79 0 010-1.15l1.402-1.394a4.843 4.843 0 016.843 0c2.062 1.805 2.144 5.007.248 6.896zm-8.081 5.664l-1.402 1.395a3.348 3.348 0 01-4.618 0c-1.319-1.23-1.319-3.365-.082-4.596l2.475-2.464.328-.328c.743-.492 1.567-.739 2.475-.657.906.165 1.648.574 2.143 1.314.248.329.825.411 1.155.165.33-.248.412-.822.165-1.15-.825-1.068-1.98-1.724-3.216-1.888-1.238-.247-2.556.082-3.628.902l-.495.493-2.474 2.464c-1.897 1.969-1.814 5.09.083 6.977.99.904 2.226 1.396 3.463 1.396s2.473-.492 3.463-1.395l1.402-1.396a.79.79 0 000-1.15c-.33-.328-.908-.41-1.237-.082z",fill:"#FF753E","fill-rule":"nonzero"})})}o(S1,"UrlIcon");function x1(i){let e=/^[a-z0-9]+:\/\//,t="http://";return e.test(i)?i:t+i}o(x1,"addProtocolToURL");function _1(i){return Be(i.dataTransfer.items).filter(r=>r.kind==="string"&&r.type==="text/uri-list").length>0}o(_1,"canHandleRootDrop");function P1(i){return i?.startsWith("http://")||i?.startsWith("https://")}o(P1,"checkIfCorrectURL");function k1(i){let{pathname:e}=new URL(i);return e.substring(e.lastIndexOf("/")+1)}o(k1,"getFileNameFromUrl");var Vt=class i extends Z{static{o(this,"Url")}static VERSION=gf.version;static requestClientId=i.name;icon;hostname;client;canHandleRootDrop;constructor(e,t){if(super(e,t),this.id=this.opts.id||"Url",this.type="acquirer",this.icon=()=>l(S1,{}),this.defaultLocale=yf,this.i18nInit(),this.title=this.i18n("pluginNameUrl"),this.hostname=this.opts.companionUrl,!this.hostname)throw new Error("Companion hostname is required, please consult https://uppy.io/docs/companion");this.client=new Je(e,{pluginId:this.id,provider:"url",companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule}),this.uppy.registerRequestClient(i.requestClientId,this.client)}getMeta=o(e=>this.client.post("url/meta",{url:e}),"getMeta");addFile=o(async(e,t)=>{if(e.startsWith("blob"))return;let r=x1(e);if(!P1(r)){this.uppy.log(`[URL] Incorrect URL entered: ${r}`),this.uppy.info(this.i18n("enterCorrectUrl"),"error",4e3);return}this.uppy.log(`[URL] Adding file from dropped/pasted url: ${r}`);try{let s=await this.getMeta(r),n={meta:t,source:this.id,name:s.name||k1(r),type:s.type,data:{size:s.size},isRemote:!0,body:{url:r},remote:{companionUrl:this.opts.companionUrl,url:`${this.hostname}/url/get`,body:{fileId:r,url:r},requestClientId:i.requestClientId}};this.uppy.log("[Url] Adding remote file");try{return this.uppy.addFile(n)}catch(a){return a.isRestriction||this.uppy.log(a),a}}catch(s){return this.uppy.log(s),this.uppy.info({message:this.i18n("failedToFetch"),details:s},"error",4e3),s}},"addFile");handleRootDrop=o(e=>{Ko(e.dataTransfer,"drop",t=>{this.addFile(t)})},"handleRootDrop");handleRootPaste=o(e=>{Ko(e.clipboardData,"paste",t=>{this.addFile(t)})},"handleRootPaste");render(){return l(vf,{i18n:this.i18n,addFile:this.addFile})}install(){let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}};Vt.prototype.canHandleRootDrop=_1;var bf={name:"@uppy/zoom",description:"Import files from zoom, into Uppy.",version:"3.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","zoom"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},publishConfig:{access:"public"},devDependencies:{"@uppy/core":"workspace:^",typescript:"^5.8.3"}};var wf={strings:{pluginNameZoom:"Zoom"}};var pi=class extends Z{static{o(this,"Zoom")}static VERSION=bf.version;icon;provider;view;storage;files;rootFolderId=null;constructor(e,t){super(e,t),this.type="acquirer",this.files=[],this.storage=this.opts.storage||Ce,this.id=this.opts.id||"Zoom",this.icon=()=>l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M24.5 11.125l-2.75 2.063c-.473.353-.75.91-.75 1.5v3.124c0 .59.277 1.147.75 1.5l2.75 2.063a.938.938 0 001.5-.75v-8.75a.938.938 0 00-1.5-.75zm-4.75 9.5c0 1.035-.84 1.875-1.875 1.875H9.75A3.75 3.75 0 016 18.75v-6.875C6 10.84 6.84 10 7.875 10H16a3.75 3.75 0 013.75 3.75v6.875z",fill:"#2E8CFF","fill-rule":"evenodd"})}),this.opts.companionAllowedHosts=He(this.opts.companionAllowedHosts,this.opts.companionUrl),this.provider=new qe(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:"zoom",pluginId:this.id,supportsRefreshToken:!1}),this.defaultLocale=wf,this.i18nInit(),this.title=this.i18n("pluginNameZoom"),this.render=this.render.bind(this)}install(){this.view=new Me(this,{provider:this.provider});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}render(e){return this.view.render(e)}};var Sf={name:"@uppy/remote-sources",description:"Uppy plugin that includes all remote sources that Uppy+Companion offer, like Instagram, Google Drive, Dropox, Box, Unsplash, Url etc",version:"2.4.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","instagram","google-drive","facebook","dropbox","onedrive","zoom","unsplash","box","url"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/box":"workspace:^","@uppy/dashboard":"workspace:^","@uppy/dropbox":"workspace:^","@uppy/facebook":"workspace:^","@uppy/google-drive":"workspace:^","@uppy/instagram":"workspace:^","@uppy/onedrive":"workspace:^","@uppy/unsplash":"workspace:^","@uppy/url":"workspace:^","@uppy/zoom":"workspace:^"},peerDependencies:{"@uppy/core":"workspace:^"},publishConfig:{access:"public"},devDependencies:{"@uppy/core":"workspace:^",jsdom:"^26.1.0","resize-observer-polyfill":"^1.5.1",typescript:"^5.8.3",vitest:"^3.2.4"}};var hl={__proto__:null,Box:ei,Dropbox:si,Facebook:oi,GoogleDrive:ai,Instagram:li,OneDrive:ui,Unsplash:ci,Url:Vt,Zoom:pi},C1={sources:Object.keys(hl)},Cs=class extends we{static{o(this,"RemoteSources")}static VERSION=Sf.version;#e=new Set;constructor(e,t){if(super(e,{...C1,...t}),this.id=this.opts.id||"RemoteSources",this.type="preset",this.opts.companionUrl==null)throw new Error("Please specify companionUrl for RemoteSources to work, see https://uppy.io/docs/remote-sources#companionUrl")}setOptions(e){this.uninstall(),super.setOptions(e),this.install()}install(){this.opts.sources.forEach(e=>{let{sources:t,...r}=this.opts,s={...r,companionKeysParams:this.opts.companionKeysParams?.[e]},n=hl[e];if(n==null){let a=Object.keys(hl),u=new Intl.ListFormat("en",{style:"long",type:"disjunction"});throw new Error(`Invalid plugin: "${e}" is not one of: ${u.format(a)}.`)}this.uppy.use(n,s),this.#e.add(this.uppy.getPlugin(e))})}uninstall(){for(let e of this.#e)this.uppy.removePlugin(e);this.#e.clear()}};var xf={name:"@uppy/screen-capture",description:"Uppy plugin that captures video from display or application.",version:"4.4.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},keywords:["file uploader","uppy","uppy-plugin","screen capture","video","record","mediarecorder"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^",preact:"^10.5.13"},peerDependencies:{"@uppy/core":"workspace:^"},publishConfig:{access:"public"},devDependencies:{cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"}};var _f={strings:{pluginNameScreenCapture:"Screencast",startCapturing:"Begin screen capturing",stopCapturing:"Stop screen capturing",submitRecordedFile:"Submit recorded file",streamActive:"Stream active",streamPassive:"Stream passive",micDisabled:"Microphone access denied by user",recording:"Recording",takeScreenshot:"Take Screenshot",discardMediaFile:"Discard Media"}};function fl({onDiscard:i,i18n:e}){return l("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--discard",type:"button",title:e("discardMediaFile"),"aria-label":e("discardMediaFile"),onClick:i,"data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[l("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})}o(fl,"DiscardButton");function ml({recording:i,onStartRecording:e,onStopRecording:t,i18n:r}){return i?l("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--video uppy-ScreenCapture-button--stop-rec",type:"button",title:r("stopCapturing"),"aria-label":r("stopCapturing"),onClick:t,"data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100",children:l("rect",{x:"15",y:"15",width:"70",height:"70"})})}):l("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--video",type:"button",title:r("startCapturing"),"aria-label":r("startCapturing"),onClick:e,"data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:l("path",{d:"M4.5 4.5a3 3 0 0 0-3 3v9a3 3 0 0 0 3 3h8.25a3 3 0 0 0 3-3v-9a3 3 0 0 0-3-3H4.5ZM19.94 18.75l-2.69-2.69V7.94l2.69-2.69c.944-.945 2.56-.276 2.56 1.06v11.38c0 1.336-1.616 2.005-2.56 1.06Z"})})})}o(ml,"RecordButton");function gl({onScreenshot:i,i18n:e}){return l("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--screenshot",type:"button",title:e("takeScreenshot"),"aria-label":e("takeScreenshot"),onClick:i,"data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:[l("path",{d:"M12 9a3.75 3.75 0 1 0 0 7.5A3.75 3.75 0 0 0 12 9Z"}),l("path",{"fill-rule":"evenodd",d:"M9.344 3.071a49.52 49.52 0 0 1 5.312 0c.967.052 1.83.585 2.332 1.39l.821 1.317c.24.383.645.643 1.11.71.386.054.77.113 1.152.177 1.432.239 2.429 1.493 2.429 2.909V18a3 3 0 0 1-3 3h-15a3 3 0 0 1-3-3V9.574c0-1.416.997-2.67 2.429-2.909.382-.064.766-.123 1.151-.178a1.56 1.56 0 0 0 1.11-.71l.822-1.315a2.942 2.942 0 0 1 2.332-1.39ZM6.75 12.75a5.25 5.25 0 1 1 10.5 0 5.25 5.25 0 0 1-10.5 0Zm12-1.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"})]})})}o(gl,"ScreenshotButton");function A1(i){return(i-(i%=60))/60+(i>9?":":":0")+i}o(A1,"fmtMSS");var yl=class extends ge{static{o(this,"StopWatch")}wrapperStyle={width:"100%",height:"100%",display:"flex"};overlayStyle={position:"absolute",width:"100%",height:"100%",background:"black",opacity:.7};infoContainerStyle={marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto",zIndex:1,color:"white"};infotextStyle={marginLeft:"auto",marginRight:"auto",marginBottom:"1rem",fontSize:"1.5rem"};timeStyle={display:"block",fontWeight:"bold",marginLeft:"auto",marginRight:"auto",fontSize:"3rem",fontFamily:"Courier New"};timerRunning=!1;timer;constructor(e){super(e),this.state={elapsedTime:0}}startTimer(){this.timerTick(),this.timerRunning=!0}resetTimer(){clearTimeout(this.timer),this.setState({elapsedTime:0}),this.timerRunning=!1}timerTick(){this.timer=setTimeout(()=>{this.setState(e=>({elapsedTime:e.elapsedTime+1})),this.timerTick()},1e3)}render(){let{recording:e,i18n:t}={...this.props},{elapsedTime:r}=this.state,s=A1(r);return e&&!this.timerRunning&&this.startTimer(),!e&&this.timerRunning&&this.resetTimer(),e?l("div",{style:this.wrapperStyle,children:[l("div",{style:this.overlayStyle}),l("div",{style:this.infoContainerStyle,children:[l("div",{style:this.infotextStyle,children:t("recording")}),l("div",{style:this.timeStyle,children:s})]})]}):null}},Pf=yl;function vl({streamActive:i,i18n:e}){return i?l("div",{title:e("streamActive"),className:"uppy-ScreenCapture-icon--stream uppy-ScreenCapture-icon--streamActive",children:l("svg",{"aria-hidden":"true",focusable:"false",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M0 0h24v24H0z",opacity:".1",fill:"none"}),l("path",{d:"M0 0h24v24H0z",fill:"none"}),l("path",{d:"M1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm18-7H5v1.63c3.96 1.28 7.09 4.41 8.37 8.37H19V7zM1 10v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11zm20-7H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})]})}):l("div",{title:e("streamPassive"),className:"uppy-ScreenCapture-icon--stream",children:l("svg",{"aria-hidden":"true",focusable:"false",width:"24",height:"24",viewBox:"0 0 24 24",children:[l("path",{d:"M0 0h24v24H0z",opacity:".1",fill:"none"}),l("path",{d:"M0 0h24v24H0z",fill:"none"}),l("path",{d:"M21 3H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11z"})]})})}o(vl,"StreamStatus");function bl({recording:i,recordedVideo:e,onSubmit:t,capturedScreenshotUrl:r,i18n:s}){return(e||r)&&!i?l("button",{className:"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--submit",type:"button",title:s("submitRecordedFile"),"aria-label":s("submitRecordedFile"),onClick:t,"data-uppy-super-focusable":!0,children:l("svg",{width:"12",height:"9",viewBox:"0 0 12 9",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon",children:l("path",{fill:"#fff",fillRule:"nonzero",d:"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z"})})}):null}o(bl,"SubmitButton");var wl=class extends ge{static{o(this,"RecorderScreen")}videoElement=null;componentWillUnmount(){let{onStop:e}=this.props;e()}render(){let{recording:e,stream:t,recordedVideo:r,enableScreenshots:s,capturedScreenshotUrl:n}=this.props,a={playsinline:!0};return(e||!r&&!e)&&(a.muted=!0,a.autoplay=!0,a.srcObject=t),r&&!e&&(a.muted=!1,a.controls=!0,a.src=r,this.videoElement&&(this.videoElement.srcObject=null)),l("div",{className:"uppy uppy-ScreenCapture-container",children:[l("div",{className:"uppy-ScreenCapture-mediaContainer",children:[l(vl,{...this.props}),n&&!e&&!r?l("div",{className:"uppy-ScreenCapture-imageContainer",children:l("img",{src:n,className:"uppy-ScreenCapture-media",alt:"screenshotPreview"})}):l("video",{ref:o(u=>{this.videoElement=u},"ref"),className:"uppy-ScreenCapture-media",...a}),l("div",{children:l(Pf,{...this.props})})]}),l("div",{className:"uppy-ScreenCapture-buttonContainer",children:r||n?l(_e,{children:[l(bl,{...this.props}),l(fl,{...this.props})]}):l(_e,{children:[s&&!e&&l(gl,{...this.props}),l(ml,{...this.props})]})})]})}},kf=wl;function Sl(){return l("svg",{className:"uppy-DashboardTab-iconScreenRec","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("g",{fill:"currentcolor",fillRule:"evenodd",children:[l("path",{d:"M24.182 9H7.818C6.81 9 6 9.742 6 10.667v10c0 .916.81 1.666 1.818 1.666h4.546V24h7.272v-1.667h4.546c1 0 1.809-.75 1.809-1.666l.009-10C26 9.742 25.182 9 24.182 9zM24 21H8V11h16v10z"}),l("circle",{cx:"16",cy:"16",r:"2"})]})})}o(Sl,"ScreenRecIcon");function R1(){return window.MediaRecorder&&navigator.mediaDevices?.getDisplayMedia}o(R1,"isScreenRecordingSupported");function O1(){return window.MediaRecorder&&navigator.mediaDevices}o(O1,"getMediaDevices");var U1=["image/png","image/jpeg","image/webp"],D1={displayMediaConstraints:{video:{width:1280,height:720,frameRate:{ideal:3,max:5},cursor:"motion",displaySurface:"monitor"}},userMediaConstraints:{audio:!0},preferredVideoMimeType:"video/webm",preferredImageMimeType:"image/png",enableScreenshots:!0},hr=class extends Z{static{o(this,"ScreenCapture")}static VERSION=xf.version;mediaDevices;protocol;icon;streamInterrupted;captureActive;capturedMediaFile;videoStream=null;audioStream=null;userDenied=!1;recorder=null;outputStream=null;recordingChunks=null;constructor(e,t){super(e,{...D1,...t}),this.mediaDevices=O1(),this.protocol=location.protocol==="https:"?"https":"http",this.id=this.opts.id||"ScreenCapture",this.type="acquirer",this.icon=Sl,this.defaultLocale=_f,this.i18nInit(),this.title=this.i18n("pluginNameScreenCapture"),this.install=this.install.bind(this),this.setPluginState=this.setPluginState.bind(this),this.render=this.render.bind(this),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.startRecording=this.startRecording.bind(this),this.stopRecording=this.stopRecording.bind(this),this.submit=this.submit.bind(this),this.streamInterrupted=this.streamInactivated.bind(this),this.captureScreenshot=this.captureScreenshot.bind(this),this.discardRecordedMedia=this.discardRecordedMedia.bind(this),this.captureActive=!1,this.capturedMediaFile=null,this.setPluginState({streamActive:!1,audioStreamActive:!1,recording:!1,recordedVideo:null,screenRecError:null,capturedScreenshotUrl:null,status:"init"})}install(){if(!R1())return this.uppy.log("Screen recorder access is not supported","warning"),null;this.setPluginState({streamActive:!1,audioStreamActive:!1,status:"init"});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.videoStream&&this.stop(),this.unmount()}start(){return this.mediaDevices?(this.captureActive=!0,this.selectAudioStreamSource(),this.selectVideoStreamSource().then(e=>{e===!1&&this.parent?.hideAllPanels&&(this.parent.hideAllPanels(),this.captureActive=!1)})):Promise.reject(new Error("Screen recorder access not supported"))}selectVideoStreamSource(){return this.videoStream?new Promise(e=>e(this.videoStream)):this.mediaDevices.getDisplayMedia(this.opts.displayMediaConstraints).then(e=>(this.videoStream=e,this.videoStream.addEventListener("inactive",()=>{this.streamInactivated()}),this.setPluginState({streamActive:!0,status:"ready",screenRecError:null}),e)).catch(e=>(this.setPluginState({screenRecError:e,status:"error"}),this.userDenied=!0,setTimeout(()=>{this.userDenied=!1},1e3),!1))}selectAudioStreamSource(){return this.audioStream?new Promise(e=>e(this.audioStream)):this.mediaDevices.getUserMedia(this.opts.userMediaConstraints).then(e=>(this.audioStream=e,this.setPluginState({audioStreamActive:!0}),e)).catch(e=>(e.name==="NotAllowedError"&&(this.uppy.info(this.i18n("micDisabled"),"error",5e3),this.uppy.log(this.i18n("micDisabled"),"warning")),!1))}startRecording(){let e={};this.capturedMediaFile=null,this.recordingChunks=[];let{preferredVideoMimeType:t}=this.opts;this.selectVideoStreamSource().then(r=>{if(r===!1)throw new Error("No video stream available");t&&MediaRecorder.isTypeSupported(t)&&Et(t)&&(e.mimeType=t);let s=[r.getVideoTracks()[0]];this.audioStream&&s.push(this.audioStream.getAudioTracks()[0]),this.outputStream=new MediaStream(s),this.recorder=new MediaRecorder(this.outputStream,e),this.recorder.addEventListener("dataavailable",n=>{this.recordingChunks.push(n.data)}),this.recorder.start(),this.setPluginState({recording:!0,status:"recording"})}).catch(r=>{this.uppy.log(r,"error"),this.setPluginState({screenRecError:r,status:"error"})})}streamInactivated(){let{recordedVideo:e,recording:t}={...this.getPluginState()};!e&&!t?(this.parent?.hideAllPanels&&this.parent.hideAllPanels(),this.setPluginState({status:"init"})):t&&(this.uppy.log("Capture stream inactive \u2014 stop recording"),this.stopRecording()),this.videoStream=null,this.audioStream=null,this.setPluginState({streamActive:!1,audioStreamActive:!1})}stopRecording(){return new Promise(t=>{this.recorder.addEventListener("stop",()=>{t()}),this.recorder.stop()}).then(()=>(this.setPluginState({recording:!1}),this.getVideo())).then(t=>{this.capturedMediaFile=t,this.setPluginState({recordedVideo:URL.createObjectURL(t.data),status:"captured"})}).then(()=>{this.recordingChunks=null,this.recorder=null},t=>{throw this.recordingChunks=null,this.recorder=null,t})}discardRecordedMedia(){let{capturedScreenshotUrl:e,recordedVideo:t}=this.getPluginState();e&&URL.revokeObjectURL(e),t&&URL.revokeObjectURL(t),this.capturedMediaFile=null,this.setPluginState({recordedVideo:null,capturedScreenshotUrl:null,status:this.getPluginState().streamActive?"ready":"init"})}submit(){try{this.capturedMediaFile&&this.uppy.addFile(this.capturedMediaFile)}catch(e){e.isRestriction||this.uppy.log(e,"warning")}}stop(){this.videoStream&&(this.videoStream.getVideoTracks().forEach(r=>{r.stop()}),this.videoStream.getAudioTracks().forEach(r=>{r.stop()}),this.videoStream=null),this.audioStream&&(this.audioStream.getAudioTracks().forEach(r=>{r.stop()}),this.audioStream.getVideoTracks().forEach(r=>{r.stop()}),this.audioStream=null),this.outputStream&&(this.outputStream.getAudioTracks().forEach(r=>{r.stop()}),this.outputStream.getVideoTracks().forEach(r=>{r.stop()}),this.outputStream=null);let{capturedScreenshotUrl:e,recordedVideo:t}=this.getPluginState();e&&URL.revokeObjectURL(e),t&&URL.revokeObjectURL(t),this.setPluginState({recording:!1,streamActive:!1,audioStreamActive:!1,recordedVideo:null,capturedScreenshotUrl:null,status:"init"}),this.captureActive=!1}getVideo(){let e=this.recordingChunks[0].type,t=Et(e);if(!t)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type "${e}"`));let r=`screencap-${Date.now()}.${t}`,s=new Blob(this.recordingChunks,{type:e}),n={source:this.id,name:r,data:new Blob([s],{type:e}),type:e};return Promise.resolve(n)}async captureScreenshot(){if(!this.mediaDevices?.getDisplayMedia)throw new Error("Screen capture is not supported");try{let e=this.videoStream;if(!e){let u=await this.selectVideoStreamSource();if(!u)throw new Error("Failed to get screen capture stream");e=u}let t=document.createElement("video");t.srcObject=e,await new Promise(u=>{t.onloadedmetadata=()=>{t.play(),u(null)}});let r=document.createElement("canvas");r.width=t.videoWidth,r.height=t.videoHeight;let s=r.getContext("2d");if(!s)throw new Error("Failed to get canvas context");s.drawImage(t,0,0,r.width,r.height);let n=this.opts.preferredImageMimeType;(!n||!U1.includes(n))&&(this.uppy.log(`Unsupported image type "${n}", falling back to image/png`,"warning"),n="image/png");let a=1;return new Promise((u,c)=>{r.toBlob(p=>{if(!p){c(new Error("Failed to create screenshot blob"));return}let g=Et(n)||"png",h={source:this.id,name:`Screenshot ${new Date().toISOString()}.${g}`,type:n,data:p};try{this.capturedMediaFile=h;let b=URL.createObjectURL(p);this.setPluginState({capturedScreenshotUrl:b,status:"captured"}),u()}catch(b){this.getPluginState().capturedScreenshotUrl&&this.setPluginState({capturedScreenshotUrl:null}),b.isRestriction||this.uppy.log(b,"error"),c(b)}finally{t.srcObject=null,r.remove(),t.remove()}},n,a)})}catch(e){throw this.uppy.log(e,"error"),e}}render(){let e=this.getPluginState();return!e.streamActive&&!this.captureActive&&!this.userDenied&&this.start(),l(kf,{...e,onStartRecording:this.startRecording,onStopRecording:this.stopRecording,enableScreenshots:this.opts.enableScreenshots,onScreenshot:this.captureScreenshot,onStop:this.stop,onSubmit:this.submit,i18n:this.i18n,stream:this.videoStream,onDiscard:this.discardRecordedMedia})}};var Ef={name:"@uppy/store-redux",description:"Make Uppy use your existing Redux store.",version:"4.1.2",license:"MIT",main:"lib/index.js",type:"module",keywords:["file uploader","uppy","uppy-plugin","redux"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{nanoid:"^5.0.9"},devDependencies:{jsdom:"^26.1.0",redux:"^4.0.0",vitest:"^3.2.4"},scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"}};var N1="uppy/STATE_UPDATE",M1=o(i=>e=>e.uppy[i],"defaultSelector");function L1(i,e){let t=Object.keys(e),r={};return t.forEach(s=>{i[s]!==e[s]&&(r[s]=e[s])}),r}o(L1,"getPatch");var xl=class{static{o(this,"ReduxStore")}static VERSION=Ef.version;#e;#t;#r;constructor(e){this.#r=e.store,this.#e=e.id||wt(),this.#t=e.selector||M1(this.#e),this.setState({})}setState(e){this.#r.dispatch({type:N1,id:this.#e,payload:e})}getState(){return this.#t(this.#r.getState())}subscribe(e){let t=this.getState();return this.#r.subscribe(()=>{let r=this.getState();if(t!==r){let s=L1(t,r);e(t,r,s),t=r}})}[Symbol.for("uppy test: get id")](){return this.#e}};var Ff=xl;function B1(i){return i?i.readyState!==0&&i.readyState!==4||i.status===0:!1}o(B1,"isNetworkError");var Xo=B1;function fr(i){"@babel/helpers - typeof";return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(i)}o(fr,"_typeof");function Cf(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,z1(r.key),r)}}o(Cf,"_defineProperties");function j1(i,e,t){return e&&Cf(i.prototype,e),t&&Cf(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(j1,"_createClass");function z1(i){var e=H1(i,"string");return fr(e)=="symbol"?e:e+""}o(z1,"_toPropertyKey");function H1(i,e){if(fr(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(fr(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(H1,"_toPrimitive");function q1(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(q1,"_classCallCheck");function V1(i,e,t){return e=As(e),$1(i,Pl()?Reflect.construct(e,t||[],As(i).constructor):e.apply(i,t))}o(V1,"_callSuper");function $1(i,e){if(e&&(fr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W1(i)}o($1,"_possibleConstructorReturn");function W1(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}o(W1,"_assertThisInitialized");function G1(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Ts(i,e)}o(G1,"_inherits");function _l(i){var e=typeof Map=="function"?new Map:void 0;return _l=o(function(r){if(r===null||!X1(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(r))return e.get(r);e.set(r,s)}function s(){return K1(r,arguments,As(this).constructor)}return o(s,"Wrapper"),s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),Ts(s,r)},"_wrapNativeSuper"),_l(i)}o(_l,"_wrapNativeSuper");function K1(i,e,t){if(Pl())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var s=new(i.bind.apply(i,r));return t&&Ts(s,t.prototype),s}o(K1,"_construct");function Pl(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pl=o(function(){return!!i},"_isNativeReflectConstruct"))()}o(Pl,"_isNativeReflectConstruct");function X1(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}o(X1,"_isNativeFunction");function Ts(i,e){return Ts=Object.setPrototypeOf?Object.setPrototypeOf.bind():o(function(r,s){return r.__proto__=s,r},"_setPrototypeOf"),Ts(i,e)}o(Ts,"_setPrototypeOf");function As(i){return As=Object.setPrototypeOf?Object.getPrototypeOf.bind():o(function(t){return t.__proto__||Object.getPrototypeOf(t)},"_getPrototypeOf"),As(i)}o(As,"_getPrototypeOf");var Y1=function(i){function e(t){var r,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(q1(this,e),r=V1(this,e,[t]),r.originalRequest=n,r.originalResponse=a,r.causingError=s,s!=null&&(t+=", caused by ".concat(s.toString())),n!=null){var u=n.getHeader("X-Request-ID")||"n/a",c=n.getMethod(),p=n.getURL(),g=a?a.getStatus():"n/a",h=a?a.getBody()||"":"n/a";t+=", originated from request (method: ".concat(c,", url: ").concat(p,", response code: ").concat(g,", response text: ").concat(h,", request id: ").concat(u,")")}return r.message=t,r}return o(e,"DetailedError"),G1(e,i),j1(e)}(_l(Error)),mr=Y1;var J1=!1;function di(i){J1&&console.log(i)}o(di,"log");function Rs(i){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(i)}o(Rs,"_typeof");function Q1(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(Q1,"_classCallCheck");function Tf(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,ew(r.key),r)}}o(Tf,"_defineProperties");function Z1(i,e,t){return e&&Tf(i.prototype,e),t&&Tf(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(Z1,"_createClass");function ew(i){var e=tw(i,"string");return Rs(e)=="symbol"?e:e+""}o(ew,"_toPropertyKey");function tw(i,e){if(Rs(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Rs(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(tw,"_toPrimitive");var Af=function(){function i(){Q1(this,i)}return o(i,"NoopUrlStorage"),Z1(i,[{key:"listAllUploads",value:o(function(){return Promise.resolve([])},"listAllUploads")},{key:"findUploadsByFingerprint",value:o(function(t){return Promise.resolve([])},"findUploadsByFingerprint")},{key:"removeUpload",value:o(function(t){return Promise.resolve()},"removeUpload")},{key:"addUpload",value:o(function(t,r){return Promise.resolve(null)},"addUpload")}])}();var Nf="3.7.7",iw=Nf,yr=typeof Buffer=="function",Rf=typeof TextDecoder=="function"?new TextDecoder:void 0,Of=typeof TextEncoder=="function"?new TextEncoder:void 0,rw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Os=Array.prototype.slice.call(rw),Yo=(i=>{let e={};return i.forEach((t,r)=>e[t]=r),e})(Os),sw=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Qe=String.fromCharCode.bind(String),Uf=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):i=>new Uint8Array(Array.prototype.slice.call(i,0)),Mf=o(i=>i.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),"_mkUriSafe"),Lf=o(i=>i.replace(/[^A-Za-z0-9\+\/]/g,""),"_tidyB64"),Bf=o(i=>{let e,t,r,s,n="",a=i.length%3;for(let u=0;u<i.length;){if((t=i.charCodeAt(u++))>255||(r=i.charCodeAt(u++))>255||(s=i.charCodeAt(u++))>255)throw new TypeError("invalid character found");e=t<<16|r<<8|s,n+=Os[e>>18&63]+Os[e>>12&63]+Os[e>>6&63]+Os[e&63]}return a?n.slice(0,a-3)+"===".substring(a):n},"btoaPolyfill"),Fl=typeof btoa=="function"?i=>btoa(i):yr?i=>Buffer.from(i,"binary").toString("base64"):Bf,kl=yr?i=>Buffer.from(i).toString("base64"):i=>{let t=[];for(let r=0,s=i.length;r<s;r+=4096)t.push(Qe.apply(null,i.subarray(r,r+4096)));return Fl(t.join(""))},Jo=o((i,e=!1)=>e?Mf(kl(i)):kl(i),"fromUint8Array"),ow=o(i=>{if(i.length<2){var e=i.charCodeAt(0);return e<128?i:e<2048?Qe(192|e>>>6)+Qe(128|e&63):Qe(224|e>>>12&15)+Qe(128|e>>>6&63)+Qe(128|e&63)}else{var e=65536+(i.charCodeAt(0)-55296)*1024+(i.charCodeAt(1)-56320);return Qe(240|e>>>18&7)+Qe(128|e>>>12&63)+Qe(128|e>>>6&63)+Qe(128|e&63)}},"cb_utob"),nw=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,jf=o(i=>i.replace(nw,ow),"utob"),Df=yr?i=>Buffer.from(i,"utf8").toString("base64"):Of?i=>kl(Of.encode(i)):i=>Fl(jf(i)),gr=o((i,e=!1)=>e?Mf(Df(i)):Df(i),"encode"),If=o(i=>gr(i,!0),"encodeURI"),aw=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,lw=o(i=>{switch(i.length){case 4:var e=(7&i.charCodeAt(0))<<18|(63&i.charCodeAt(1))<<12|(63&i.charCodeAt(2))<<6|63&i.charCodeAt(3),t=e-65536;return Qe((t>>>10)+55296)+Qe((t&1023)+56320);case 3:return Qe((15&i.charCodeAt(0))<<12|(63&i.charCodeAt(1))<<6|63&i.charCodeAt(2));default:return Qe((31&i.charCodeAt(0))<<6|63&i.charCodeAt(1))}},"cb_btou"),zf=o(i=>i.replace(aw,lw),"btou"),Hf=o(i=>{if(i=i.replace(/\s+/g,""),!sw.test(i))throw new TypeError("malformed base64.");i+="==".slice(2-(i.length&3));let e,t="",r,s;for(let n=0;n<i.length;)e=Yo[i.charAt(n++)]<<18|Yo[i.charAt(n++)]<<12|(r=Yo[i.charAt(n++)])<<6|(s=Yo[i.charAt(n++)]),t+=r===64?Qe(e>>16&255):s===64?Qe(e>>16&255,e>>8&255):Qe(e>>16&255,e>>8&255,e&255);return t},"atobPolyfill"),Cl=typeof atob=="function"?i=>atob(Lf(i)):yr?i=>Buffer.from(i,"base64").toString("binary"):Hf,qf=yr?i=>Uf(Buffer.from(i,"base64")):i=>Uf(Cl(i).split("").map(e=>e.charCodeAt(0))),Vf=o(i=>qf($f(i)),"toUint8Array"),uw=yr?i=>Buffer.from(i,"base64").toString("utf8"):Rf?i=>Rf.decode(qf(i)):i=>zf(Cl(i)),$f=o(i=>Lf(i.replace(/[-_]/g,e=>e=="-"?"+":"/")),"_unURI"),El=o(i=>uw($f(i)),"decode"),cw=o(i=>{if(typeof i!="string")return!1;let e=i.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},"isValid"),Wf=o(i=>({value:i,enumerable:!1,writable:!0,configurable:!0}),"_noEnum"),Gf=o(function(){let i=o((e,t)=>Object.defineProperty(String.prototype,e,Wf(t)),"_add");i("fromBase64",function(){return El(this)}),i("toBase64",function(e){return gr(this,e)}),i("toBase64URI",function(){return gr(this,!0)}),i("toBase64URL",function(){return gr(this,!0)}),i("toUint8Array",function(){return Vf(this)})},"extendString"),Kf=o(function(){let i=o((e,t)=>Object.defineProperty(Uint8Array.prototype,e,Wf(t)),"_add");i("toBase64",function(e){return Jo(this,e)}),i("toBase64URI",function(){return Jo(this,!0)}),i("toBase64URL",function(){return Jo(this,!0)})},"extendUint8Array"),pw=o(()=>{Gf(),Kf()},"extendBuiltins"),Xf={version:Nf,VERSION:iw,atob:Cl,atobPolyfill:Hf,btoa:Fl,btoaPolyfill:Bf,fromBase64:El,toBase64:gr,encode:gr,encodeURI:If,encodeURL:If,utob:jf,btou:zf,decode:El,isValid:cw,fromUint8Array:Jo,toUint8Array:Vf,extendString:Gf,extendUint8Array:Kf,extendBuiltins:pw};var Sm=de(lm());function Ol(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var e=Math.random()*16|0,t=i==="x"?e:e&3|8;return t.toString(16)})}o(Ol,"uuid");function Ul(){"use strict";Ul=o(function(){return e},"_regeneratorRuntime");var i,e={},t=Object.prototype,r=t.hasOwnProperty,s=Object.defineProperty||function(k,w,S){k[w]=S.value},n=typeof Symbol=="function"?Symbol:{},a=n.iterator||"@@iterator",u=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function p(k,w,S){return Object.defineProperty(k,w,{value:S,enumerable:!0,configurable:!0,writable:!0}),k[w]}o(p,"define");try{p({},"")}catch{p=o(function(S,B,q){return S[B]=q},"define")}function g(k,w,S,B){var q=w&&w.prototype instanceof O?w:O,z=Object.create(q.prototype),D=new Te(B||[]);return s(z,"_invoke",{value:be(k,S,D)}),z}o(g,"wrap");function h(k,w,S){try{return{type:"normal",arg:k.call(w,S)}}catch(B){return{type:"throw",arg:B}}}o(h,"tryCatch"),e.wrap=g;var b="suspendedStart",P="suspendedYield",F="executing",M="completed",C={};function O(){}o(O,"Generator");function U(){}o(U,"GeneratorFunction");function A(){}o(A,"GeneratorFunctionPrototype");var J={};p(J,a,function(){return this});var G=Object.getPrototypeOf,W=G&&G(G(Se([])));W&&W!==t&&r.call(W,a)&&(J=W);var K=A.prototype=O.prototype=Object.create(J);function te(k){["next","throw","return"].forEach(function(w){p(k,w,function(S){return this._invoke(w,S)})})}o(te,"defineIteratorMethods");function Q(k,w){function S(q,z,D,E){var T=h(k[q],k,z);if(T.type!=="throw"){var L=T.arg,X=L.value;return X&&Ii(X)=="object"&&r.call(X,"__await")?w.resolve(X.__await).then(function(Y){S("next",Y,D,E)},function(Y){S("throw",Y,D,E)}):w.resolve(X).then(function(Y){L.value=Y,D(L)},function(Y){return S("throw",Y,D,E)})}E(T.arg)}o(S,"invoke");var B;s(this,"_invoke",{value:o(function(z,D){function E(){return new w(function(T,L){S(z,D,T,L)})}return o(E,"callInvokeWithMethodAndArg"),B=B?B.then(E,E):E()},"value")})}o(Q,"AsyncIterator");function be(k,w,S){var B=b;return function(q,z){if(B===F)throw Error("Generator is already running");if(B===M){if(q==="throw")throw z;return{value:i,done:!0}}for(S.method=q,S.arg=z;;){var D=S.delegate;if(D){var E=ne(D,S);if(E){if(E===C)continue;return E}}if(S.method==="next")S.sent=S._sent=S.arg;else if(S.method==="throw"){if(B===b)throw B=M,S.arg;S.dispatchException(S.arg)}else S.method==="return"&&S.abrupt("return",S.arg);B=F;var T=h(k,w,S);if(T.type==="normal"){if(B=S.done?M:P,T.arg===C)continue;return{value:T.arg,done:S.done}}T.type==="throw"&&(B=M,S.method="throw",S.arg=T.arg)}}}o(be,"makeInvokeMethod");function ne(k,w){var S=w.method,B=k.iterator[S];if(B===i)return w.delegate=null,S==="throw"&&k.iterator.return&&(w.method="return",w.arg=i,ne(k,w),w.method==="throw")||S!=="return"&&(w.method="throw",w.arg=new TypeError("The iterator does not provide a '"+S+"' method")),C;var q=h(B,k.iterator,w.arg);if(q.type==="throw")return w.method="throw",w.arg=q.arg,w.delegate=null,C;var z=q.arg;return z?z.done?(w[k.resultName]=z.value,w.next=k.nextLoc,w.method!=="return"&&(w.method="next",w.arg=i),w.delegate=null,C):z:(w.method="throw",w.arg=new TypeError("iterator result is not an object"),w.delegate=null,C)}o(ne,"maybeInvokeDelegate");function Pe(k){var w={tryLoc:k[0]};1 in k&&(w.catchLoc=k[1]),2 in k&&(w.finallyLoc=k[2],w.afterLoc=k[3]),this.tryEntries.push(w)}o(Pe,"pushTryEntry");function ye(k){var w=k.completion||{};w.type="normal",delete w.arg,k.completion=w}o(ye,"resetTryEntry");function Te(k){this.tryEntries=[{tryLoc:"root"}],k.forEach(Pe,this),this.reset(!0)}o(Te,"Context");function Se(k){if(k||k===""){var w=k[a];if(w)return w.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var S=-1,B=o(function q(){for(;++S<k.length;)if(r.call(k,S))return q.value=k[S],q.done=!1,q;return q.value=i,q.done=!0,q},"next");return B.next=B}}throw new TypeError(Ii(k)+" is not iterable")}return o(Se,"values"),U.prototype=A,s(K,"constructor",{value:A,configurable:!0}),s(A,"constructor",{value:U,configurable:!0}),U.displayName=p(A,c,"GeneratorFunction"),e.isGeneratorFunction=function(k){var w=typeof k=="function"&&k.constructor;return!!w&&(w===U||(w.displayName||w.name)==="GeneratorFunction")},e.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,A):(k.__proto__=A,p(k,c,"GeneratorFunction")),k.prototype=Object.create(K),k},e.awrap=function(k){return{__await:k}},te(Q.prototype),p(Q.prototype,u,function(){return this}),e.AsyncIterator=Q,e.async=function(k,w,S,B,q){q===void 0&&(q=Promise);var z=new Q(g(k,w,S,B),q);return e.isGeneratorFunction(w)?z:z.next().then(function(D){return D.done?D.value:z.next()})},te(K),p(K,c,"Generator"),p(K,a,function(){return this}),p(K,"toString",function(){return"[object Generator]"}),e.keys=function(k){var w=Object(k),S=[];for(var B in w)S.push(B);return S.reverse(),o(function q(){for(;S.length;){var z=S.pop();if(z in w)return q.value=z,q.done=!1,q}return q.done=!0,q},"next")},e.values=Se,Te.prototype={constructor:Te,reset:o(function(w){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(ye),!w)for(var S in this)S.charAt(0)==="t"&&r.call(this,S)&&!isNaN(+S.slice(1))&&(this[S]=i)},"reset"),stop:o(function(){this.done=!0;var w=this.tryEntries[0].completion;if(w.type==="throw")throw w.arg;return this.rval},"stop"),dispatchException:o(function(w){if(this.done)throw w;var S=this;function B(L,X){return D.type="throw",D.arg=w,S.next=L,X&&(S.method="next",S.arg=i),!!X}o(B,"handle");for(var q=this.tryEntries.length-1;q>=0;--q){var z=this.tryEntries[q],D=z.completion;if(z.tryLoc==="root")return B("end");if(z.tryLoc<=this.prev){var E=r.call(z,"catchLoc"),T=r.call(z,"finallyLoc");if(E&&T){if(this.prev<z.catchLoc)return B(z.catchLoc,!0);if(this.prev<z.finallyLoc)return B(z.finallyLoc)}else if(E){if(this.prev<z.catchLoc)return B(z.catchLoc,!0)}else{if(!T)throw Error("try statement without catch or finally");if(this.prev<z.finallyLoc)return B(z.finallyLoc)}}}},"dispatchException"),abrupt:o(function(w,S){for(var B=this.tryEntries.length-1;B>=0;--B){var q=this.tryEntries[B];if(q.tryLoc<=this.prev&&r.call(q,"finallyLoc")&&this.prev<q.finallyLoc){var z=q;break}}z&&(w==="break"||w==="continue")&&z.tryLoc<=S&&S<=z.finallyLoc&&(z=null);var D=z?z.completion:{};return D.type=w,D.arg=S,z?(this.method="next",this.next=z.finallyLoc,C):this.complete(D)},"abrupt"),complete:o(function(w,S){if(w.type==="throw")throw w.arg;return w.type==="break"||w.type==="continue"?this.next=w.arg:w.type==="return"?(this.rval=this.arg=w.arg,this.method="return",this.next="end"):w.type==="normal"&&S&&(this.next=S),C},"complete"),finish:o(function(w){for(var S=this.tryEntries.length-1;S>=0;--S){var B=this.tryEntries[S];if(B.finallyLoc===w)return this.complete(B.completion,B.afterLoc),ye(B),C}},"finish"),catch:o(function(w){for(var S=this.tryEntries.length-1;S>=0;--S){var B=this.tryEntries[S];if(B.tryLoc===w){var q=B.completion;if(q.type==="throw"){var z=q.arg;ye(B)}return z}}throw Error("illegal catch attempt")},"_catch"),delegateYield:o(function(w,S,B){return this.delegate={iterator:Se(w),resultName:S,nextLoc:B},this.method==="next"&&(this.arg=i),C},"delegateYield")},e}o(Ul,"_regeneratorRuntime");function um(i,e,t,r,s,n,a){try{var u=i[n](a),c=u.value}catch(p){t(p);return}u.done?e(c):Promise.resolve(c).then(r,s)}o(um,"asyncGeneratorStep");function _w(i){return function(){var e=this,t=arguments;return new Promise(function(r,s){var n=i.apply(e,t);function a(c){um(n,r,s,a,u,"next",c)}o(a,"_next");function u(c){um(n,r,s,a,u,"throw",c)}o(u,"_throw"),a(void 0)})}}o(_w,"_asyncToGenerator");function vm(i,e){return Ew(i)||kw(i,e)||bm(i,e)||Pw()}o(vm,"_slicedToArray");function Pw(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}o(Pw,"_nonIterableRest");function kw(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r,s,n,a,u=[],c=!0,p=!1;try{if(n=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=n.call(t)).done)&&(u.push(r.value),u.length!==e);c=!0);}catch(g){p=!0,s=g}finally{try{if(!c&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(p)throw s}}return u}}o(kw,"_iterableToArrayLimit");function Ew(i){if(Array.isArray(i))return i}o(Ew,"_arrayWithHoles");function Ii(i){"@babel/helpers - typeof";return Ii=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ii(i)}o(Ii,"_typeof");function Fw(i,e){var t=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!t){if(Array.isArray(i)||(t=bm(i))||e&&i&&typeof i.length=="number"){t&&(i=t);var r=0,s=o(function(){},"F");return{s,n:o(function(){return r>=i.length?{done:!0}:{done:!1,value:i[r++]}},"n"),e:o(function(p){throw p},"e"),f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var n=!0,a=!1,u;return{s:o(function(){t=t.call(i)},"s"),n:o(function(){var p=t.next();return n=p.done,p},"n"),e:o(function(p){a=!0,u=p},"e"),f:o(function(){try{!n&&t.return!=null&&t.return()}finally{if(a)throw u}},"f")}}o(Fw,"_createForOfIteratorHelper");function bm(i,e){if(i){if(typeof i=="string")return cm(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return cm(i,e)}}o(bm,"_unsupportedIterableToArray");function cm(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=i[t];return r}o(cm,"_arrayLikeToArray");function pm(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,r)}return t}o(pm,"ownKeys");function vr(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?pm(Object(t),!0).forEach(function(r){Cw(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):pm(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}o(vr,"_objectSpread");function Cw(i,e,t){return e=wm(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}o(Cw,"_defineProperty");function Tw(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(Tw,"_classCallCheck");function dm(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,wm(r.key),r)}}o(dm,"_defineProperties");function Aw(i,e,t){return e&&dm(i.prototype,e),t&&dm(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(Aw,"_createClass");function wm(i){var e=Rw(i,"string");return Ii(e)=="symbol"?e:e+""}o(wm,"_toPropertyKey");function Rw(i,e){if(Ii(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Ii(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(Rw,"_toPrimitive");var Dl="tus-v1",Zo="ietf-draft-03",Ow={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:_m,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:Dl},xm=function(){function i(e,t){Tw(this,i),"resume"in t&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=t,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return o(i,"BaseUpload"),Aw(i,[{key:"findPreviousUploads",value:o(function(){var t=this;return this.options.fingerprint(this.file,this.options).then(function(r){return t._urlStorage.findUploadsByFingerprint(r)})},"findPreviousUploads")},{key:"resumeFromPreviousUpload",value:o(function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey},"resumeFromPreviousUpload")},{key:"start",value:o(function(){var t=this,r=this.file;if(!r){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![Dl,Zo].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var s=this.options.retryDelays;if(s!=null&&Object.prototype.toString.call(s)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var n=0,a=["uploadUrl","uploadSize","uploadLengthDeferred"];n<a.length;n++){var u=a[n];if(this.options[u]){this._emitError(new Error("tus: cannot use the ".concat(u," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(r,this.options).then(function(c){return c==null?di("No fingerprint was calculated meaning that the upload cannot be stored in the URL storage."):di("Calculated fingerprint: ".concat(c)),t._fingerprint=c,t._source?t._source:t.options.fileReader.openFile(r,t.options.chunkSize)}).then(function(c){if(t._source=c,t.options.uploadLengthDeferred)t._size=null;else if(t.options.uploadSize!=null){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size)){t._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(t._size=t._source.size,t._size==null){t._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}t.options.parallelUploads>1||t._parallelUploadUrls!=null?t._startParallelUpload():t._startSingleUpload()}).catch(function(c){t._emitError(c)})},"start")},{key:"_startParallelUpload",value:o(function(){var t,r=this,s=this._size,n=0;this._parallelUploads=[];var a=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,u=(t=this.options.parallelUploadBoundaries)!==null&&t!==void 0?t:Dw(this._source.size,a);this._parallelUploadUrls&&u.forEach(function(g,h){g.uploadUrl=r._parallelUploadUrls[h]||null}),this._parallelUploadUrls=new Array(u.length);var c=u.map(function(g,h){var b=0;return r._source.slice(g.start,g.end).then(function(P){var F=P.value;return new Promise(function(M,C){var O=vr(vr({},r.options),{},{uploadUrl:g.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:r.options.metadataForPartialUploads,headers:vr(vr({},r.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:M,onError:C,onProgress:o(function(J){n=n-b+J,b=J,r._emitProgress(n,s)},"onProgress"),onUploadUrlAvailable:o(function(){r._parallelUploadUrls[h]=U.url,r._parallelUploadUrls.filter(function(J){return!!J}).length===u.length&&r._saveUploadInUrlStorage()},"onUploadUrlAvailable")}),U=new i(F,O);U.start(),r._parallelUploads.push(U)})})}),p;Promise.all(c).then(function(){p=r._openRequest("POST",r.options.endpoint),p.setHeader("Upload-Concat","final;".concat(r._parallelUploadUrls.join(" ")));var g=hm(r.options.metadata);return g!==""&&p.setHeader("Upload-Metadata",g),r._sendRequest(p,null)}).then(function(g){if(!br(g.getStatus(),200)){r._emitHttpError(p,g,"tus: unexpected response while creating upload");return}var h=g.getHeader("Location");if(h==null){r._emitHttpError(p,g,"tus: invalid or missing Location header");return}r.url=ym(r.options.endpoint,h),di("Created upload at ".concat(r.url)),r._emitSuccess(g)}).catch(function(g){r._emitError(g)})},"_startParallelUpload")},{key:"_startSingleUpload",value:o(function(){if(this._aborted=!1,this.url!=null){di("Resuming upload from previous URL: ".concat(this.url)),this._resumeUpload();return}if(this.options.uploadUrl!=null){di("Resuming upload from provided URL: ".concat(this.options.uploadUrl)),this.url=this.options.uploadUrl,this._resumeUpload();return}di("Creating a new upload"),this._createUpload()},"_startSingleUpload")},{key:"abort",value:o(function(t){var r=this;if(this._parallelUploads!=null){var s=Fw(this._parallelUploads),n;try{for(s.s();!(n=s.n()).done;){var a=n.value;a.abort(t)}}catch(u){s.e(u)}finally{s.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!t||this.url==null?Promise.resolve():i.terminate(this.url,this.options).then(function(){return r._removeFromUrlStorage()})},"abort")},{key:"_emitHttpError",value:o(function(t,r,s,n){this._emitError(new mr(s,n,t,r))},"_emitHttpError")},{key:"_emitError",value:o(function(t){var r=this;if(!this._aborted){if(this.options.retryDelays!=null){var s=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(s&&(this._retryAttempt=0),gm(t,this._retryAttempt,this.options)){var n=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){r.start()},n);return}}if(typeof this.options.onError=="function")this.options.onError(t);else throw t}},"_emitError")},{key:"_emitSuccess",value:o(function(t){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:t})},"_emitSuccess")},{key:"_emitProgress",value:o(function(t,r){typeof this.options.onProgress=="function"&&this.options.onProgress(t,r)},"_emitProgress")},{key:"_emitChunkComplete",value:o(function(t,r,s){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(t,r,s)},"_emitChunkComplete")},{key:"_createUpload",value:o(function(){var t=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var r=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?r.setHeader("Upload-Defer-Length","1"):r.setHeader("Upload-Length","".concat(this._size));var s=hm(this.options.metadata);s!==""&&r.setHeader("Upload-Metadata",s);var n;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,n=this._addChunkToRequest(r)):(this.options.protocol===Zo&&r.setHeader("Upload-Complete","?0"),n=this._sendRequest(r,null)),n.then(function(a){if(!br(a.getStatus(),200)){t._emitHttpError(r,a,"tus: unexpected response while creating upload");return}var u=a.getHeader("Location");if(u==null){t._emitHttpError(r,a,"tus: invalid or missing Location header");return}if(t.url=ym(t.options.endpoint,u),di("Created upload at ".concat(t.url)),typeof t.options.onUploadUrlAvailable=="function"&&t.options.onUploadUrlAvailable(),t._size===0){t._emitSuccess(a),t._source.close();return}t._saveUploadInUrlStorage().then(function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(r,a):(t._offset=0,t._performUpload())})}).catch(function(a){t._emitHttpError(r,null,"tus: failed to create upload",a)})},"_createUpload")},{key:"_resumeUpload",value:o(function(){var t=this,r=this._openRequest("HEAD",this.url),s=this._sendRequest(r,null);s.then(function(n){var a=n.getStatus();if(!br(a,200)){if(a===423){t._emitHttpError(r,n,"tus: upload is currently locked; retry later");return}if(br(a,400)&&t._removeFromUrlStorage(),!t.options.endpoint){t._emitHttpError(r,n,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}t.url=null,t._createUpload();return}var u=Number.parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(u)){t._emitHttpError(r,n,"tus: invalid or missing offset value");return}var c=Number.parseInt(n.getHeader("Upload-Length"),10);if(Number.isNaN(c)&&!t.options.uploadLengthDeferred&&t.options.protocol===Dl){t._emitHttpError(r,n,"tus: invalid or missing length value");return}typeof t.options.onUploadUrlAvailable=="function"&&t.options.onUploadUrlAvailable(),t._saveUploadInUrlStorage().then(function(){if(u===c){t._emitProgress(c,c),t._emitSuccess(n);return}t._offset=u,t._performUpload()})}).catch(function(n){t._emitHttpError(r,null,"tus: failed to resume upload",n)})},"_resumeUpload")},{key:"_performUpload",value:o(function(){var t=this;if(!this._aborted){var r;this.options.overridePatchMethod?(r=this._openRequest("POST",this.url),r.setHeader("X-HTTP-Method-Override","PATCH")):r=this._openRequest("PATCH",this.url),r.setHeader("Upload-Offset","".concat(this._offset));var s=this._addChunkToRequest(r);s.then(function(n){if(!br(n.getStatus(),200)){t._emitHttpError(r,n,"tus: unexpected response while uploading chunk");return}t._handleUploadResponse(r,n)}).catch(function(n){t._aborted||t._emitHttpError(r,null,"tus: failed to upload chunk at offset ".concat(t._offset),n)})}},"_performUpload")},{key:"_addChunkToRequest",value:o(function(t){var r=this,s=this._offset,n=this._offset+this.options.chunkSize;return t.setProgressHandler(function(a){r._emitProgress(s+a,r._size)}),t.setHeader("Content-Type","application/offset+octet-stream"),(n===Number.POSITIVE_INFINITY||n>this._size)&&!this.options.uploadLengthDeferred&&(n=this._size),this._source.slice(s,n).then(function(a){var u=a.value,c=a.done,p=u!=null&&u.size?u.size:0;r.options.uploadLengthDeferred&&c&&(r._size=r._offset+p,t.setHeader("Upload-Length","".concat(r._size)));var g=r._offset+p;return!r.options.uploadLengthDeferred&&c&&g!==r._size?Promise.reject(new Error("upload was configured with a size of ".concat(r._size," bytes, but the source is done after ").concat(g," bytes"))):u===null?r._sendRequest(t):(r.options.protocol===Zo&&t.setHeader("Upload-Complete",c?"?1":"?0"),r._emitProgress(r._offset,r._size),r._sendRequest(t,u))})},"_addChunkToRequest")},{key:"_handleUploadResponse",value:o(function(t,r){var s=Number.parseInt(r.getHeader("Upload-Offset"),10);if(Number.isNaN(s)){this._emitHttpError(t,r,"tus: invalid or missing offset value");return}if(this._emitProgress(s,this._size),this._emitChunkComplete(s-this._offset,s,this._size),this._offset=s,s===this._size){this._emitSuccess(r),this._source.close();return}this._performUpload()},"_handleUploadResponse")},{key:"_openRequest",value:o(function(t,r){var s=fm(t,r,this.options);return this._req=s,s},"_openRequest")},{key:"_removeFromUrlStorage",value:o(function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(r){t._emitError(r)}),this._urlStorageKey=null)},"_removeFromUrlStorage")},{key:"_saveUploadInUrlStorage",value:o(function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var r={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?r.parallelUploadUrls=this._parallelUploadUrls:r.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,r).then(function(s){t._urlStorageKey=s})},"_saveUploadInUrlStorage")},{key:"_sendRequest",value:o(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return mm(t,r,this.options)},"_sendRequest")}],[{key:"terminate",value:o(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=fm("DELETE",t,r);return mm(s,null,r).then(function(n){if(n.getStatus()!==204)throw new mr("tus: unexpected response while terminating upload",null,s,n)}).catch(function(n){if(n instanceof mr||(n=new mr("tus: failed to terminate upload",n,s,null)),!gm(n,0,r))throw n;var a=r.retryDelays[0],u=r.retryDelays.slice(1),c=vr(vr({},r),{},{retryDelays:u});return new Promise(function(p){return setTimeout(p,a)}).then(function(){return i.terminate(t,c)})})},"terminate")}])}();function hm(i){return Object.entries(i).map(function(e){var t=vm(e,2),r=t[0],s=t[1];return"".concat(r," ").concat(Xf.encode(String(s)))}).join(",")}o(hm,"encodeMetadata");function br(i,e){return i>=e&&i<e+100}o(br,"inStatusCategory");function fm(i,e,t){var r=t.httpStack.createRequest(i,e);t.protocol===Zo?r.setHeader("Upload-Draft-Interop-Version","5"):r.setHeader("Tus-Resumable","1.0.0");for(var s=t.headers||{},n=0,a=Object.entries(s);n<a.length;n++){var u=vm(a[n],2),c=u[0],p=u[1];r.setHeader(c,p)}if(t.addRequestId){var g=Ol();r.setHeader("X-Request-ID",g)}return r}o(fm,"openRequest");function mm(i,e,t){return Il.apply(this,arguments)}o(mm,"sendRequest");function Il(){return Il=_w(Ul().mark(o(function i(e,t,r){var s;return Ul().wrap(o(function(a){for(;;)switch(a.prev=a.next){case 0:if(typeof r.onBeforeRequest!="function"){a.next=3;break}return a.next=3,r.onBeforeRequest(e);case 3:return a.next=5,e.send(t);case 5:if(s=a.sent,typeof r.onAfterResponse!="function"){a.next=9;break}return a.next=9,r.onAfterResponse(e,s);case 9:return a.abrupt("return",s);case 10:case"end":return a.stop()}},"_callee$"),i)},"_callee"))),Il.apply(this,arguments)}o(Il,"_sendRequest2");function Uw(){var i=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(i=!1),i}o(Uw,"isOnline");function gm(i,e,t){return t.retryDelays==null||e>=t.retryDelays.length||i.originalRequest==null?!1:t&&typeof t.onShouldRetry=="function"?t.onShouldRetry(i,e,t):_m(i)}o(gm,"shouldRetry");function _m(i){var e=i.originalResponse?i.originalResponse.getStatus():0;return(!br(e,400)||e===409||e===423)&&Uw()}o(_m,"defaultOnShouldRetry");function ym(i,e){return new Sm.default(e,i).toString()}o(ym,"resolveUrl");function Dw(i,e){for(var t=Math.floor(i/e),r=[],s=0;s<e;s++)r.push({start:t*s,end:t*(s+1)});return r[e-1].end=i,r}o(Dw,"splitSizeIntoParts");xm.defaultOptions=Ow;var en=xm;var Iw=o(function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"},"isReactNative"),tn=Iw;function Nl(i){return new Promise(function(e,t){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var s=r.response;e(s)},r.onerror=function(s){t(s)},r.open("GET",i),r.send()})}o(Nl,"uriToBlob");var Nw=o(function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")},"isCordova"),Pm=Nw;function Ml(i){return new Promise(function(e,t){var r=new FileReader;r.onload=function(){var s=new Uint8Array(r.result);e({value:s})},r.onerror=function(s){t(s)},r.readAsArrayBuffer(i)})}o(Ml,"readAsByteArray");function Us(i){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Us(i)}o(Us,"_typeof");function Mw(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(Mw,"_classCallCheck");function km(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,Bw(r.key),r)}}o(km,"_defineProperties");function Lw(i,e,t){return e&&km(i.prototype,e),t&&km(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(Lw,"_createClass");function Bw(i){var e=jw(i,"string");return Us(e)=="symbol"?e:e+""}o(Bw,"_toPropertyKey");function jw(i,e){if(Us(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Us(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(jw,"_toPrimitive");var Ll=function(){function i(e){Mw(this,i),this._file=e,this.size=e.size}return o(i,"FileSource"),Lw(i,[{key:"slice",value:o(function(t,r){if(Pm())return Ml(this._file.slice(t,r));var s=this._file.slice(t,r),n=r>=this.size;return Promise.resolve({value:s,done:n})},"slice")},{key:"close",value:o(function(){},"close")}])}();function Ds(i){"@babel/helpers - typeof";return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ds(i)}o(Ds,"_typeof");function zw(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(zw,"_classCallCheck");function Em(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,qw(r.key),r)}}o(Em,"_defineProperties");function Hw(i,e,t){return e&&Em(i.prototype,e),t&&Em(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(Hw,"_createClass");function qw(i){var e=Vw(i,"string");return Ds(e)=="symbol"?e:e+""}o(qw,"_toPropertyKey");function Vw(i,e){if(Ds(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Ds(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(Vw,"_toPrimitive");function Fm(i){return i===void 0?0:i.size!==void 0?i.size:i.length}o(Fm,"len");function $w(i,e){if(i.concat)return i.concat(e);if(i instanceof Blob)return new Blob([i,e],{type:i.type});if(i.set){var t=new i.constructor(i.length+e.length);return t.set(i),t.set(e,i.length),t}throw new Error("Unknown data type")}o($w,"concat");var Cm=function(){function i(e){zw(this,i),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return o(i,"StreamSource"),Hw(i,[{key:"slice",value:o(function(t,r){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,r)},"slice")},{key:"_readUntilEnoughDataOrDone",value:o(function(t,r){var s=this,n=r<=this._bufferOffset+Fm(this._buffer);if(this._done||n){var a=this._getDataFromBuffer(t,r),u=a==null?this._done:!1;return Promise.resolve({value:a,done:u})}return this._reader.read().then(function(c){var p=c.value,g=c.done;return g?s._done=!0:s._buffer===void 0?s._buffer=p:s._buffer=$w(s._buffer,p),s._readUntilEnoughDataOrDone(t,r)})},"_readUntilEnoughDataOrDone")},{key:"_getDataFromBuffer",value:o(function(t,r){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var s=Fm(this._buffer)===0;return this._done&&s?null:this._buffer.slice(0,r-t)},"_getDataFromBuffer")},{key:"close",value:o(function(){this._reader.cancel&&this._reader.cancel()},"close")}])}();function Ni(i){"@babel/helpers - typeof";return Ni=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ni(i)}o(Ni,"_typeof");function Bl(){"use strict";Bl=o(function(){return e},"_regeneratorRuntime");var i,e={},t=Object.prototype,r=t.hasOwnProperty,s=Object.defineProperty||function(k,w,S){k[w]=S.value},n=typeof Symbol=="function"?Symbol:{},a=n.iterator||"@@iterator",u=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function p(k,w,S){return Object.defineProperty(k,w,{value:S,enumerable:!0,configurable:!0,writable:!0}),k[w]}o(p,"define");try{p({},"")}catch{p=o(function(S,B,q){return S[B]=q},"define")}function g(k,w,S,B){var q=w&&w.prototype instanceof O?w:O,z=Object.create(q.prototype),D=new Te(B||[]);return s(z,"_invoke",{value:be(k,S,D)}),z}o(g,"wrap");function h(k,w,S){try{return{type:"normal",arg:k.call(w,S)}}catch(B){return{type:"throw",arg:B}}}o(h,"tryCatch"),e.wrap=g;var b="suspendedStart",P="suspendedYield",F="executing",M="completed",C={};function O(){}o(O,"Generator");function U(){}o(U,"GeneratorFunction");function A(){}o(A,"GeneratorFunctionPrototype");var J={};p(J,a,function(){return this});var G=Object.getPrototypeOf,W=G&&G(G(Se([])));W&&W!==t&&r.call(W,a)&&(J=W);var K=A.prototype=O.prototype=Object.create(J);function te(k){["next","throw","return"].forEach(function(w){p(k,w,function(S){return this._invoke(w,S)})})}o(te,"defineIteratorMethods");function Q(k,w){function S(q,z,D,E){var T=h(k[q],k,z);if(T.type!=="throw"){var L=T.arg,X=L.value;return X&&Ni(X)=="object"&&r.call(X,"__await")?w.resolve(X.__await).then(function(Y){S("next",Y,D,E)},function(Y){S("throw",Y,D,E)}):w.resolve(X).then(function(Y){L.value=Y,D(L)},function(Y){return S("throw",Y,D,E)})}E(T.arg)}o(S,"invoke");var B;s(this,"_invoke",{value:o(function(z,D){function E(){return new w(function(T,L){S(z,D,T,L)})}return o(E,"callInvokeWithMethodAndArg"),B=B?B.then(E,E):E()},"value")})}o(Q,"AsyncIterator");function be(k,w,S){var B=b;return function(q,z){if(B===F)throw Error("Generator is already running");if(B===M){if(q==="throw")throw z;return{value:i,done:!0}}for(S.method=q,S.arg=z;;){var D=S.delegate;if(D){var E=ne(D,S);if(E){if(E===C)continue;return E}}if(S.method==="next")S.sent=S._sent=S.arg;else if(S.method==="throw"){if(B===b)throw B=M,S.arg;S.dispatchException(S.arg)}else S.method==="return"&&S.abrupt("return",S.arg);B=F;var T=h(k,w,S);if(T.type==="normal"){if(B=S.done?M:P,T.arg===C)continue;return{value:T.arg,done:S.done}}T.type==="throw"&&(B=M,S.method="throw",S.arg=T.arg)}}}o(be,"makeInvokeMethod");function ne(k,w){var S=w.method,B=k.iterator[S];if(B===i)return w.delegate=null,S==="throw"&&k.iterator.return&&(w.method="return",w.arg=i,ne(k,w),w.method==="throw")||S!=="return"&&(w.method="throw",w.arg=new TypeError("The iterator does not provide a '"+S+"' method")),C;var q=h(B,k.iterator,w.arg);if(q.type==="throw")return w.method="throw",w.arg=q.arg,w.delegate=null,C;var z=q.arg;return z?z.done?(w[k.resultName]=z.value,w.next=k.nextLoc,w.method!=="return"&&(w.method="next",w.arg=i),w.delegate=null,C):z:(w.method="throw",w.arg=new TypeError("iterator result is not an object"),w.delegate=null,C)}o(ne,"maybeInvokeDelegate");function Pe(k){var w={tryLoc:k[0]};1 in k&&(w.catchLoc=k[1]),2 in k&&(w.finallyLoc=k[2],w.afterLoc=k[3]),this.tryEntries.push(w)}o(Pe,"pushTryEntry");function ye(k){var w=k.completion||{};w.type="normal",delete w.arg,k.completion=w}o(ye,"resetTryEntry");function Te(k){this.tryEntries=[{tryLoc:"root"}],k.forEach(Pe,this),this.reset(!0)}o(Te,"Context");function Se(k){if(k||k===""){var w=k[a];if(w)return w.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var S=-1,B=o(function q(){for(;++S<k.length;)if(r.call(k,S))return q.value=k[S],q.done=!1,q;return q.value=i,q.done=!0,q},"next");return B.next=B}}throw new TypeError(Ni(k)+" is not iterable")}return o(Se,"values"),U.prototype=A,s(K,"constructor",{value:A,configurable:!0}),s(A,"constructor",{value:U,configurable:!0}),U.displayName=p(A,c,"GeneratorFunction"),e.isGeneratorFunction=function(k){var w=typeof k=="function"&&k.constructor;return!!w&&(w===U||(w.displayName||w.name)==="GeneratorFunction")},e.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,A):(k.__proto__=A,p(k,c,"GeneratorFunction")),k.prototype=Object.create(K),k},e.awrap=function(k){return{__await:k}},te(Q.prototype),p(Q.prototype,u,function(){return this}),e.AsyncIterator=Q,e.async=function(k,w,S,B,q){q===void 0&&(q=Promise);var z=new Q(g(k,w,S,B),q);return e.isGeneratorFunction(w)?z:z.next().then(function(D){return D.done?D.value:z.next()})},te(K),p(K,c,"Generator"),p(K,a,function(){return this}),p(K,"toString",function(){return"[object Generator]"}),e.keys=function(k){var w=Object(k),S=[];for(var B in w)S.push(B);return S.reverse(),o(function q(){for(;S.length;){var z=S.pop();if(z in w)return q.value=z,q.done=!1,q}return q.done=!0,q},"next")},e.values=Se,Te.prototype={constructor:Te,reset:o(function(w){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(ye),!w)for(var S in this)S.charAt(0)==="t"&&r.call(this,S)&&!isNaN(+S.slice(1))&&(this[S]=i)},"reset"),stop:o(function(){this.done=!0;var w=this.tryEntries[0].completion;if(w.type==="throw")throw w.arg;return this.rval},"stop"),dispatchException:o(function(w){if(this.done)throw w;var S=this;function B(L,X){return D.type="throw",D.arg=w,S.next=L,X&&(S.method="next",S.arg=i),!!X}o(B,"handle");for(var q=this.tryEntries.length-1;q>=0;--q){var z=this.tryEntries[q],D=z.completion;if(z.tryLoc==="root")return B("end");if(z.tryLoc<=this.prev){var E=r.call(z,"catchLoc"),T=r.call(z,"finallyLoc");if(E&&T){if(this.prev<z.catchLoc)return B(z.catchLoc,!0);if(this.prev<z.finallyLoc)return B(z.finallyLoc)}else if(E){if(this.prev<z.catchLoc)return B(z.catchLoc,!0)}else{if(!T)throw Error("try statement without catch or finally");if(this.prev<z.finallyLoc)return B(z.finallyLoc)}}}},"dispatchException"),abrupt:o(function(w,S){for(var B=this.tryEntries.length-1;B>=0;--B){var q=this.tryEntries[B];if(q.tryLoc<=this.prev&&r.call(q,"finallyLoc")&&this.prev<q.finallyLoc){var z=q;break}}z&&(w==="break"||w==="continue")&&z.tryLoc<=S&&S<=z.finallyLoc&&(z=null);var D=z?z.completion:{};return D.type=w,D.arg=S,z?(this.method="next",this.next=z.finallyLoc,C):this.complete(D)},"abrupt"),complete:o(function(w,S){if(w.type==="throw")throw w.arg;return w.type==="break"||w.type==="continue"?this.next=w.arg:w.type==="return"?(this.rval=this.arg=w.arg,this.method="return",this.next="end"):w.type==="normal"&&S&&(this.next=S),C},"complete"),finish:o(function(w){for(var S=this.tryEntries.length-1;S>=0;--S){var B=this.tryEntries[S];if(B.finallyLoc===w)return this.complete(B.completion,B.afterLoc),ye(B),C}},"finish"),catch:o(function(w){for(var S=this.tryEntries.length-1;S>=0;--S){var B=this.tryEntries[S];if(B.tryLoc===w){var q=B.completion;if(q.type==="throw"){var z=q.arg;ye(B)}return z}}throw Error("illegal catch attempt")},"_catch"),delegateYield:o(function(w,S,B){return this.delegate={iterator:Se(w),resultName:S,nextLoc:B},this.method==="next"&&(this.arg=i),C},"delegateYield")},e}o(Bl,"_regeneratorRuntime");function Tm(i,e,t,r,s,n,a){try{var u=i[n](a),c=u.value}catch(p){t(p);return}u.done?e(c):Promise.resolve(c).then(r,s)}o(Tm,"asyncGeneratorStep");function Ww(i){return function(){var e=this,t=arguments;return new Promise(function(r,s){var n=i.apply(e,t);function a(c){Tm(n,r,s,a,u,"next",c)}o(a,"_next");function u(c){Tm(n,r,s,a,u,"throw",c)}o(u,"_throw"),a(void 0)})}}o(Ww,"_asyncToGenerator");function Gw(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(Gw,"_classCallCheck");function Am(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,Xw(r.key),r)}}o(Am,"_defineProperties");function Kw(i,e,t){return e&&Am(i.prototype,e),t&&Am(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(Kw,"_createClass");function Xw(i){var e=Yw(i,"string");return Ni(e)=="symbol"?e:e+""}o(Xw,"_toPropertyKey");function Yw(i,e){if(Ni(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Ni(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(Yw,"_toPrimitive");var Rm=function(){function i(){Gw(this,i)}return o(i,"FileReader"),Kw(i,[{key:"openFile",value:function(){var e=Ww(Bl().mark(o(function r(s,n){var a;return Bl().wrap(o(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(tn()&&s&&typeof s.uri<"u")){c.next=11;break}return c.prev=1,c.next=4,Nl(s.uri);case 4:return a=c.sent,c.abrupt("return",new Ll(a));case 8:throw c.prev=8,c.t0=c.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(c.t0));case 11:if(!(typeof s.slice=="function"&&typeof s.size<"u")){c.next=13;break}return c.abrupt("return",Promise.resolve(new Ll(s)));case 13:if(typeof s.read!="function"){c.next=18;break}if(n=Number(n),Number.isFinite(n)){c.next=17;break}return c.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return c.abrupt("return",Promise.resolve(new Cm(s,n)));case 18:return c.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return c.stop()}},"_callee$"),r,null,[[1,8]])},"_callee")));function t(r,s){return e.apply(this,arguments)}return o(t,"openFile"),t}()}])}();function jl(i,e){return tn()?Promise.resolve(Jw(i,e)):Promise.resolve(["tus-br",i.name,i.type,i.size,i.lastModified,e.endpoint].join("-"))}o(jl,"fingerprint");function Jw(i,e){var t=i.exif?Qw(JSON.stringify(i.exif)):"noexif";return["tus-rn",i.name||"noname",i.size||"nosize",t,e.endpoint].join("/")}o(Jw,"reactNativeFingerprint");function Qw(i){var e=0;if(i.length===0)return e;for(var t=0;t<i.length;t++){var r=i.charCodeAt(t);e=(e<<5)-e+r,e&=e}return e}o(Qw,"hashCode");function Is(i){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Is(i)}o(Is,"_typeof");function zl(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(zl,"_classCallCheck");function Om(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,Zw(r.key),r)}}o(Om,"_defineProperties");function Hl(i,e,t){return e&&Om(i.prototype,e),t&&Om(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(Hl,"_createClass");function Zw(i){var e=e2(i,"string");return Is(e)=="symbol"?e:e+""}o(Zw,"_toPropertyKey");function e2(i,e){if(Is(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Is(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(e2,"_toPrimitive");var Um=function(){function i(){zl(this,i)}return o(i,"XHRHttpStack"),Hl(i,[{key:"createRequest",value:o(function(t,r){return new t2(t,r)},"createRequest")},{key:"getName",value:o(function(){return"XHRHttpStack"},"getName")}])}();var t2=function(){function i(e,t){zl(this,i),this._xhr=new XMLHttpRequest,this._xhr.open(e,t,!0),this._method=e,this._url=t,this._headers={}}return o(i,"Request"),Hl(i,[{key:"getMethod",value:o(function(){return this._method},"getMethod")},{key:"getURL",value:o(function(){return this._url},"getURL")},{key:"setHeader",value:o(function(t,r){this._xhr.setRequestHeader(t,r),this._headers[t]=r},"setHeader")},{key:"getHeader",value:o(function(t){return this._headers[t]},"getHeader")},{key:"setProgressHandler",value:o(function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(r){r.lengthComputable&&t(r.loaded)})},"setProgressHandler")},{key:"send",value:o(function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(s,n){t._xhr.onload=function(){s(new i2(t._xhr))},t._xhr.onerror=function(a){n(a)},t._xhr.send(r)})},"send")},{key:"abort",value:o(function(){return this._xhr.abort(),Promise.resolve()},"abort")},{key:"getUnderlyingObject",value:o(function(){return this._xhr},"getUnderlyingObject")}])}(),i2=function(){function i(e){zl(this,i),this._xhr=e}return o(i,"Response"),Hl(i,[{key:"getStatus",value:o(function(){return this._xhr.status},"getStatus")},{key:"getHeader",value:o(function(t){return this._xhr.getResponseHeader(t)},"getHeader")},{key:"getBody",value:o(function(){return this._xhr.responseText},"getBody")},{key:"getUnderlyingObject",value:o(function(){return this._xhr},"getUnderlyingObject")}])}();function Ns(i){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ns(i)}o(Ns,"_typeof");function r2(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(r2,"_classCallCheck");function Dm(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,o2(r.key),r)}}o(Dm,"_defineProperties");function s2(i,e,t){return e&&Dm(i.prototype,e),t&&Dm(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(s2,"_createClass");function o2(i){var e=n2(i,"string");return Ns(e)=="symbol"?e:e+""}o(o2,"_toPropertyKey");function n2(i,e){if(Ns(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Ns(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(n2,"_toPrimitive");var Vl=!1;try{Vl="localStorage"in window,rn="tusSupport",ql=localStorage.getItem(rn),localStorage.setItem(rn,ql),ql===null&&localStorage.removeItem(rn)}catch(i){if(i.code===i.SECURITY_ERR||i.code===i.QUOTA_EXCEEDED_ERR)Vl=!1;else throw i}var rn,ql,Im=Vl,Nm=function(){function i(){r2(this,i)}return o(i,"WebStorageUrlStorage"),s2(i,[{key:"findAllUploads",value:o(function(){var t=this._findEntries("tus::");return Promise.resolve(t)},"findAllUploads")},{key:"findUploadsByFingerprint",value:o(function(t){var r=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(r)},"findUploadsByFingerprint")},{key:"removeUpload",value:o(function(t){return localStorage.removeItem(t),Promise.resolve()},"removeUpload")},{key:"addUpload",value:o(function(t,r){var s=Math.round(Math.random()*1e12),n="tus::".concat(t,"::").concat(s);return localStorage.setItem(n,JSON.stringify(r)),Promise.resolve(n)},"addUpload")},{key:"_findEntries",value:o(function(t){for(var r=[],s=0;s<localStorage.length;s++){var n=localStorage.key(s);if(n.indexOf(t)===0)try{var a=JSON.parse(localStorage.getItem(n));a.urlStorageKey=n,r.push(a)}catch{}}return r},"_findEntries")}])}();function Sr(i){"@babel/helpers - typeof";return Sr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sr(i)}o(Sr,"_typeof");function a2(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}o(a2,"_classCallCheck");function Mm(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,jm(r.key),r)}}o(Mm,"_defineProperties");function l2(i,e,t){return e&&Mm(i.prototype,e),t&&Mm(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}o(l2,"_createClass");function u2(i,e,t){return e=sn(e),c2(i,Bm()?Reflect.construct(e,t||[],sn(i).constructor):e.apply(i,t))}o(u2,"_callSuper");function c2(i,e){if(e&&(Sr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p2(i)}o(c2,"_possibleConstructorReturn");function p2(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}o(p2,"_assertThisInitialized");function Bm(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bm=o(function(){return!!i},"_isNativeReflectConstruct"))()}o(Bm,"_isNativeReflectConstruct");function sn(i){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():o(function(t){return t.__proto__||Object.getPrototypeOf(t)},"_getPrototypeOf"),sn(i)}o(sn,"_getPrototypeOf");function d2(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&$l(i,e)}o(d2,"_inherits");function $l(i,e){return $l=Object.setPrototypeOf?Object.setPrototypeOf.bind():o(function(r,s){return r.__proto__=s,r},"_setPrototypeOf"),$l(i,e)}o($l,"_setPrototypeOf");function Lm(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,r)}return t}o(Lm,"ownKeys");function wr(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Lm(Object(t),!0).forEach(function(r){h2(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Lm(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}o(wr,"_objectSpread");function h2(i,e,t){return e=jm(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}o(h2,"_defineProperty");function jm(i){var e=f2(i,"string");return Sr(e)=="symbol"?e:e+""}o(jm,"_toPropertyKey");function f2(i,e){if(Sr(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Sr(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}o(f2,"_toPrimitive");var on=wr(wr({},en.defaultOptions),{},{httpStack:new Um,fileReader:new Rm,urlStorage:Im?new Nm:new Af,fingerprint:jl}),zm=function(i){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return a2(this,e),r=wr(wr({},on),r),u2(this,e,[t,r])}return o(e,"Upload"),d2(e,i),l2(e,null,[{key:"terminate",value:o(function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return s=wr(wr({},on),s),en.terminate(r,s)},"terminate")}])}(en),o7=typeof XMLHttpRequest=="function"&&typeof Blob=="function"&&typeof Blob.prototype.slice=="function";var qm={name:"@uppy/tus",description:"Resumable uploads for Uppy using Tus.io",version:"4.3.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","upload","resumable","tus"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/utils":"workspace:^","tus-js-client":"^4.2.3"},devDependencies:{"@uppy/core":"workspace:^",jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"workspace:^"}};function g2(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")}o(g2,"isCordova");function y2(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"}o(y2,"isReactNative");function Wl(i){return(e,t)=>{if(g2()||y2())return on.fingerprint(e,t);let r=["tus",i.id,t.endpoint].join("-");return Promise.resolve(r)}}o(Wl,"getFingerprint");var Vm={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},v2={limit:20,retryDelays:Vm.retryDelays,withCredentials:!1,allowedMetaFields:!0},hi=class extends we{static{o(this,"Tus")}static VERSION=qm.version;#e;requests;uploaders;uploaderEvents;constructor(e,t){if(super(e,{...v2,...t}),this.type="uploader",this.id=this.opts.id||"Tus",t?.allowedMetaFields===void 0&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in t)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=this.opts.rateLimitedQueue??new xt(this.opts.limit),this.#e=this.opts.retryDelays?.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}resetUploaderReferences(e,t){let r=this.uploaders[e];r&&(r.abort(),t?.abort&&r.abort(!0),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}#t(e){return this.resetUploaderReferences(e.id),new Promise((t,r)=>{let s,n,a,u={...this.opts,...e.tus||{}};typeof u.headers=="function"&&(u.headers=u.headers(e));let{onShouldRetry:c,onBeforeRequest:p,...g}=u,h={...Vm,...g};h.fingerprint=Wl(e),h.onBeforeRequest=async O=>{let U=O.getUnderlyingObject();U.withCredentials=!!u.withCredentials;let A;if(typeof p=="function"&&(A=p(O,e)),ft(s,"shouldBeRequeued")){if(!s.shouldBeRequeued)return Promise.reject();let J,G=new Promise(W=>{J=W});s=this.requests.run(()=>(e.isPaused&&s.abort(),J(),()=>{})),await Promise.all([G,A]);return}return A},h.onError=O=>{this.uppy.log(O);let U=O.originalRequest!=null?O.originalRequest.getUnderlyingObject():null;Xo(U)&&(O=new kt(O,U)),this.resetUploaderReferences(e.id),s?.abort(),typeof u.onError=="function"&&u.onError(O),r(O)},h.onProgress=(O,U)=>{this.onReceiveUploadUrl(e,a.url),typeof u.onProgress=="function"&&u.onProgress(O,U);let A=this.uppy.getFile(e.id);this.uppy.emit("upload-progress",A,{uploadStarted:A.progress.uploadStarted??0,bytesUploaded:O,bytesTotal:U})},h.onSuccess=O=>{let U={uploadURL:a.url??void 0,status:200,body:{xhr:O.lastResponse.getUnderlyingObject()}};if(this.uppy.emit("upload-success",this.uppy.getFile(e.id),U),this.resetUploaderReferences(e.id),s.done(),a.url){let{name:A}=a.file;this.uppy.log(`Download ${A} from ${a.url}`)}typeof u.onSuccess=="function"&&u.onSuccess(O),t(a)};let b=o(O=>{let U=O?.originalResponse?.getStatus();if(U===429){if(!this.requests.isPaused){let A=this.#e?.next();if(A==null||A.done)return!1;this.requests.rateLimit(A.value)}}else{if(U!=null&&U>=400&&U<500&&U!==409&&U!==423)return!1;typeof navigator<"u"&&navigator.onLine===!1&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",()=>{this.requests.resume()},{once:!0})))}return s.abort(),s={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0},"defaultOnShouldRetry");c!=null?h.onShouldRetry=(O,U)=>c(O,U,u,b):h.onShouldRetry=b;let P=o((O,U,A)=>{ft(O,U)&&!ft(O,A)&&(O[A]=O[U])},"copyProp"),F={};qt(u.allowedMetaFields,e.meta).forEach(O=>{F[O]=String(e.meta[O])}),P(F,"type","filetype"),P(F,"name","filename"),h.metadata=F,a=new zm(e.data,h),this.uploaders[e.id]=a;let C=new Ht(this.uppy);this.uploaderEvents[e.id]=C,n=o(()=>(e.isPaused||a.start(),()=>{}),"qRequest"),a.findPreviousUploads().then(O=>{let U=O[0];U&&(this.uppy.log(`[Tus] Resuming upload of ${e.id} started at ${U.creationTime}`),a.resumeFromPreviousUpload(U)),s=this.requests.run(n)}),C.onFileRemove(e.id,O=>{s.abort(),this.resetUploaderReferences(e.id,{abort:!!a.url}),t(`upload ${O} was removed`)}),C.onPause(e.id,O=>{s.abort(),O?a.abort():s=this.requests.run(n)}),C.onPauseAll(e.id,()=>{s.abort(),a.abort()}),C.onCancelAll(e.id,()=>{s.abort(),this.resetUploaderReferences(e.id,{abort:!!a.url}),t(`upload ${e.id} was canceled`)}),C.onResumeAll(e.id,()=>{s.abort(),e.error&&a.abort(),s=this.requests.run(n)})}).catch(t=>{throw this.uppy.emit("upload-error",e,t),t})}onReceiveUploadUrl(e,t){let r=this.uppy.getFile(e.id);r&&(!r.tus||r.tus.uploadUrl!==t)&&(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(r.id,{tus:{...r.tus,uploadUrl:t}}))}#r(e){let t={...this.opts};return e.tus&&Object.assign(t,e.tus),typeof t.headers=="function"&&(t.headers=t.headers(e)),{...e.remote?.body,endpoint:t.endpoint,uploadUrl:t.uploadUrl,protocol:"tus",size:e.data.size,headers:t.headers,metadata:e.meta}}async#i(e){let t=Ji(e),r=Qi(t);this.uppy.emit("upload-start",r),await Promise.allSettled(t.map(s=>{if(s.isRemote){let n=o(()=>this.requests,"getQueue"),a=new AbortController,u=o(p=>{p.id===s.id&&a.abort()},"removedHandler");this.uppy.on("file-removed",u);let c=this.uppy.getRequestClientForFile(s).uploadRemoteFile(s,this.#r(s),{signal:a.signal,getQueue:n});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",u)},{priority:-1})(),c}return this.#t(s)}))}#s=o(async e=>{if(e.length===0){this.uppy.log("[Tus] No files to upload");return}this.opts.limit===0&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");let t=this.uppy.getFilesByIds(e);await this.#i(t)},"#handleUpload");install(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!0}}),this.uppy.addUploader(this.#s)}uninstall(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!1}}),this.uppy.removeUploader(this.#s)}};var $m={name:"@uppy/transloadit",description:"The Transloadit plugin can be used to upload files to Transloadit for all kinds of processing, such as transcoding video, resizing images, zipping/unzipping, and more",version:"4.3.3",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","transloadit","file encoding","encoding","file processing","video encoding","crop","resize","watermark","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/provider-views":"workspace:^","@uppy/tus":"workspace:^","@uppy/utils":"workspace:^","component-emitter":"^2.0.0"},peerDependencies:{"@uppy/core":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",jsdom:"^26.1.0",msw:"^2.10.4",typescript:"^5.8.3",vitest:"^3.2.4","whatwg-fetch":"^3.6.2"}};var Gm=de(Kl(),1);var S2="ASSEMBLY_UPLOADING",Xl="ASSEMBLY_EXECUTING",Yl="ASSEMBLY_COMPLETED",Wm=[S2,Xl,Yl];function nn(i,e){return Wm.indexOf(i)>=Wm.indexOf(e)}o(nn,"isStatus");var Jl=class extends Gm.default{static{o(this,"TransloaditAssembly")}#e;#t;#r=!1;#i=null;status;pollInterval;closed;constructor(e,t){super(),this.status=e,this.pollInterval=null,this.closed=!1,this.#e=t,this.#t=t.wrapPromiseFunction(_i)}connect(){this.#a(),this.#l()}#s(){this.emit("finished"),this.close()}#a(){this.#i=new EventSource(`${this.status.websocket_url}?assembly=${this.status.assembly_id}`),this.#i.addEventListener("open",()=>{clearInterval(this.pollInterval),this.pollInterval=null}),this.#i.addEventListener("message",e=>{e.data==="assembly_finished"&&this.#s(),e.data==="assembly_uploading_finished"&&this.emit("executing"),e.data==="assembly_upload_meta_data_extracted"&&(this.emit("metadata"),this.#n({diff:!1}))}),this.#i.addEventListener("assembly_upload_finished",e=>{let t=JSON.parse(e.data);this.status.uploads.push(t),this.emit("upload",t)}),this.#i.addEventListener("assembly_result_finished",e=>{let[t,r]=JSON.parse(e.data);(this.status.results[t]??=[]).push(r),this.emit("result",t,r)}),this.#i.addEventListener("assembly_execution_progress",e=>{let t=JSON.parse(e.data);this.emit("execution-progress",t)}),this.#i.addEventListener("assembly_error",e=>{try{this.#o(JSON.parse(e.data))}catch{this.#o(new Error(e.data))}this.#n({diff:!1})})}#o(e){this.emit("error",Object.assign(new Error(e.message),e)),this.close()}#l(){this.pollInterval=setInterval(()=>{this.#n()},2e3)}async#n({diff:e=!0}={}){if(!(this.closed||this.#e.isPaused||this.#r))try{this.#r=!0;let t=await this.#t(this.status.assembly_ssl_url);if(this.#r=!1,this.closed)return;if(t.status===429){this.#e.rateLimit(2e3);return}if(!t.ok){this.#o(new kt(t.statusText));return}let r=await t.json();if(this.closed)return;this.emit("status",r),e?this.updateStatus(r):this.status=r}catch(t){this.#o(t)}}update(){return this.#n({diff:!0})}updateStatus(e){this.#p(this.status,e),this.status=e}#p(e,t){let r=e.ok,s=t.ok;if(t.error&&!e.error)return this.#o(t);let n=nn(s,Xl)&&!nn(r,Xl);n&&this.emit("executing"),Object.keys(t.uploads).filter(a=>!ft(e.uploads,a)).forEach(a=>{this.emit("upload",t.uploads[a])}),n&&this.emit("metadata"),Object.keys(t.results).forEach(a=>{let u=t.results[a],c=e.results[a];u.filter(p=>!c||!c.some(g=>g.id===p.id)).forEach(p=>{this.emit("result",a,p)})}),nn(s,Yl)&&!nn(r,Yl)&&this.emit("finished")}close(){this.closed=!0,this.#i&&(this.#i.close(),this.#i=null),clearInterval(this.pollInterval),this.pollInterval=null}},Ql=Jl;var Km=de(Kl(),1);var Zl=class extends Km.default{static{o(this,"TransloaditAssemblyWatcher")}#e;#t;promise;#r;#i;#s;constructor(e,t){super(),this.#s=e,this.#e=t,this.#t=t.length,this.promise=new Promise((r,s)=>{this.#r=r,this.#i=s}),this.#u()}#a(e){return this.#e.indexOf(e)!==-1}#o=o(e=>{this.#a(e.assembly_id)&&(this.#s.log(`[Transloadit] AssemblyWatcher: Got Assembly finish ${e.assembly_id}`),this.emit("assembly-complete",e.assembly_id),this.#c())},"#onAssemblyComplete");#l=o(e=>{this.#a(e.assembly_id)&&this.#c()},"#onAssemblyCancel");#n=o((e,t)=>{this.#a(e.assembly_id)&&(this.#s.log(`[Transloadit] AssemblyWatcher: Got Assembly error ${e.assembly_id}`),this.#s.log(t),this.emit("assembly-error",e.assembly_id,t),this.#c())},"#onAssemblyError");#p=o((e,t,r)=>{this.#a(e.assembly_id)&&this.#n(e,r)},"#onImportError");#c(){this.#t-=1,this.#t===0&&(this.#d(),this.#r())}#d(){this.#s.off("transloadit:complete",this.#o),this.#s.off("transloadit:assembly-cancel",this.#l),this.#s.off("transloadit:assembly-error",this.#n),this.#s.off("transloadit:import-error",this.#p)}#u(){this.#s.on("transloadit:complete",this.#o),this.#s.on("transloadit:assembly-cancel",this.#l),this.#s.on("transloadit:assembly-error",this.#n),this.#s.on("transloadit:import-error",this.#p)}},Xm=Zl;var Ym="/assemblies",eu=class extends Error{static{o(this,"AssemblyError")}details;assembly;constructor(e,t,r){super(e),this.details=t,this.assembly=r}},Ms=class{static{o(this,"Client")}#e={};#t;opts;constructor(e){this.opts=e,this.opts.client!=null&&(this.#e["Transloadit-Client"]=this.opts.client),this.#t=this.opts.rateLimitedQueue.wrapPromiseFunction(_i)}async#r(...e){let t=await this.#t(...e);if(t.status===429)return this.opts.rateLimitedQueue.rateLimit(2e3),this.#r(...e);if(!t.ok){let r=new Error(t.statusText);return r.statusCode=t.status,`${e[0]}`.endsWith(Ym)?t.json().then(s=>{if(!s.error)throw r;let n=new eu(s.error,s.message,s);throw s.assembly_id&&(n.details+=` Assembly ID: ${s.assembly_id}`),n},s=>{throw s.cause=r,s}):Promise.reject(r)}return t.json()}async createAssembly({params:e,fields:t,signature:r,expectedFiles:s}){let n=new FormData;n.append("params",typeof e=="string"?e:JSON.stringify(e)),r&&n.append("signature",r),Object.keys(t).forEach(u=>{n.append(u,String(t[u]))}),n.append("num_expected_upload_files",String(s));let a=new URL(Ym,`${this.opts.service}`).href;return this.#r(a,{method:"POST",headers:this.#e,body:n}).catch(u=>this.#i(u,{url:a,type:"API_ERROR"}))}async reserveFile(e,t){let r=encodeURIComponent(t.size),s=`${e.assembly_ssl_url}/reserve_file?size=${r}`;return this.#r(s,{method:"POST",headers:this.#e}).catch(n=>this.#i(n,{assembly:e,file:t,url:s,type:"API_ERROR"}))}async addFile(e,t){if(!t.uploadURL)return Promise.reject(new Error("File does not have an `uploadURL`."));let r=encodeURIComponent(t.size),s=encodeURIComponent(t.uploadURL),n=encodeURIComponent(t.name??"Unnamed"),u=`size=${r}&filename=${n}&fieldname=file&s3Url=${s}`,c=`${e.assembly_ssl_url}/add_file?${u}`;return this.#r(c,{method:"POST",headers:this.#e}).catch(p=>this.#i(p,{assembly:e,file:t,url:c,type:"API_ERROR"}))}async cancelAssembly(e){let t=e.assembly_ssl_url;await this.#t(t,{method:"DELETE",headers:this.#e}).catch(r=>this.#i(r,{url:t,type:"API_ERROR"}))}async getAssemblyStatus(e){return this.#r(e,{headers:this.#e}).catch(t=>this.#i(t,{url:e,type:"STATUS_ERROR"}))}async submitError(e,{endpoint:t,instance:r,assembly:s}={}){let n=e.details?`${e.message} (${e.details})`:e.message;return this.#r("https://transloaditstatus.com/client_error",{method:"POST",body:JSON.stringify({endpoint:t,instance:r,assembly_id:s,agent:typeof navigator<"u"?navigator.userAgent:"",client:this.opts.client,error:n})})}#i=o((e,t)=>{if(this.opts.errorReporting===!1)throw e;let r={type:t.type};throw t.assembly&&(r.assembly=t.assembly.assembly_id,r.instance=t.assembly.instance),t.url&&(r.endpoint=t.url),this.submitError(e,r).catch(()=>{}),e},"#reportError")};var Jm={strings:{creatingAssembly:"Preparing upload...",creatingAssemblyFailed:"Transloadit: Could not create Assembly",encoding:"Encoding..."}};var x2={service:"https://api2.transloadit.com",errorReporting:!0,waitForEncoding:!1,waitForMetadata:!1,alwaysRunAssembly:!1,importFromUploadURLs:!1,limit:20,retryDelays:[7e3,1e4,15e3,2e4],clientName:null},Qm=o(i=>e=>{let t=new $i("Failed to send error to the client",{cause:e});console.error(t,i)},"sendErrorToConsole");function _2(i){if(i==null)throw new Error("Transloadit: The `params` option is required.");if(typeof i=="string")try{i=JSON.parse(i)}catch(e){throw new $i("Transloadit: The `params` option is a malformed JSON string.",{cause:e})}if(!i.auth||!i.auth.key)throw new Error("Transloadit: The `params.auth.key` option is required. You can find your Transloadit API key at https://transloadit.com/c/template-credentials")}o(_2,"validateParams");var Zm="https://api2.transloadit.com/companion",eg=/\.transloadit\.com$/,P2=/https?:\/\/api2(?:-\w+)?\.transloadit\.com\/companion/,fi=class extends we{static{o(this,"Transloadit")}static VERSION=$m.version;#e;client;assembly;#t;completedFiles;restored=null;constructor(e,t){super(e,{...x2,...t}),this.type="uploader",this.id=this.opts.id||"Transloadit",this.defaultLocale=Jm,this.#e=new xt(this.opts.limit),this.i18nInit(),this.client=new Ms({service:this.opts.service,client:this.#r(),errorReporting:this.opts.errorReporting,rateLimitedQueue:this.#e}),this.completedFiles=Object.create(null)}#r(){let e=[`uppy-core:${this.uppy.constructor.VERSION}`,`uppy-transloadit:${this.constructor.VERSION}`,`uppy-tus:${hi.VERSION}`],t=o((r,s)=>{let n=this.uppy.getPlugin(r);n&&e.push(`${s}:${n.constructor.VERSION}`)},"addPluginVersion");return this.opts.importFromUploadURLs&&(t("XHRUpload","uppy-xhr-upload"),t("AwsS3","uppy-aws-s3"),t("AwsS3Multipart","uppy-aws-s3-multipart")),t("Dropbox","uppy-dropbox"),t("Box","uppy-box"),t("Facebook","uppy-facebook"),t("GoogleDrive","uppy-google-drive"),t("GoogleDrivePicker","uppy-google-drive-picker"),t("GooglePhotosPicker","uppy-google-photos-picker"),t("Instagram","uppy-instagram"),t("OneDrive","uppy-onedrive"),t("Zoom","uppy-zoom"),t("Url","uppy-url"),this.opts.clientName!=null&&e.push(this.opts.clientName),e.join(",")}#i(e,t){let r={...e.meta,assembly_url:t.assembly_url,filename:e.name,fieldname:"file"},s={...e.tus,endpoint:t.tus_url,addRequestId:!0},{remote:n}=e;if(e.remote&&P2.test(e.remote.companionUrl)){let u=t.companion_url.replace(/\/$/,""),c=e.remote.url.replace(e.remote.companionUrl,"").replace(/^\//,"");n={...e.remote,companionUrl:u,url:`${u}/${c}`}}let a={...e,transloadit:{assembly:t.assembly_id}};return this.opts.importFromUploadURLs||Object.assign(a,{meta:r,tus:s,remote:n}),a}async#s(e,t){this.uppy.log("[Transloadit] Create Assembly");try{let r=await this.client.createAssembly({...t,expectedFiles:e.length}),s=this.uppy.getFiles().filter(({id:p})=>e.includes(p));if(s.length===0&&e.length!==0)return await this.client.cancelAssembly(r),null;let n=new Ql(r,this.#e),{status:a}=n,u=a.assembly_id,c={};return s.forEach(p=>{c[p.id]=this.#i(p,a)}),this.uppy.setState({files:{...this.uppy.getState().files,...c}}),this.uppy.emit("transloadit:assembly-created",a,e),this.uppy.log(`[Transloadit] Created Assembly ${u}`),n}catch(r){let s=new $i(`${this.i18n("creatingAssemblyFailed")}: ${r.message}`,{cause:r});throw"details"in r&&(s.details=r.details),"assembly"in r&&(s.assembly=r.assembly),s}}#a(e){let t=Array.isArray(e)?e:[e],r=new Xm(this.uppy,t);r.on("assembly-complete",s=>{this.getAssemblyFiles(s).forEach(a=>{this.completedFiles[a.id]=!0,this.uppy.emit("postprocess-complete",a)})}),r.on("assembly-error",(s,n)=>{let a=this.getAssemblyFiles(s);a.forEach(c=>{this.uppy.emit("upload-error",c,n),this.uppy.emit("postprocess-complete",c)});let u={...this.uppy.getState().files};a.forEach(c=>delete u[c.id].tus),this.uppy.setState({files:u}),this.uppy.emit("error",n)}),this.#t=r}#o(){return this.opts.waitForEncoding||this.opts.waitForMetadata}#l(e,t){return Promise.all(t.map(r=>{let s=this.uppy.getFile(r);return this.client.reserveFile(e.status,s)}))}#n=o(e=>{let t=this.uppy.getFile(e.id);if(!t?.transloadit?.assembly)return;let{status:r}=this.assembly;this.client.addFile(r,t).catch(s=>{this.uppy.log(s),this.uppy.emit("transloadit:import-error",r,t.id,s)})},"#onFileUploadURLAvailable");#p(e){let t=this.uppy.getFiles();for(let r=0;r<t.length;r++){let s=t[r];if(s.uploadURL===e.tus_upload_url||s.tus&&s.tus.uploadUrl===e.tus_upload_url||!e.is_tus_file&&s.name===e.name&&s.size===e.size)return s}}#c(e,t){let r=this.getPluginState(),s=this.#p(t);if(!s){this.uppy.log("[Transloadit] Couldn\u2019t find the file, it was likely removed in the process");return}this.setPluginState({files:{...r.files,[t.id]:{assembly:e,id:s.id,uploadedFile:t}}}),this.uppy.emit("transloadit:upload",t,this.getAssembly())}#d(e,t,r){let s=this.getPluginState(),n=s.files[r.original_id];r.localId=n?n.id:null;let a={result:r,stepName:t,id:r.id,assembly:e};this.setPluginState({results:[...s.results,a]}),this.uppy.emit("transloadit:result",t,r,this.getAssembly())}#u(e){let t=e.status.assembly_ssl_url;this.client.getAssemblyStatus(t).then(r=>{e.status=r,this.uppy.emit("transloadit:complete",r)})}async#h(e){await this.client.cancelAssembly(e),this.uppy.emit("transloadit:assembly-cancelled",e),this.assembly=void 0}#f=o(async()=>{if(this.assembly)try{await this.#h(this.assembly.status)}catch(e){this.uppy.log(e)}},"#onCancelAll");#m=o(e=>{this.assembly&&e({[this.id]:{assemblyResponse:this.assembly.status}})},"#getPersistentData");#y=o(e=>{let r=(e?.[this.id]?e[this.id]:{}).assemblyResponse;if(!r)return;let s=o(()=>{let u={},c=[],{assembly_id:p}=r;r.uploads.forEach(h=>{let b=this.#p(h);u[h.id]={id:b.id,assembly:p,uploadedFile:h}});let g=this.getPluginState();return Object.keys(r.results).forEach(h=>{for(let b of r.results[h]){let P=g.files[b.original_id];b.localId=P?P.id:null,c.push({id:b.id,result:b,stepName:h,assembly:p})}}),this.assembly=new Ql(r,this.#e),this.assembly.status=r,this.setPluginState({files:u,results:c}),u},"restoreState"),n=o(u=>{this.#a(r.assembly_id),this.#g(this.assembly,u)},"restoreAssemblies"),a=o(()=>this.assembly?.update(),"updateAssembly");this.restored=(async()=>{let u=s();n(Object.keys(u)),await a(),this.restored=null})(),this.restored.catch(u=>{this.uppy.log("Failed to restore",u)})},"#onRestored");#g(e,t){let{status:r}=e,s=r.assembly_id;return this.assembly=e,e.on("upload",n=>{this.#c(s,n)}),e.on("error",n=>{n.assembly=e.status,this.uppy.emit("transloadit:assembly-error",e.status,n)}),e.on("executing",()=>{this.uppy.emit("transloadit:assembly-executing",e.status)}),e.on("execution-progress",n=>{if(this.uppy.emit("transloadit:execution-progress",n),n.progress_combined!=null)for(let a of this.uppy.getFilesByIds(t))this.uppy.emit("postprocess-progress",a,{mode:"determinate",value:n.progress_combined/100,message:this.i18n("encoding")})}),this.opts.waitForEncoding&&e.on("result",(n,a)=>{this.#d(s,n,a)}),this.opts.waitForEncoding?e.on("finished",()=>{this.#u(e)}):this.opts.waitForMetadata&&e.on("metadata",()=>{this.#u(e)}),e.ok==="ASSEMBLY_COMPLETE"||e.connect(),e}#v=o(async e=>{let t=typeof this.opts.assemblyOptions=="function"?await this.opts.assemblyOptions():this.opts.assemblyOptions;t.fields??={},_2(t.params);try{let r=this.assembly??await this.#s(e,t);if(r==null)throw new Error("All files were canceled after assembly was created");this.opts.importFromUploadURLs&&await this.#l(r,e),e.forEach(s=>{let n=this.uppy.getFile(s);this.uppy.emit("preprocess-complete",n)}),this.#a(r.status.assembly_id),this.#g(r,e)}catch(r){throw e.forEach(s=>{let n=this.uppy.getFile(s);this.uppy.emit("preprocess-complete",n),this.uppy.emit("upload-error",n,r)}),r}},"#prepareUpload");#P=o(async(e,t)=>{try{await this.restored;let r=e.map(c=>this.uppy.getFile(c)).filter(c=>!c.error),s=this.assembly?.status.assembly_id,n=o(()=>{this.assembly?.close()},"closeSocketConnections");if(!this.#o()){n();let c=this.assembly?.status;c!=null&&this.uppy.addResultData(t,{transloadit:[c]});return}if(!s){this.uppy.addResultData(t,{transloadit:[]});return}r.filter(c=>!ft(this.completedFiles,c.id)).forEach(c=>{this.uppy.emit("postprocess-progress",c,{mode:"indeterminate",message:this.i18n("encoding")})}),await this.#t.promise,n();let u=this.assembly?.status;u!=null&&this.uppy.addResultData(t,{transloadit:[u]})}finally{this.assembly=void 0}},"#afterUpload");#w=o(()=>{this.assembly?.close()},"#closeAssemblyIfExists");#b=o(e=>{this.#w(),this.assembly=void 0,this.client.submitError(e).catch(Qm(e))},"#onError");#x=o((e,t)=>{if(this.#w(),t?.message?.startsWith("tus: ")){let r=t.originalRequest?.getUnderlyingObject()?.responseURL;this.client.submitError(t,{endpoint:r}).catch(Qm(t))}},"#onTusError");install(){this.uppy.addPreProcessor(this.#v),this.uppy.addPostProcessor(this.#P),this.uppy.on("error",this.#b),this.uppy.on("cancel-all",this.#f),this.uppy.on("upload-error",this.#x),this.opts.importFromUploadURLs?this.uppy.on("upload-success",this.#n):this.uppy.use(hi,{storeFingerprintForResuming:!1,allowedMetaFields:!0,limit:this.opts.limit,rateLimitedQueue:this.#e,retryDelays:this.opts.retryDelays}),this.uppy.on("restore:get-data",this.#m),this.uppy.on("restored",this.#y),this.setPluginState({files:{},results:[]});let{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!1}})}uninstall(){this.uppy.removePreProcessor(this.#v),this.uppy.removePostProcessor(this.#P),this.uppy.off("error",this.#b),this.opts.importFromUploadURLs&&this.uppy.off("upload-success",this.#n);let{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!0}})}getAssembly(){return this.assembly?.status}getAssemblyFiles(e){return this.uppy.getFiles().filter(t=>t?.transloadit?.assembly===e)}};function tu(i,e,t){return new Promise(r=>{i.toBlob(r,e,t)})}o(tu,"canvasToBlob");var lg=de(tg(),1);var ig={name:"@uppy/webcam",description:"Uppy plugin that takes photos or records videos using the device's camera.",version:"4.3.2",license:"MIT",main:"lib/index.js",style:"dist/style.min.css",type:"module",scripts:{build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","uppy","uppy-plugin","webcam","picture","photo","video","record","mediarecorder"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/utils":"workspace:^","is-mobile":"^4.0.0",preact:"^10.5.13"},devDependencies:{cssnano:"^7.0.7",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"workspace:^"}};function Ls(){return l("svg",{"aria-hidden":"true",focusable:"false",fill:"#0097DC",width:"66",height:"55",viewBox:"0 0 66 55",children:l("path",{d:"M57.3 8.433c4.59 0 8.1 3.51 8.1 8.1v29.7c0 4.59-3.51 8.1-8.1 8.1H8.7c-4.59 0-8.1-3.51-8.1-8.1v-29.7c0-4.59 3.51-8.1 8.1-8.1h9.45l4.59-7.02c.54-.54 1.35-1.08 2.16-1.08h16.2c.81 0 1.62.54 2.16 1.08l4.59 7.02h9.45zM33 14.64c-8.62 0-15.393 6.773-15.393 15.393 0 8.62 6.773 15.393 15.393 15.393 8.62 0 15.393-6.773 15.393-15.393 0-8.62-6.773-15.393-15.393-15.393zM33 40c-5.648 0-9.966-4.319-9.966-9.967 0-5.647 4.318-9.966 9.966-9.966s9.966 4.319 9.966 9.966C42.966 35.681 38.648 40 33 40z",fillRule:"evenodd"})})}o(Ls,"CameraIcon");function T2({onDiscard:i,i18n:e}){return l("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--discard",type:"button",title:e("discardRecordedFile"),"aria-label":e("discardRecordedFile"),onClick:i,"data-uppy-super-focusable":!0,children:l("svg",{width:"13",height:"13",viewBox:"0 0 13 13",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon",children:l("g",{fill:"#FFF",fillRule:"evenodd",children:[l("path",{d:"M.496 11.367L11.103.76l1.414 1.414L1.911 12.781z"}),l("path",{d:"M11.104 12.782L.497 2.175 1.911.76l10.607 10.606z"})]})})})}o(T2,"DiscardButton");var rg=T2;function ru({recording:i,onStartRecording:e,onStopRecording:t,i18n:r}){return i?l("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button",type:"button",title:r("stopRecording"),"aria-label":r("stopRecording"),onClick:t,"data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100",children:l("rect",{x:"15",y:"15",width:"70",height:"70"})})}):l("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button",type:"button",title:r("startRecording"),"aria-label":r("startRecording"),onClick:e,"data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100",children:l("circle",{cx:"50",cy:"50",r:"40"})})})}o(ru,"RecordButton");function su(i){return`${Math.floor(i/60)}:${String(i%60).padStart(2,"0")}`}o(su,"formatSeconds");function ou({recordingLengthSeconds:i}){let e=su(i);return l("span",{children:e})}o(ou,"RecordingLength");function nu({onSnapshot:i,i18n:e}){return l("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--picture",type:"button",title:e("takePicture"),"aria-label":e("takePicture"),onClick:i,"data-uppy-super-focusable":!0,children:Ls()})}o(nu,"SnapshotButton");function A2({onSubmit:i,i18n:e}){return l("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--submit",type:"button",title:e("submitRecordedFile"),"aria-label":e("submitRecordedFile"),onClick:i,"data-uppy-super-focusable":!0,children:l("svg",{width:"12",height:"9",viewBox:"0 0 12 9",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon",children:l("path",{fill:"#fff",fillRule:"nonzero",d:"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z"})})})}o(A2,"SubmitButton");var sg=A2;function au({currentDeviceId:i,videoSources:e,onChangeVideoSource:t}){return l("div",{className:"uppy-Webcam-videoSource",children:l("select",{className:"uppy-u-reset uppy-Webcam-videoSource-select",onChange:o(r=>{t(r.target.value)},"onChange"),children:e.map(r=>l("option",{value:r.deviceId,selected:r.deviceId===i,children:r.label},r.deviceId))})})}o(au,"VideoSourceSelect");function ln(i,e){return i.includes(e)}o(ln,"isModeAvailable");var lu=class extends ge{static{o(this,"CameraScreen")}videoElement;refs;componentDidMount(){let{onFocus:e}=this.props;e()}componentWillUnmount(){let{onStop:e}=this.props;e()}render(){let{src:e,recordedVideo:t,capturedSnapshot:r,recording:s,modes:n,supportsRecording:a,videoSources:u,showVideoSourceDropdown:c,showRecordingLength:p,onSubmit:g,i18n:h,mirror:b,onSnapshot:P,onStartRecording:F,onStopRecording:M,onDiscardRecordedMedia:C,recordingLengthSeconds:O}=this.props,U=!!t,A=!!r,J=U||A,G=!J&&a&&(ln(n,"video-only")||ln(n,"audio-only")||ln(n,"video-audio")),W=!J&&ln(n,"picture"),K=a&&p&&!U,te=c&&u&&u.length>1,Q={playsInline:!0};return t?(Q.muted=!1,Q.controls=!0,Q.src=t,this.videoElement&&(this.videoElement.srcObject=null)):(Q.muted=!0,Q.autoPlay=!0,Q.srcObject=e),l("div",{className:"uppy uppy-Webcam-container",children:[l("div",{className:"uppy-Webcam-videoContainer",children:r&&!s&&!t?l("div",{className:"uppy-Webcam-imageContainer",children:l("img",{src:r,className:"uppy-Webcam-video",alt:"capturedSnapshot"})}):l("video",{ref:o(be=>{this.videoElement=be},"ref"),className:`uppy-Webcam-video  ${b?"uppy-Webcam-video--mirrored":""}`,...Q})}),l("div",{className:"uppy-Webcam-footer",children:[l("div",{className:"uppy-Webcam-videoSourceContainer",children:te?au(this.props):null}),l("div",{className:"uppy-Webcam-buttonContainer",children:[W&&l(nu,{onSnapshot:P,i18n:h}),G&&l(ru,{recording:s,onStartRecording:F,onStopRecording:M,i18n:h}),(U||A)&&l(sg,{onSubmit:g,i18n:h}),(U||A)&&l(rg,{onDiscard:C,i18n:h})]}),l("div",{className:"uppy-Webcam-recordingLength",children:K&&l(ou,{recordingLengthSeconds:O})})]})]})}},og=lu;var ng={strings:{pluginNameCamera:"Camera",noCameraTitle:"Camera Not Available",noCameraDescription:"In order to take pictures or record video, please connect a camera device",recordingStoppedMaxSize:"Recording stopped because the file size is about to exceed the limit",submitRecordedFile:"Submit recorded file",discardRecordedFile:"Discard recorded file",smile:"Smile!",takePicture:"Take a picture",startRecording:"Begin video recording",stopRecording:"Stop video recording",recordingLength:"Recording length %{recording_length}",allowAccessTitle:"Please allow access to your camera",allowAccessDescription:"In order to take pictures or record video with your camera, please allow camera access for this site."}};function uu({icon:i,i18n:e,hasCamera:t}){return l("div",{className:"uppy-Webcam-permissons",children:[l("div",{className:"uppy-Webcam-permissonsIcon",children:i()}),l("div",{className:"uppy-Webcam-title",children:e(t?"allowAccessTitle":"noCameraTitle")}),l("p",{children:e(t?"allowAccessDescription":"noCameraDescription")})]})}o(uu,"PermissionsScreen");function cu(){return typeof MediaRecorder=="function"&&!!MediaRecorder.prototype&&typeof MediaRecorder.prototype.start=="function"}o(cu,"supportsMediaRecorder");function ag(i){return i[0]==="."?Br[i.slice(1)]:i}o(ag,"toMimeType");function R2(i){return/^video\/[^*]+$/.test(i)}o(R2,"isVideoMimeType");function O2(i){return/^image\/[^*]+$/.test(i)}o(O2,"isImageMimeType");function U2(){return navigator.mediaDevices}o(U2,"getMediaDevices");function pu(i,e){return i.includes(e)}o(pu,"isModeAvailable");var ug={onBeforeSnapshot:o(()=>Promise.resolve(),"onBeforeSnapshot"),countdown:!1,modes:["video-audio","video-only","audio-only","picture"],mirror:!0,showVideoSourceDropdown:!1,preferredImageMimeType:null,preferredVideoMimeType:null,showRecordingLength:!1,mobileNativeCamera:(0,lg.isMobile)({tablet:!0})},xr=class extends Z{static{o(this,"Webcam")}static VERSION=ig.version;#e;mediaDevices;supportsUserMedia;protocol;capturedMediaFile;icon;webcamActive;stream=null;recorder=null;recordingChunks=null;recordingLengthTimer;captureInProgress=!1;constructor(e,t){super(e,{...ug,...t}),this.mediaDevices=U2(),this.supportsUserMedia=!!this.mediaDevices,this.protocol=location.protocol.match(/https/i)?"https":"http",this.id=this.opts.id||"Webcam",this.type="acquirer",this.capturedMediaFile=null,this.icon=()=>l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383",fillRule:"nonzero"})}),this.defaultLocale=ng,this.i18nInit(),this.title=this.i18n("pluginNameCamera"),this.#e=this.opts.mirror,this.install=this.install.bind(this),this.setPluginState=this.setPluginState.bind(this),this.render=this.render.bind(this),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.takeSnapshot=this.takeSnapshot.bind(this),this.startRecording=this.startRecording.bind(this),this.stopRecording=this.stopRecording.bind(this),this.discardRecordedMedia=this.discardRecordedMedia.bind(this),this.submit=this.submit.bind(this),this.oneTwoThreeSmile=this.oneTwoThreeSmile.bind(this),this.focus=this.focus.bind(this),this.changeVideoSource=this.changeVideoSource.bind(this),this.webcamActive=!1,this.opts.countdown&&(this.opts.onBeforeSnapshot=this.oneTwoThreeSmile),this.setPluginState({hasCamera:!1,cameraReady:!1,cameraError:null,recordingLengthSeconds:0,videoSources:[],currentDeviceId:null,capturedSnapshot:null})}getStatus(){let{recordedVideo:e,capturedSnapshot:t,isRecording:r,cameraReady:s,cameraError:n}=this.getPluginState();return r?"recording":e!=null||t!=null?"captured":s?"ready":n?"error":"init"}setOptions(e){super.setOptions({...e,videoConstraints:{...this.opts.videoConstraints,...e?.videoConstraints}})}hasCameraCheck(){return this.mediaDevices?this.mediaDevices.enumerateDevices().then(e=>e.some(t=>t.kind==="videoinput")):Promise.resolve(!1)}isAudioOnly(){return this.opts.modes.length===1&&this.opts.modes[0]==="audio-only"}getConstraints(e=null){let t=this.opts.modes.indexOf("video-audio")!==-1||this.opts.modes.indexOf("audio-only")!==-1,r=!this.isAudioOnly()&&(this.opts.modes.indexOf("video-audio")!==-1||this.opts.modes.indexOf("video-only")!==-1||this.opts.modes.indexOf("picture")!==-1),s={...this.opts.videoConstraints||{},...e!=null&&{deviceId:e}};return{audio:t,video:r?s:!1}}start(e=null){if(!this.supportsUserMedia)return Promise.reject(new Error("Webcam access not supported"));this.webcamActive=!0,this.opts.mirror&&(this.#e=!0);let t=this.getConstraints(e?.deviceId);this.hasCameraCheck().then(r=>(this.setPluginState({hasCamera:r}),this.mediaDevices.getUserMedia(t).then(s=>{this.stream=s;let n=null,a=this.isAudioOnly()?s.getAudioTracks():s.getVideoTracks();!e||!e.deviceId?n=a[0].getSettings().deviceId:a.forEach(u=>{u.getSettings().deviceId===e.deviceId&&(n=u.getSettings().deviceId)}),this.updateVideoSources(),this.setPluginState({currentDeviceId:n,cameraReady:!0})}).catch(s=>{this.setPluginState({cameraReady:!1,cameraError:s}),this.uppy.info(s.message,"error")})))}getMediaRecorderOptions(){let e={};if(MediaRecorder.isTypeSupported){let{restrictions:t}=this.uppy.opts,r=[];this.opts.preferredVideoMimeType?r=[this.opts.preferredVideoMimeType]:t.allowedFileTypes&&(r=t.allowedFileTypes.map(ag).filter(R2));let s=o(a=>MediaRecorder.isTypeSupported(a)&&Et(a),"filterSupportedTypes"),n=r.filter(s);n.length>0&&(e.mimeType=n[0])}return e}startRecording(){this.recorder=new MediaRecorder(this.stream,this.getMediaRecorderOptions()),this.recordingChunks=[];let e=!1;this.recorder.addEventListener("dataavailable",t=>{this.recordingChunks.push(t.data);let{restrictions:r}=this.uppy.opts;if(this.recordingChunks.length>1&&r.maxFileSize!=null&&!e){let s=this.recordingChunks.reduce((c,p)=>c+p.size,0),a=(s-this.recordingChunks[0].size)/(this.recordingChunks.length-1)*3,u=Math.max(0,r.maxFileSize-a);s>u&&(e=!0,this.uppy.info(this.i18n("recordingStoppedMaxSize"),"warning",4e3),this.stopRecording())}}),this.recorder.start(500),this.opts.showRecordingLength&&(this.recordingLengthTimer=setInterval(()=>{let t=this.getPluginState().recordingLengthSeconds;this.setPluginState({recordingLengthSeconds:t+1})},1e3)),this.setPluginState({isRecording:!0})}stopRecording(){return new Promise(t=>{this.recorder.addEventListener("stop",()=>{t()}),this.recorder.stop(),this.opts.showRecordingLength&&(clearInterval(this.recordingLengthTimer),this.setPluginState({recordingLengthSeconds:0}))}).then(()=>(this.setPluginState({isRecording:!1}),this.getVideo())).then(t=>{try{this.capturedMediaFile=t,this.setPluginState({recordedVideo:URL.createObjectURL(t.data)}),this.#e=!1}catch(r){r.isRestriction||this.uppy.log(r)}}).then(()=>{this.recordingChunks=null,this.recorder=null},t=>{throw this.recordingChunks=null,this.recorder=null,t})}discardRecordedMedia(){let{recordedVideo:e,capturedSnapshot:t}=this.getPluginState();e&&URL.revokeObjectURL(e),t&&URL.revokeObjectURL(t),this.setPluginState({recordedVideo:null,capturedSnapshot:null}),this.opts.mirror&&(this.#e=!0),this.capturedMediaFile=null}submit(){try{this.capturedMediaFile&&this.uppy.addFile(this.capturedMediaFile)}catch(e){e.isRestriction||this.uppy.log(e,"error")}}async stop(){if(this.stream){let e=this.stream.getAudioTracks(),t=this.stream.getVideoTracks();e.concat(t).forEach(r=>r.stop())}this.recorder&&await new Promise(e=>{this.recorder.addEventListener("stop",e,{once:!0}),this.recorder.stop(),this.opts.showRecordingLength&&clearInterval(this.recordingLengthTimer)}),this.recordingChunks=null,this.recorder=null,this.webcamActive=!1,this.stream=null,this.setPluginState({recordedVideo:null,capturedSnapshot:null,isRecording:!1,recordingLengthSeconds:0})}getVideoElement(){return this.el.querySelector(".uppy-Webcam-video")}oneTwoThreeSmile(){return new Promise((e,t)=>{let r=this.opts.countdown,s=setInterval(()=>{if(!this.webcamActive)return clearInterval(s),this.captureInProgress=!1,t(new Error("Webcam is not active"));r?(this.uppy.info(`${r}...`,"warning",800),r--):(clearInterval(s),this.uppy.info(this.i18n("smile"),"success",1500),setTimeout(()=>e(),1500))},1e3)})}async takeSnapshot(){if(!this.captureInProgress){this.captureInProgress=!0;try{await this.opts.onBeforeSnapshot()}catch(e){let t=typeof e=="object"?e.message:e;throw this.uppy.info(t,"error",5e3),new Error(`onBeforeSnapshot: ${t}`)}try{let e=await this.getImage();this.capturedMediaFile=e;let t=URL.createObjectURL(e.data);this.setPluginState({capturedSnapshot:t}),this.captureInProgress=!1}catch(e){this.captureInProgress=!1,e.isRestriction||this.uppy.log(e)}}}getImage(){let e=this.getVideoElement();if(!e)return Promise.reject(new Error("No video element found, likely due to the Webcam tab being closed."));let t=e.videoWidth,r=e.videoHeight,s=document.createElement("canvas");s.width=t,s.height=r,s.getContext("2d").drawImage(e,0,0);let{restrictions:a}=this.uppy.opts,u=[];this.opts.preferredImageMimeType?u=[this.opts.preferredImageMimeType]:a.allowedFileTypes&&(u=a.allowedFileTypes.map(ag).filter(O2));let c=u[0]||"image/jpeg",p=Et(c)||"jpg",g=`cam-${Date.now()}.${p}`;return tu(s,c).then(h=>({source:this.id,name:g,data:new Blob([h],{type:c}),type:c}))}getVideo(){let e=this.recordingChunks.find(a=>a.type?.length>0).type,t=Et(e);if(!t)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type "${e}"`));let r=`webcam-${Date.now()}.${t}`,s=new Blob(this.recordingChunks,{type:e}),n={source:this.id,name:r,data:new Blob([s],{type:e}),type:e};return Promise.resolve(n)}focus(){this.opts.countdown&&setTimeout(()=>{this.uppy.info(this.i18n("smile"),"success",1500)},1e3)}changeVideoSource(e){this.stop(),this.start({deviceId:e})}updateVideoSources(){this.mediaDevices.enumerateDevices().then(e=>{this.setPluginState({videoSources:e.filter(t=>t.kind==="videoinput")})})}render(){this.webcamActive||this.start();let e=this.getPluginState();return!e.cameraReady||!e.hasCamera?l(uu,{icon:Ls,i18n:this.i18n,hasCamera:e.hasCamera}):l(og,{...e,onChangeVideoSource:this.changeVideoSource,onSnapshot:this.takeSnapshot,onStartRecording:this.startRecording,onStopRecording:this.stopRecording,onDiscardRecordedMedia:this.discardRecordedMedia,onSubmit:this.submit,onFocus:this.focus,onStop:this.stop,i18n:this.i18n,modes:this.opts.modes,showRecordingLength:this.opts.showRecordingLength,showVideoSourceDropdown:this.opts.showVideoSourceDropdown,supportsRecording:cu(),recording:e.isRecording,mirror:this.#e,src:this.stream})}install(){let{mobileNativeCamera:e,modes:t,videoConstraints:r}=this.opts,{target:s}=this.opts;if(e&&s){this.getTargetPlugin(s)?.setOptions({showNativeVideoCameraButton:pu(t,"video-only")||pu(t,"video-audio"),showNativePhotoCameraButton:pu(t,"picture"),nativeCameraFacingMode:r?.facingMode});return}this.setPluginState({cameraReady:!1,recordingLengthSeconds:0}),s&&this.mount(s,this),this.mediaDevices&&(this.updateVideoSources(),this.mediaDevices.ondevicechange=()=>{if(this.updateVideoSources(),this.stream){let n=!0,{videoSources:a,currentDeviceId:u}=this.getPluginState();a.forEach(c=>{u===c.deviceId&&(n=!1)}),n&&(this.stop(),this.start())}})}uninstall(){this.stop(),this.unmount()}onUnmount(){this.stop()}};var du=class{static{o(this,"ProgressTimeout")}#e;#t=!1;#r;#i;constructor(e,t){this.#i=e,this.#r=()=>t(e)}progress(){this.#t||this.#i>0&&(clearTimeout(this.#e),this.#e=setTimeout(this.#r,this.#i))}done(){this.#t||(clearTimeout(this.#e),this.#e=void 0,this.#t=!0)}},cg=du;var un=o(()=>{},"noop");function pg(i,e={}){let{body:t=null,headers:r={},method:s="GET",onBeforeRequest:n=un,onUploadProgress:a=un,shouldRetry:u=o(()=>!0,"shouldRetry"),onAfterResponse:c=un,onTimeout:p=un,responseType:g,retries:h=3,signal:b=null,timeout:P=3e4,withCredentials:F=!1}=e,M=o(U=>.3*2**(U-1)*1e3,"delay"),C=new cg(P,p);function O(U=0){return new Promise(async(A,J)=>{let G=new XMLHttpRequest,W=o(K=>{u(G)&&U<h?setTimeout(()=>{O(U+1).then(A,J)},M(U)):(C.done(),J(K))},"onError");G.open(s,i,!0),G.withCredentials=F,g&&(G.responseType=g),b?.addEventListener("abort",()=>{G.abort(),J(new DOMException("Aborted","AbortError"))}),G.onload=async()=>{try{await c(G,U)}catch(K){K.request=G,W(K);return}G.status>=200&&G.status<300?(C.done(),A(G)):u(G)&&U<h?setTimeout(()=>{O(U+1).then(A,J)},M(U)):(C.done(),J(new kt(G.statusText,G)))},G.onerror=()=>W(new kt(G.statusText,G)),G.upload.onprogress=K=>{C.progress(),a(K)},r&&Object.keys(r).forEach(K=>{G.setRequestHeader(K,r[K])}),await n(G,U),G.send(t)})}return o(O,"requestWithRetry"),O()}o(pg,"fetcher");var dg={name:"@uppy/xhr-upload",description:"Plain and simple classic HTML multipart form uploads with Uppy, as well as uploads using the HTTP PUT method.",version:"4.4.2",license:"MIT",main:"lib/index.js",type:"module",scripts:{build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},keywords:["file uploader","xhr","xhr upload","XMLHttpRequest","ajax","fetch","uppy","uppy-plugin"],homepage:"https://uppy.io",bugs:{url:"https://github.com/transloadit/uppy/issues"},repository:{type:"git",url:"git+https://github.com/transloadit/uppy.git"},files:["src","lib","dist","CHANGELOG.md"],dependencies:{"@uppy/companion-client":"workspace:^","@uppy/utils":"workspace:^"},devDependencies:{"@uppy/core":"workspace:^",jsdom:"^26.1.0",nock:"^13.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},peerDependencies:{"@uppy/core":"workspace:^"}};var hg={strings:{uploadStalled:"Upload has not made any progress for %{seconds} seconds. You may want to retry it."}};function I2(i,e){let t=e;return t||(t=new Error("Upload error")),typeof t=="string"&&(t=new Error(t)),t instanceof Error||(t=Object.assign(new Error("Upload error"),{data:t})),Xo(i)?(t=new kt(t,i),t):(t.request=i,t)}o(I2,"buildResponseError");function fg(i){return i.data.slice(0,i.data.size,i.meta.type)}o(fg,"setTypeInBlob");var N2={formData:!0,fieldName:"file",method:"post",allowedMetaFields:!0,bundle:!1,headers:{},timeout:30*1e3,limit:5,withCredentials:!1,responseType:""},Bs=class extends we{static{o(this,"XHRUpload")}static VERSION=dg.version;#e;requests;uploaderEvents;constructor(e,t){if(super(e,{...N2,fieldName:t.bundle?"files[]":"file",...t}),this.type="uploader",this.id=this.opts.id||"XHRUpload",this.defaultLocale=hg,this.i18nInit(),_o in this.opts?this.requests=this.opts[_o]:this.requests=new xt(this.opts.limit),this.opts.bundle&&!this.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");if(this.opts.bundle&&typeof this.opts.headers=="function")throw new Error("`opts.headers` can not be a function when the `bundle: true` option is set.");if(t?.allowedMetaFields===void 0&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");this.uploaderEvents=Object.create(null),this.#e=r=>async(s,n)=>{try{let a=await pg(s,{...n,onBeforeRequest:o((p,g)=>this.opts.onBeforeRequest?.(p,g,r),"onBeforeRequest"),shouldRetry:this.opts.shouldRetry,onAfterResponse:this.opts.onAfterResponse,onTimeout:o(p=>{let g=Math.ceil(p/1e3),h=new Error(this.i18n("uploadStalled",{seconds:g}));this.uppy.emit("upload-stalled",h,r)},"onTimeout"),onUploadProgress:o(p=>{if(p.lengthComputable)for(let{id:g}of r){let h=this.uppy.getFile(g);this.uppy.emit("upload-progress",h,{uploadStarted:h.progress.uploadStarted??0,bytesUploaded:p.loaded/p.total*h.size,bytesTotal:h.size})}},"onUploadProgress")}),u=await this.opts.getResponseData?.(a);if(a.responseType==="json")u??=a.response;else try{u??=JSON.parse(a.responseText)}catch(p){throw new Error("@uppy/xhr-upload expects a JSON response (with a `url` property). To parse non-JSON responses, use `getResponseData` to turn your response into JSON.",{cause:p})}let c=typeof u?.url=="string"?u.url:void 0;for(let{id:p}of r)this.uppy.emit("upload-success",this.uppy.getFile(p),{status:a.status,body:u,uploadURL:c});return a}catch(a){if(a.name==="AbortError")return;let u=a.request;for(let c of r)this.uppy.emit("upload-error",this.uppy.getFile(c.id),I2(u,a),u);throw a}}}getOptions(e){let t=this.uppy.getState().xhrUpload,{headers:r}=this.opts,s={...this.opts,...t||{},...e.xhrUpload||{},headers:{}};return typeof r=="function"?s.headers=r(e):Object.assign(s.headers,this.opts.headers),t&&Object.assign(s.headers,t.headers),e.xhrUpload&&Object.assign(s.headers,e.xhrUpload.headers),s}addMetadata(e,t,r){qt(r.allowedMetaFields,t).forEach(n=>{let a=t[n];Array.isArray(a)?a.forEach(u=>e.append(n,u)):e.append(n,a)})}createFormDataUpload(e,t){let r=new FormData;this.addMetadata(r,e.meta,t);let s=fg(e);return e.name?r.append(t.fieldName,s,e.meta.name):r.append(t.fieldName,s),r}createBundledUpload(e,t){let r=new FormData,{meta:s}=this.uppy.getState();return this.addMetadata(r,s,t),e.forEach(n=>{let a=this.getOptions(n),u=fg(n);n.name?r.append(a.fieldName,u,n.name):r.append(a.fieldName,u)}),r}async#t(e){let t=new Ht(this.uppy),r=new AbortController,s=this.requests.wrapPromiseFunction(async()=>{let n=this.getOptions(e),a=this.#e([e]),u=n.formData?this.createFormDataUpload(e,n):e.data,c=typeof n.endpoint=="string"?n.endpoint:await n.endpoint(e);return a(c,{...n,body:u,signal:r.signal})});t.onFileRemove(e.id,()=>r.abort()),t.onCancelAll(e.id,()=>{r.abort()});try{await s().abortOn(r.signal)}catch(n){if(n.message!=="Cancelled")throw n}finally{t.remove()}}async#r(e){let t=new AbortController,r=this.requests.wrapPromiseFunction(async()=>{let n=this.uppy.getState().xhrUpload??{},a=this.#e(e),u=this.createBundledUpload(e,{...this.opts,...n}),c=typeof this.opts.endpoint=="string"?this.opts.endpoint:await this.opts.endpoint(e);return a(c,{...this.opts,body:u,signal:t.signal})});function s(){t.abort()}o(s,"abort"),this.uppy.once("cancel-all",s);try{await r().abortOn(t.signal)}catch(n){if(n.message!=="Cancelled")throw n}finally{this.uppy.off("cancel-all",s)}}#i(e){let t=this.getOptions(e),r=qt(t.allowedMetaFields,e.meta);return{...e.remote?.body,protocol:"multipart",endpoint:t.endpoint,size:e.data.size,fieldname:t.fieldName,metadata:Object.fromEntries(r.map(s=>[s,e.meta[s]])),httpMethod:t.method,useFormData:t.formData,headers:t.headers}}async#s(e){await Promise.allSettled(e.map(t=>{if(t.isRemote){let r=o(()=>this.requests,"getQueue"),s=new AbortController,n=o(u=>{u.id===t.id&&s.abort()},"removedHandler");this.uppy.on("file-removed",n);let a=this.uppy.getRequestClientForFile(t).uploadRemoteFile(t,this.#i(t),{signal:s.signal,getQueue:r});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",n)},{priority:-1})(),a}return this.#t(t)}))}#a=o(async e=>{if(e.length===0){this.uppy.log("[XHRUpload] No files to upload!");return}this.opts.limit===0&&!this.opts[_o]&&this.uppy.log("[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0","warning"),this.uppy.log("[XHRUpload] Uploading...");let t=this.uppy.getFilesByIds(e),r=Ji(t),s=Qi(r);if(this.uppy.emit("upload-start",s),this.opts.bundle){if(r.some(a=>a.isRemote))throw new Error("Can\u2019t upload remote files when the `bundle: true` option is set");if(typeof this.opts.headers=="function")throw new TypeError("`headers` may not be a function when the `bundle: true` option is set");await this.#r(r)}else await this.#s(r)},"#handleUpload");install(){if(this.opts.bundle){let{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!1}})}this.uppy.addUploader(this.#a)}uninstall(){if(this.opts.bundle){let{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!0}})}this.uppy.removeUploader(this.#a)}};function M2(){throw new Error("Core has been renamed to Uppy")}o(M2,"Core");var L2={ProviderView:la};fi.COMPANION_URL=Zm;fi.COMPANION_ALLOWED_HOSTS=eg;var B2={};globalThis.Uppy=hu;})();
/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */
/*! Bundled license information:

classnames/index.js:
  (*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  *)

compressorjs/dist/compressor.js:
  (*!
   * Compressor.js v1.2.1
   * https://fengyuanchen.github.io/compressorjs
   *
   * Copyright 2018-present Chen Fengyuan
   * Released under the MIT license
   *
   * Date: 2023-02-28T14:09:41.732Z
   *)

cropperjs/dist/cropper.js:
  (*!
   * Cropper.js v1.6.2
   * https://fengyuanchen.github.io/cropperjs
   *
   * Copyright 2015-present Chen Fengyuan
   * Released under the MIT license
   *
   * Date: 2024-04-21T07:43:05.335Z
   *)

tus-js-client/lib.esm/upload.js:
  (*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE *)

tus-js-client/lib.esm/browser/fileReader.js:
  (*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE *)
*/
//# sourceMappingURL=uppy.min.js.map
